\def\module{M3P17 Algebraic Combinatorics}
\def\lecturer{Dr Joanna Fawcett}
\def\term{Autumn 2018}
\def\cover{
$$
\begin{tikzpicture}[scale=2]
\fill (0, 0) circle (0.05) node[below left]{$ p_1 $};
\fill (1, 0) circle (0.05) node[below left]{$ p_2 $};
\fill (2, 0) circle (0.05) node[below left]{$ p_3 $};
\fill (0, -1) circle (0.05) node[below left]{$ p_4 $};
\fill (1, -1) circle (0.05) node[below left]{$ p_5 $};
\fill (2, -1) circle (0.05) node[below left]{$ p_6 $};
\fill (0, -2) circle (0.05) node[below left]{$ p_7 $};
\fill (1, -2) circle (0.05) node[below left]{$ p_8 $};
\fill (2, -2) circle (0.05) node[below left]{$ p_9 $};
\fill (3.1, 1.1) circle (0.05) node[above right]{$ p_{10} $};
\fill (4, -1) circle (0.05) node[right]{$ p_{11} $};
\fill (3.1, -3.1) circle (0.05) node[below right]{$ p_{12} $};
\fill (1, -4) circle (0.05) node[below]{$ p_{13} $};
\draw (0, 0) to [out=-135, in=-135, distance=90] node[below left]{$ l_1 $} (1, -2) to (2, -1) to [out=45, in=-90] (3.1, 1.1);
\draw (0, -2) to (2, 0) to node[below right, near end]{$ l_2 $} (3.1, 1.1);
\draw (2, -2) to [out=-135, in=-135, distance=90] node[below left]{$ l_3 $} (0, -1) to (1, 0) to [out=45, in=180] (3.1, 1.1);
\draw (0, 0) to (2, 0) to [out=0, in=135] node[below left, near end]{$ l_4 $} (4, -1);
\draw (0, -1) to (2, -1) to node[below, near end]{$ l_5 $} (4, -1);
\draw (0, -2) to (2, -2) to [out=0, in=-135] node[below right, near end]{$ l_6 $} (4, -1);
\draw (2, 0) to [out=135, in=135, distance=90] node[above left]{$ l_7 $} (0, -1) to (1, -2) to [out=-45, in=180] (3.1, -3.1);
\draw (0, 0) to (2, -2) to node[above right, near end]{$ l_8 $} (3.1, -3.1);
\draw (0, -2) to [out=135, in=135, distance=90] node[above left]{$ l_9 $} (1, 0) to (2, -1) to [out=-45, in=90] (3.1, -3.1);
\draw (2, 0) to (2, -2) to [out=-90, in=45] node[below right, near end]{$ l_{10} $} (1, -4);
\draw (1, 0) to (1, -2) to node[right, near end]{$ l_{11} $} (1, -4);
\draw (0, 0) to (0, -2) to [out=-90, in=135] node[above right, near end]{$ l_{12} $} (1, -4);
\draw (1, -4) arc (-90:60:3) node[below]{$ l_{13} $};
\draw (1, -4.5) node[below]{$ \PG\br{2, \FF_3} $};
\end{tikzpicture}
$$
}
\def\syllabus{Error-correcting codes. Linear codes. Hamming codes. The Golay code. Cyclic codes. BCH codes. Automorphism group of a code. Strongly regular graphs. Adjacency matrices. Strongly regular graphs from two weight codes. Automorphism group of a graph. $ t $-designs. Incidence matrices. Automorphism group of a design. Construction of $ 2 $-designs. Designs and strongly regular graphs.}
\def\thm{section}

\input{../style/header}

\begin{document}

\input{../style/cover}

\section{Introduction}

\lecture{1}{Tuesday}{09/10/18}

Combinatorics is the study of discrete structures. We will study
\begin{enumerate}
\item codes, which are subsets of $ \ZZ_2^n $,
\item graphs, which are vertices and edges, and
\item designs, which are collections of subsets of sets.
\end{enumerate}
Algebra is linear algebra, which are matrices and vector spaces, groups, rings, and fields. We use methods from linear algebra to study $ 1, 2, 3 $. Prerequisites are first and second year algebra. The following are recommended books.
\begin{itemize}
\item O Pretzel, Error-correcting codes and finite fields, 1992
\item J van Lint, Introduction to coding theory, 1976
\item D Hughes and F Piper, Design theory, 1985
\item N Biggs, Algebraic graph theory, 1974
\item C Godsil and G Royle, Algebraic graph theory, 2001
\item P Cameron and J van Lint, Designs, graphs, codes, and their links, 1991
\item N Biggs, Discrete mathematics, 1985
\end{itemize}

\subsection{Codes}

If the language is the alphabets $ a, b, \dots $, the words are certain strings of alphabets. A code is a language for machines. The language is $ 0, 1 \in \ZZ_2 $ and the words are certain strings in $ 0 $ and $ 1 $.

\begin{example*}
The ASCII code of keyboard symbols is $ A \mapsto 1000001 $ to $ 9 \mapsto 0111001 $. There are $ \sim80 $ symbols, so need length seven as $ 2^7 > 80 $.
\end{example*}

The following is the communication process.
$$ \text{message} \xrightarrow{\text{encode}} \text{codewords} \xrightarrow{\text{transmit}} \text{received message} \xrightarrow{\text{decode}} \text{decoded message}. $$
Errors in communication occur. What do we do? Language has lots of redundancies. Errors are easily corrected because no other words are close to received ones. The same idea for codes.

\begin{example*}
\hfill
\begin{itemize}
\item Two messages yes and no or $ 1 $ and $ 0 $. The codewords are $ 1 \mapsto 111 $ and $ 0 \mapsto 000 $. To decode, if the received string is not a codeword, such as $ 101 $, then we take majority $ 111 $. This code corrects one error.
\item Eight messages $ abc $ for $ a, b, c \in \ZZ_2 $. For each $ abc $, define codeword $ abcxyz $, where $ x = a + b, y = a + c, z = b + c $. So the code is
$$ C = \cbr{000000, 100110, 010101, 110011, 001011, 101101, 011110, 111000} \subseteq \ZZ_2^6. $$
Suppose the received string is $ 010110 $. Then $ abx = 011, acy = 001, bcz = 100 $. The error has to be with $ c $. The correct codeword is $ 011110 $. Claim that this code corrects one error, since
$$
\begin{array}{c|cccccc}
& a & b & c & x & y & z \\
\hline
abx & \times & \times & \checkmark & \times & \checkmark & \checkmark \\
acy & \times & \checkmark & \times & \checkmark & \times & \checkmark \\
bcz & \checkmark & \times & \times & \checkmark & \checkmark & \times
\end{array}.
$$
\end{itemize}
\end{example*}

The aims of coding theory are to find $ C \subseteq \ZZ_2^n $ such that
\begin{itemize}
\item $ C $ has lots of codewords,
\item $ C $ corrects as many errors as possible, and
\item the length $ n $ of $ C $ is as small as possible.
\end{itemize}

\pagebreak

\subsection{Graphs}

A graph is $ \br{V, E} $ where $ V $ is a set of vertices, and $ E $ is a collection of unordered pairs from $ V $ called edges, or $ 2 $-subsets of $ V $.

\begin{example*}
Let $ V = \cbr{1, 2, 3} $ and $ E = \cbr{\cbr{1, 2}, \cbr{2, 3}} $. Then
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ 1 $};
\fill (1, -0.5) circle (0.1) node[right]{$ 2 $};
\fill (0, -1) circle (0.1) node[left]{$ 3 $};
\draw (0, 0) to (1, -0.5);
\draw (1, -0.5) to (0, -1);
\end{tikzpicture}.
$$
\end{example*}

We will study certain types of graphs. If $ \cbr{i, j} \in E $, say $ i $ is adjacent to $ j $, or $ i $ is joined to $ j $, or $ i $ and $ j $ are neighbours. A graph is regular if every vertex has the same number $ k $ of neighbours. The valency, or degree, is $ k $.

\begin{example*}
$$
\begin{array}{ccccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (0.5, -0.5) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (-0.5, -0.5);
\draw (0, 0) to (0.5, -0.5);
\draw (-0.5, -0.5) to (-0.5, -1);
\draw (0.5, -0.5) to (0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0, -1);
\draw (0, 0) to (1, -1);
\draw (1, 0) to (0, -1);
\draw (1, 0) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0, -1);
\draw (1, 0) to (0, -1);
\draw (1, 0) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
\\
\text{regular} & & \text{regular} & & \text{not regular} \\
k = 2 & & k = 3 & &
\end{array}
$$
\end{example*}

A graph is strongly regular if
\begin{itemize}
\item it is regular of valency $ k $,
\item any two adjacent vertices have the same number $ \lambda $ of common neighbours, and
\item any two non-adjacent vertices have the same number $ \mu $ of common neighbours.
\end{itemize}

\begin{example*}
$$
\begin{array}{ccccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0, -1);
\draw (1, 0) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0, -1);
\draw (1.5, -0.5) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
\\
\text{strongly regular} & & \text{strongly regular} & & \text{not strongly regular} \\
k = 2 & & k = 2 & & k = 2 \\
\lambda = 0 & & \lambda = 0 & & \lambda = 0 \\
\mu = 2 & & \mu = 1 & &
\end{array}
$$
\end{example*}

\begin{example*}
The \textbf{Petersen graph}
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (2, 0) circle (0.1);
\fill (0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (2.5, -1) circle (0.1);
\fill (2, -1) circle (0.1);
\fill (1, -1.5) circle (0.1);
\fill (1, -2) circle (0.1);
\draw (0, 0) to (2, 0);
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -0.5);
\draw (2, 0) to (1.5, -0.5);
\draw (2, 0) to (2.5, -1);
\draw (0.5, -0.5) to (1, -1.5);
\draw (0.5, -0.5) to (2, -1);
\draw (1.5, -0.5) to (0, -1);
\draw (1.5, -0.5) to (1, -1.5);
\draw (-0.5, -1) to (0, -1);
\draw (-0.5, -1) to (1, -2);
\draw (0, -1) to (2, -1);
\draw (2, -1) to (2.5, -1);
\draw (2.5, -1) to (1, -2);
\draw (1, -1.5) to (1, -2);
\end{tikzpicture}
$$
is strongly regular of $ k = 3, \lambda = 0, \mu = 1 $.
\end{example*}

\lecture{2}{Tuesday}{09/10/18}

Here is a famous friendship theorem. In a community where any two people have exactly one common acquaintance, there is someone who knows everyone. For the graph, vertices are people and join two people if they know each other. Theorem says that if any two vertices have exactly one common neighbour, then the graph is a windmill
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\fill (1.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw [dashed] (0, 0) to (-0.5, -0.5);
\draw (0, 0) to (0.5, -1);
\draw (1, 0) to (0.5, -1);
\draw [dashed] (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (-0.5, -1);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (1.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\draw (0.5, -1) to (1.5, -1);
\end{tikzpicture}.
$$
Many proofs, all use linear algebra.

\pagebreak

\subsection{Designs}

Let $ v $ be varieties of cereal to be tested by consumers such that each consumer tests the same number $ k $ of varieties, and each variety is tested by the same number $ r $ of consumers.

\begin{example*}
Let $ v = 7, k = 3, r = 3 $, and seven consumers $ c_1, \dots, c_7 $. Then
$$
\begin{array}{c|ccccccc}
& c_1 & c_2 & c_3 & c_4 & c_5 & c_6 & c_7 \\
\hline
\text{varieties} & 123 & 145 & 356 & 167 & 257 & 347 & 246
\end{array}
$$
is a design.
\end{example*}

Let $ X $ be a set such that $ \abs{X} = v $ and $ \BBB $ be a collection of subsets of $ X $. Say $ \BBB $ is a design with parameters $ v, k, r $ if each set in $ \BBB $ has $ k $ elements, and each element of $ X $ lies in exactly $ r $ elements of $ \BBB $. The elements of $ \BBB $ are called blocks.

\begin{example*}
The above
$$ X = \cbr{1, 2, 3, 4, 5, 6, 7}, \qquad \BBB = \cbr{\cbr{1, 2, 3}, \cbr{1, 4, 5}, \cbr{3, 5, 6}, \cbr{1, 6, 7}, \cbr{2, 5, 7}, \cbr{3, 4, 7}, \cbr{2, 4, 6}} $$
is a design with parameters $ 7, 3, 3 $.
\end{example*}

Designs are too common to be interesting. More interesting is each pair of varieties lies in the same number $ \lambda $ of blocks. A design $ \BBB $ is a $ 2 $-design if every pair of points lies in the same number $ \lambda $ of blocks.

\begin{example*}
The above design is a $ 2 $-design with $ \lambda = 1 $.
\end{example*}

More generally, $ \BBB $ is a $ t $-design if every set of $ t $ elements is in the same number $ \lambda $ of blocks. $ 2 $-designs are common, and $ t \ge 3 $ less so. The first non-trivial $ 6 $-design, so not all $ k $-sets are blocks, was only found in 1982.

\begin{example*}
$ 2 $-designs from geometry.
\begin{itemize}
\item The \textbf{Fano plane}
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above]{$ 1 $};
\fill (-0.5, -1) circle (0.1) node[left]{$ 2 $};
\fill (0.5, -1) circle (0.1) node[right]{$ 4 $};
\fill (0, -1.35) circle (0.1) node[below]{$ 7 $};
\fill (-1, -2) circle (0.1) node[left]{$ 3 $};
\fill (0, -2) circle (0.1) node[below]{$ 6 $};
\fill (1, -2) circle (0.1) node[right]{$ 5 $};
\draw (0, 0) to (-1, -2);
\draw (0, 0) to (0, -2);
\draw (0, 0) to (1, -2);
\draw (-0.5, -1) to (1, -2);
\draw (0.5, -1) to (-1, -2);
\draw (-1, -2) to (1, -2);
\draw (0, -1.35) circle (0.6);
\end{tikzpicture}
$$
is the projective plane of order two. Projective planes exist for all powers of $ p $ for $ p $ prime.
\item Let $ p $ be prime. Then $ \ZZ_p = \cbr{0, \dots, p - 1} $ is a field, since $ \br{\ZZ_p, +} $ is a group, $ \br{\ZZ_p^\times, \times} $ is a group, and $ a\br{b + c} = ab + ac $. Define
$$ \ZZ_p^2 = \cbr{\br{x_1, x_2} \st x_i \in \ZZ_p}, $$
a plane with $ p^2 $ points. Define a line in $ \ZZ_p^2 $ to be the solutions of an equation $ ax + by + c = 0 $ for $ a, b, c \in \ZZ_p $. Any two points are on a unique line. Let $ X = \ZZ_p^2 $ and $ \BBB $ be lines. This is a $ 2 $-design with parameters
$$ v = p^2, \qquad k = p, \qquad r = p + 1, \qquad \lambda = 1. $$
\end{itemize}
\end{example*}

We will study
\begin{itemize}
\item constructions of $ t $-designs,
\item conditions on parameters, such as
\begin{itemize}
\item if design parameters are $ v, k, r $ then easily $ b = vr / k $, so $ k \mid vr $ and $ vr / k \le \binom{v}{k} $,
\item in non-trivial $ 2 $-design, $ b \ge v $, so $ r \ge k $, by linear algebra, and
\end{itemize}
\item links to codes and graphs.
\end{itemize}

\pagebreak

\section{Codes}

\subsection{Error-correcting codes}

$ \ZZ_2 = \cbr{0, 1} $ is a field, and
$$ \ZZ_2^n = \cbr{\br{x_1, \dots, x_n} \st x_i \in \ZZ_2} $$
is a vector space over $ \ZZ_2 $ with
$$ \br{x_1, \dots, x_n} + \br{y_1, \dots, y_n} = \br{x_1 + y_1, \dots, x_n + y_n}, \qquad \lambda\br{x_1, \dots, x_n} = \br{\lambda x_1, \dots, \lambda x_n}. $$

\begin{example*}
In $ \ZZ_2^4 $, $ 0010 + 1010 = 1000 $.
\end{example*}

\begin{definition*}
A \textbf{code} $ C $ of \textbf{length} $ n $ is a subset of $ \ZZ_2^n $. The elements of $ C $ are called \textbf{codewords}. The \textbf{distance} between $ x, y \in \ZZ_2^n $ is $ \d\br{x, y} $, the number of places where $ x $ and $ y $ differ.
\end{definition*}

\begin{example*}
$ \d\br{01101, 10111} = 3 $.
\end{example*}

\begin{proposition}[Triangle inequality]
\label{prop:1.1}
$$ \d\br{x, y} + \d\br{y, z} \ge \d\br{x, z}. $$
\end{proposition}

\begin{proof}
Let
$$ A = \cbr{i \st x_i \ne z_i}, \qquad B = \cbr{i \st x_i = y_i, \ x_i \ne z_i}, \qquad C = \cbr{i \st x_i \ne y_i, \ x_i \ne z_i}. $$
Then
$$ \d\br{x, z} = \abs{A}, \qquad \abs{B} + \abs{C} = \abs{A}, \qquad \abs{C} \le \d\br{x, y}, \qquad \abs{B} \le \d\br{y, z}. $$
\end{proof}

\lecture{3}{Wednesday}{10/10/18}

\begin{definition*}
The \textbf{minimum distance} of a code $ C \subseteq \ZZ_2^n $ is
$$ \d\br{C} = \min\cbr{\d\br{x, y} \st x, y \in C, \ x \ne y}. $$
\end{definition*}

Say a code $ C $ corrects $ e $ errors if when $ c \in C $ is sent and $ w \in \ZZ_2^n $ is received, then $ c $ is the nearest codeword to $ w $.

\begin{definition*}
Let $ e \ge 1 $. Then $ C $ \textbf{corrects $ e $ errors} if for any $ c_1, c_2 \in C $ and $ w \in \ZZ_2^n $, $ \d\br{c_1, w} \le e $ and $ \d\br{c_2, w} \le e $ implies that $ c_1 = c_2 $. For an equivalent definition, let
$$ \S_e\br{c} = \cbr{w \in \ZZ_2^n \st \d\br{c, w} \le e}. $$
Then $ C $ corrects $ e $ errors if $ \S_e\br{c} \cap \S_e\br{d} = \emptyset $ for any $ c, d \in C $ such that $ c \ne d $.
\end{definition*}

\begin{proposition}
\label{prop:1.2}
$ C $ corrects $ e $ errors if and only if $ \d\br{C} \ge 2e + 1 $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item[$ \implies $] Sheet $ 1 $. \footnote{Exercise}
\item[$ \impliedby $] Suppose $ \d\br{C} \ge 2e + 1 $. Suppose $ c_1, c_2 \in C $ and $ w \in \ZZ_2^n $ where $ \d\br{c_1, w} \le e $ and $ \d\br{c_2, w} \le e $. Then $ \d\br{c_1, c_2} \le 2e $ by \ref{prop:1.1}, so $ c_1 = c_2 $. Thus $ C $ corrects $ e $ errors.
\end{itemize}
\end{proof}

\pagebreak

\subsection{Linear codes}

\subsubsection{Linear codes}

\begin{definition*}
A code $ C \subseteq \ZZ_2^n $ is \textbf{linear} if it is a subspace of $ \ZZ_2^n $. That is
\begin{itemize}
\item $ 0 \in C $, and
\item $ x, y \in C $ implies that $ x + y \in C $.
\end{itemize}
\end{definition*}

\begin{proposition}
Let $ A $ be an $ m \times n $ matrix over $ \ZZ_2 $. Then
$$ C = \cbr{x \in \ZZ_2^n \st Ax^\intercal = 0} $$
is a linear code of dimension $ n - \rk A $.
\end{proposition}

\begin{proof}
By first year linear algebra.
\end{proof}

\begin{example*}
The code
$$ \C_3 = \cbr{abcxyz \st x = a + b, \ y = a + c, \ z = b + c} = \cbr{x \in \ZZ_2^6 \st \threebythree{1 & 1}{0 & 1}{0 & 0}{1 & 0}{1 & 0}{1 & 0}{0 & 1}{1 & 0}{0 & 1}x^\intercal = 0} \subseteq \ZZ_2^6 $$
is linear. This is the \textbf{triple check code}, where messages are $ a, b, c $ and check bits are $ x, y, z $. Then $ \dim \C_3 = 3 $ and a basis is
$$ 100110, \qquad 010101, \qquad 001011. $$
\end{example*}

\begin{proposition}
Let $ C \subseteq \ZZ_2^n $ be a linear code. If $ k = \dim C $, then $ \abs{C} = 2^k $.
\end{proposition}

\begin{proof}
A basis for $ C $ is $ c_1, \dots, c_k $. Every $ c \in C $ has the form $ \lambda_1c_1 + \dots + \lambda_kc_k $ for some $ \lambda_i = 0, 1 $. There are $ 2^k $ such expressions.
\end{proof}

\subsubsection{Minimum distance}

\begin{definition*}
For $ x \in \ZZ_2^n $, the \textbf{weight} of $ x $ is the number of non-zero entries of $ x $. Denote it by $ \wt x $.
\end{definition*}

\begin{note*}
$ \wt x = \d\br{x, 0} $.
\end{note*}

\begin{example*}
$ 1101 $ has weight three.
\end{example*}

\begin{proposition}
\label{prop:1.5}
If $ C $ is a linear code, then
$$ \d\br{C} = \min\cbr{\wt c \st c \in C, \ c \ne 0}. $$
\end{proposition}

\begin{proof}
Let $ 0 \ne c \in C $ be of minimum weight. Say $ \wt c = r $. Then $ 0, c \in C $, so $ \d\br{c, 0} = \wt c = r $, so $ \d\br{C} \le r $. For $ x, y \in C $ with $ x \ne y $, $ \d\br{x, y} = \wt \br{x + y} \ge r $, since $ x + y \in C $. Thus $ \d\br{C} \ge r $. Thus $ \d\br{C} = r $.
\end{proof}

\begin{example*}
Let $ \C_3 = \cbr{abcxyz} $. Then
$$ \d\br{\C_3} = \min\cbr{\wt c \st c \in \C_3, \ c \ne 0} = 3. $$
Thus $ \C_3 $ corrects one error by \ref{prop:1.2}.
\end{example*}

The aims are to find linear codes $ C $ with
\begin{itemize}
\item large $ \dim C $, so lots of codewords,
\item large $ \d\br{C} $, so corrects lots of errors, and
\item small length of $ C $, so save space.
\end{itemize}

\pagebreak

\subsubsection{Check matrix and error correction}

\begin{definition*}
If $ A $ is an $ m \times n $ matrix over $ \ZZ_2 $ and $ C $ is the linear code $ C = \cbr{x \in \ZZ_2^n \st Ax^\intercal = 0} $, then we call $ A $ the \textbf{check matrix} of code $ C $.
\end{definition*}

\begin{remark*}
A check matrix always exists for a linear code.
\end{remark*}

\begin{proposition}
\label{prop:1.6}
Suppose a check matrix $ A $ for a linear code $ C $ has no zero column and no two columns are equal. Then $ C $ corrects one error.
\end{proposition}

\begin{proof}
By \ref{prop:1.2}, need to show $ \d\br{C} \ge 3 $. By \ref{prop:1.5}, equivalent to show that the minimum weight is at least $ 3 $. Suppose for a contradiction that there exists $ 0 \ne c \in C $ such that $ \wt c \le 2 $. If $ \wt c = 1 $, then
$$ c = e_i = \onebythree{0 \dots 0}{1}{0 \dots 0}, $$
so $ 0 = Ac^\intercal = Ae_i^\intercal = \col i $, a contradiction. If $ \wt c = 2 $, then $ c = e_i + e_j $, so
$$ 0 = A\br{e_i^\intercal + e_j^\intercal} = Ae_i^\intercal + Ae_j^\intercal = \col i + \col j, $$
so $ \col i = \col j $, a contradiction.
\end{proof}

\begin{example*}
\hfill
\begin{itemize}
\item The triple check code is
$$ \C_3 = \cbr{x \in \ZZ_2^6 \st \threebythree{1 & 1}{0 & 1}{0 & 0}{1 & 0}{1 & 0}{1 & 0}{0 & 1}{1 & 0}{0 & 1}x^\intercal = 0}. $$
Thus $ \C_3 $ corrects one error.
\item Suppose we want a linear code with a $ 3 \times n $ check matrix $ A $ correcting one error. What is $ \max\br{\dim C} $? By \ref{prop:1.6}, take $ A $ to have all distinct columns in $ \ZZ_2^3 $,
$$ A = \threebyone{1 & 1 & 1 & 0 & 1 & 0 & 0}{1 & 1 & 0 & 1 & 0 & 1 & 0}{1 & 0 & 1 & 1 & 0 & 0 & 1}. $$
So $ C \subseteq \ZZ_2^7 $, $ \dim C = 4 $, $ \abs{C} = 16 $, and
$$ C = \cbr{x_1 \dots x_7 \st x_5 = x_1 + x_2 + x_3, \ x_6 = x_1 + x_2 + x_4, \ x_7 = x_1 + x_3 + x_4}. $$
Uses three check bits to encode messages $ x_1, x_2, x_3, x_4 $. A basis is
$$ 1000111, \qquad 0100110, \qquad 0010101, \qquad 0001011. $$
\end{itemize}
\end{example*}

\subsection{Hamming codes}

\subsubsection{Hamming codes}

\lecture{4}{Tuesday}{16/10/18}

These are the best codes correcting one error.

\begin{definition*}
Let $ k \ge 2 $. A \textbf{Hamming code} $ \Ham k $ is a linear code whose check matrix has as columns all distinct non-zero vectors in $ \ZZ_2^k $.
\end{definition*}

\setcounter{MaxMatrixCols}{15}

\begin{example*}
\hfill
\begin{itemize}
\item $ \Ham 3 $ is the example before.
\item $ \Ham 4 $ has check matrix
$$
\begin{pmatrix}
1 & 1 & 1 & 1 & 0 & 1 & 1 & 1 & 0 & 0 & 0 & 1 & 0 & 0 & 0 \\
1 & 1 & 1 & 0 & 1 & 1 & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 0 & 0 \\
1 & 1 & 0 & 1 & 1 & 0 & 1 & 0 & 1 & 0 & 1 & 0 & 0 & 1 & 0 \\
1 & 0 & 1 & 1 & 1 & 0 & 0 & 1 & 0 & 1 & 1 & 0 & 0 & 0 & 1
\end{pmatrix}.
$$
Length is $ 15 $, dimension is $ 11 $, and four check bits for messages $ x_1, \dots, x_{11} $.
\end{itemize}
\end{example*}

\pagebreak

\setcounter{MaxMatrixCols}{10}

\begin{definition*}
Two linear codes are \textbf{equivalent} if one is obtained from the other by permuting coordinates, that is by permuting the columns of check matrix.
\end{definition*}

So all $ \Ham k $'s are equivalent, and we say the Hamming code.

\begin{proposition}
\label{prop:1.7}
\hfill
\begin{enumerate}
\item $ \Ham k $ corrects one error.
\item $ \Ham k $ has length $ 2^k - 1 $ and dimension $ 2^k - k - 1 $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Holds by \ref{prop:1.6}.
\item The number of columns in $ \ZZ_2^k \setminus \cbr{0} $ is $ 2^k - 1 $, so check matrix $ A_k $ is $ k \times \br{2^k - 1} $. Thus length is $ 2^k - 1 $ and dimension is $ 2^k - 1 - \rk A_k = 2^k - 1 - k $.
\end{enumerate}
\end{proof}

\subsubsection{Correcting one error}

Suppose we have a linear code $ C $ with check matrix $ A $, correcting one error. How do we correct one error? Suppose $ c \in C $ is sent, obtain an error, say in $ i $-th coordinate. So received vector is $ c' = c + e_i $. Then
$$ Ac'^\intercal = Ac^\intercal + Ae_i^\intercal = 0 + \col i. $$
So we correct $ i $-th bit of $ c' $, where $ Ac'^\intercal = \col i $.

\begin{example*}
The triple check code has check matrix
$$ A = \threebythree{1 & 1}{0 & 1}{0 & 0}{1 & 0}{1 & 0}{1 & 0}{0 & 1}{1 & 0}{0 & 1}. $$
Receive $ c' = 100010 $. Then $ Ac'^\intercal = 100^\intercal $, so the fourth coordinate is wrong. Thus the correct codeword is $ c = 100110 $.
\end{example*}

\subsubsection{Correcting more than one error}

\begin{proposition}
\label{prop:1.8}
Let $ d \in \ZZ_{\ge 2} $. Let $ C $ be a linear code with check matrix $ A $. Suppose that any $ d - 1 $ columns of $ A $ are linearly independent. Then
\begin{enumerate}
\item $ \d\br{C} \ge d $, and
\item if there exists $ d $ linearly dependent columns, then $ \d\br{C} = d $.
\end{enumerate}
\end{proposition}

\begin{note*}
Agrees with \ref{prop:1.6}.
\end{note*}

\begin{proof}
\hfill
\begin{enumerate}
\item Suppose $ \d\br{C} \le d - 1 $. By \ref{prop:1.5}, there exists $ 0 \ne c \in C $ with $ \wt c = r \le d - 1 $. So $ c = e_{i_1} + \dots + e_{i_r} $. Then
$$ 0 = Ac^\intercal = Ae_{i_1}^\intercal + \dots + Ae_{i_r}^\intercal = \col i_1 + \dots + \col i_r. $$
By assumption, these $ r $ columns are linearly independent, a contradiction. Thus $ \d\br{C} \ge d $.
\item Say columns $ i_1, \dots, i_d $ are linearly dependent. By assumption, no fewer columns are dependent. Hence
$$ 0 = \col i_1 + \dots + \col i_d = A\br{e_{i_1} + \dots + e_{i_d}}^\intercal. $$
So $ c = e_{i_1} + \dots + e_{i_d} \in C $ and $ \wt c = d $.
\end{enumerate}
\end{proof}

\pagebreak

\begin{example*}
Find a linear code $ C $ of length nine, dimension two, correcting two errors. Want $ 7 \times 9 $ check matrix $ A $, of rank seven. Can do row operations and permute columns to put $ A $ in the form
$$ A =
\begin{pmatrix}
& & 1 & & 0 \\
c_1 & c_2 & & \ddots & \\
& & 0 & & 1
\end{pmatrix}.
$$
Need $ \d\br{C} \ge 5 $ to correct two errors. Need any four columns of $ A $ to be linearly independent. Need
\begin{enumerate}
\item $ \wt c_1 \ge 4 $, else $ c_1 $ is the sum of at most three $ e_i $'s, a contradiction, and
\item $ \wt \br{c_1 + c_2} \ge 3 $, else $ c_1 $ is the sum of at most two $ e_i $'s, a contradiction.
\end{enumerate}
Given $ 1 $ and $ 2 $, any four columns will be linearly independent. Thus
$$ c_1 =
\begin{pmatrix}
1 & 1 & 1 & 1 & 0 & 0 & 0
\end{pmatrix}^\intercal,
\qquad c_2 =
\begin{pmatrix}
0 & 0 & 0 & 0 & 1 & 1 & 1
\end{pmatrix}^\intercal,
$$
so
$$ C = \cbr{abaaa\br{a + b}bbb \st a, b \in \ZZ_2} = \cbr{000000000, 101111000, 010001111, 111110111} $$
has dimension two, length nine, and corrects two errors.
\end{example*}

\subsubsection{Hamming bound}

Recall that for $ v \in \ZZ_2^n $ and $ e \ge 1 $, $ \S_e\br{v} = \cbr{w \in \ZZ_2^n \st \d\br{w, v} \le e} $.

\begin{proposition}
\label{prop:1.9}
$$ \abs{\S_e\br{v}} = \binom{n}{0} + \dots + \binom{n}{e}. $$
\end{proposition}

\begin{proof}
$ \abs{\S_e\br{v}} = d_0 + \dots + d_e $, where $ d_i $ is the number of vectors $ w \in \ZZ_2^n $ such that $ \d\br{v, w} = i $. The vector distance $ i $ from $ v $ are those where we change $ i $ of the coordinates. Thus $ d_i = \binom{n}{i} $.
\end{proof}

\begin{theorem}[Hamming bound]
\label{thm:1.10}
If $ C \in \ZZ_2^n $ corrects $ e $ errors, then
$$ \abs{C} \le \dfrac{2^n}{\binom{n}{0} + \dots + \binom{n}{e}}. $$
\end{theorem}

\lecture{5}{Tuesday}{16/10/18}

\begin{proof}
By definition, the spheres $ \S_e\br{c} $ for $ c \in C $ are disjoint. So
$$ \abs{\bigcup_{c \in C} \S_e\br{c}} = \abs{C}\abs{\S_e\br{c}} = \abs{C}\br{\binom{n}{0} + \dots + \binom{n}{e}}, $$
by \ref{prop:1.9}. Of course, $ \abs{\bigcup_{c \in C} \S_e\br{c}} \le 2^n $. Thus $ \abs{C}\br{\binom{n}{0} + \dots + \binom{n}{e}} \le 2^n $.
\end{proof}

\begin{example*}
Let $ C $ be a linear code of length nine correcting two errors. What is $ \max\br{\dim C} $? By \ref{thm:1.10},
$$ \abs{C} \le \dfrac{2^9}{\binom{9}{0} + \binom{9}{1} + \binom{9}{2}} = \dfrac{512}{46} < 12. $$
Then $ \abs{C} = 2^{\dim C} $, since $ C $ is linear. So $ \dim C \le 3 $.
\end{example*}

\pagebreak

The previous example is that there exists $ C $ of dimension two. Does there exist $ C $ of dimension three? Need $ 6 \times 9 $ check matrix, of rank six. Then
$$ A =
\begin{pmatrix}
& & & 1 & & 0 \\
c_1 & c_2 & c_3 & & \ddots & \\
& & & 0 & & 1
\end{pmatrix},
$$
with any four columns linearly independent. So need
\begin{itemize}
\item $ \wt c_i \ge 4 $,
\item $ \wt \br{c_i + c_j} \ge 3 $, and
\item $ \wt \br{c_1 + c_2 + c_3} \ge 2 $.
\end{itemize}
Do such codewords exist?

\subsubsection{Perfect codes}

If $ C \subseteq \ZZ_2^n $ corrects $ e $ errors, then spheres $ \S_e\br{c} $ for $ c \in C $ are disjoint and $ \bigcup_{c \in C} \subseteq \ZZ_2^n $. Equality is interesting.

\begin{definition*}
A code $ C \subseteq \ZZ_2^n $ is \textbf{$ e $-perfect} if $ C $ corrects $ e $ errors and
$$ \abs{C} = \dfrac{2^n}{\binom{n}{0} + \dots + \binom{n}{e}}. $$
Equivalently, $ \ZZ_2^n $ is a disjoint union of spheres $ \S_e\br{c} $ for $ c \in C $.
\end{definition*}

\begin{proposition}
Let $ C \subseteq \ZZ_2^n $. Then $ \abs{C} = 2^n / \br{n + 1} $ if and only if $ n = 2^k - 1 $ and $ \abs{C} = 2^{n - k} $ for some $ k $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item[$ \implies $] Suppose $ \abs{C} = 2^n / \br{n + 1} $. Then $ n + 1 = 2^k $ for some $ k $. Then $ \abs{C} = 2^{n - k} $ and $ n = 2^k - 1 $.
\item[$ \impliedby $] Suppose $ n = 2^k - 1 $ and $ \abs{C} = 2^{n - k} $ for some $ k $. Then $ \abs{C} = 2^n / 2^k = 2^n / \br{n + 1} $.
\end{itemize}
\end{proof}

\begin{example*}
$ \Ham k $ is $ 1 $-perfect by \ref{prop:1.7}, since length is $ 2^k - 1 $ and dimension is $ 2^k - k - 1 = \br{2^k - 1} - k $.
\end{example*}

Are there any more perfect codes? If $ C $ is $ e $-perfect then
$$ \binom{n}{0} + \dots + \binom{n}{e} = 2^k, $$
which is rare.

\begin{example*}
Let $ e = 2 $. Then
$$ \binom{n}{0} + \binom{n}{1} + \binom{n}{2} = 2^k, $$
so $ n^2 + n + 2 = 2^{k + 1} $, which is rare.
\end{example*}

The following is a famous theorem, by van Lint-Tietavainen in 1973. The only $ e $-perfect codes $ C $ for $ e \ge 1 $ and $ \abs{c} > 1 $ are
\begin{itemize}
\item $ e = 1 $ and $ C = \Ham k $,
\item $ n = 2e + 1 $, $ \dim C = 1 $, and $ C = \cbr{0 \dots 0, 1 \dots 1} $, and
\item $ e = 3 $, $ n = 23 $, and $ \dim C = 12 $ is the Golay code, which is a miracle, since
$$ \binom{23}{0} + \binom{23}{1} + \binom{23}{2} + \binom{23}{3} = 2048 = 2^{11}. $$
\end{itemize}

\pagebreak

\subsubsection{Gilbert-Varshamov bound}

\begin{example*}
Let $ C $ be a linear code of length $ 15 $ correcting two errors. What is the largest possible $ \dim C $? By the Hamming bound,
$$ \abs{C} \le \dfrac{2^{15}}{\binom{15}{0} + \binom{15}{1} + \binom{15}{2}} = \dfrac{2^{15}}{121} < 2^9. $$
So $ \dim C \le 8 $. This is a negative result. There are no such codes of dimension at least nine. What about positive results?
\end{example*}

\begin{theorem}[G-V bound]
\label{thm:1.12}
Let $ n, k, d \in \ZZ $, where $ 2 \le d \le n $ and $ 1 \le k \le n $, such that
\begin{equation}
\label{eq:1}
\binom{n - 1}{0} + \dots + \binom{n - 1}{d - 2} < 2^{n - k}.
\end{equation}
Then there exists a linear code $ C $ of length $ n $ and dimension $ l $ with $ \d\br{C} \ge d $.
\end{theorem}

\begin{example*}
Let $ C \subseteq \ZZ_2^{15} $ correcting two errors. Want $ \d\br{C} \ge 5 $. Putting $ n = 15 $ and $ d = 5 $ into $ \br{\ref{eq:1}} $,
$$ \binom{14}{0} + \binom{14}{1} + \binom{14}{2} + \binom{14}{3} = 1 + 14 + 91 + 364 < 512 = 2^9 = 2^{15 - 6}. $$
So by \ref{thm:1.12}, there exists such a $ C $ with $ \dim C = 6 $. Does there exist $ C $ of dimension seven or eight? \ref{thm:1.12} says nothing.
\end{example*}

A warning is do not use the G-V bound to prove non-existence.

\begin{proof}
Need to find check matrix $ A $ satisfying
\begin{enumerate}
\item $ A $ is $ \br{n - k} \times n $ matrix of rank $ n - k $, and
\item any $ d - 1 $ columns of $ A $ are linearly independent, using \ref{prop:1.8}.
\end{enumerate}
We construct $ A $ inductively, adding one column at a time, satisfying $ 2 $ at each step. Start with $ n - k $ columns $ e_1, \dots, e_{n - k} \in \ZZ_2^{n - k} $. Write $ c_i = e_i $. Now suppose we have $ i $ columns $ c_1, \dots, c_i $, where $ n - k \le i \le n - 1 $. Let $ A_1 = \onebythree{c_1}{\dots}{c_i} $ be $ \br{n - k} \times i $, with any $ d - 1 $ columns linearly independent. The number of vectors in $ \ZZ_2^{n - k} $ in the span of at most $ d - 2 $ of $ c_1, \dots, c_i $ is at most $ N_i = \binom{i}{0} + \dots + \binom{i}{d - 2} $. Since $ i \le n - 1 $, $ N_i < 2^{n - k} $ by hypothesis $ \br{\ref{eq:1}} $. Hence there exists a vector $ c_{i + 1} \in \ZZ_2^{n - k} $ that is not in the span of at most $ d - 2 $ of $ c_1, \dots, c_i $. Let $ A_{i + 1} = \onebythree{c_1}{\dots}{c_{i + 1}} $. Then any $ d - 1 $ columns of $ A_{i + 1} $ are linearly independent. This process constructs $ A_{n - k}, \dots, A_n $. So $ A = A_n $ satisfies $ 1 $ and $ 2 $, as required.
\end{proof}

\subsection{The Golay code}

\lecture{6}{Wednesday}{17/10/18}

This is the famous $ 3 $-perfect code of length $ 23 $ and dimension $ 12 $. First we will construct the extended Golay code $ \G_{24} \subseteq \ZZ_2^{24} $.

\subsubsection{Construction of \texorpdfstring{$ \G_{24} $}{G24}}

Start with $ H = \Ham 3 $, so check matrix is
$$ A = \threebyone{1 & 1 & 1 & 0 & 1 & 0 & 0}{1 & 1 & 0 & 1 & 0 & 1 & 0}{1 & 0 & 1 & 1 & 0 & 0 & 1}. $$
Form \textbf{reverse} code $ K $, with check matrix
$$ A = \threebyone{0 & 0 & 1 & 0 & 1 & 1 & 1}{0 & 1 & 0 & 1 & 0 & 1 & 1}{1 & 0 & 0 & 1 & 1 & 0 & 1}. $$

\pagebreak

Add parity check to $ H $ and $ K $, so sum of bits, to get length eight codes $ H' $ and $ K' $,
$$ H' = \cbr{
\begin{array}{cccccccc}
00000000, 10001110, 10110010, 11010100, 11101000, 01011010, 01100110, 00111100 \\
11111111, 01110001, 01001101, 00101011, 00010111, 10100101, 10011001, 11000011
\end{array}
}, $$
$$ K' = \cbr{
\begin{array}{cccccccc}
00000000, 11100010, 10011010, 01010110, 00101110, 10110100, 11001100, 01111000 \\
11111111, 00011101, 01100101, 10101001, 11010001, 01001011, 00110011, 10000111
\end{array}
}. $$

\begin{note*}
\hfill
\begin{itemize}
\item $ H' $ and $ K' $ are linear of length eight and dimension four.
\item All codewords of $ H' $ and $ K' $ have weight zero, four, or eight.
\item The $ 14 $ weight four codewords in $ H' $ form a $ 3 $-design.
\end{itemize}
\end{note*}

\begin{proposition}
\label{prop:1.13}
$$ H \cap K = \cbr{0000000, 1111111}, \qquad H' \cap K' = \cbr{00000000, 11111111}. $$
\end{proposition}

\begin{proof}
Let $ v \in H \cap K $. Then $ v \in H $, so
$$ v = abcd\br{a + b + c}\br{a + b + d}\br{a + c + d}, \qquad a, b, c, d \in \ZZ_2. $$
So $ v \in K $, so
\begin{itemize}
\item $ c + \br{a + b + c} + \br{a + b + d} + \br{a + c + d} = 0 $, so $ a + c = 0 $,
\item $ b + d + \br{a + b + d} + \br{a + c + d} = 0 $, so $ c + d = 0 $, and
\item $ a + d + \br{a + b + c} + \br{a + c + d} = 0 $, so $ a + b = 0 $.
\end{itemize}
Thus $ a = b = c = d $, so $ v = 0000000 $ or $ v = 1111111 $.
\end{proof}

\begin{definition*}
The \textbf{extended Golay code} $ \G_{24} $ consists of all vectors in $ \ZZ_2^{24} $ of the form
$$ \br{a + x}\br{b + x}\br{a + b + x}, \qquad a, b \in H', \qquad x \in K'. $$
\end{definition*}

\begin{example*}
Some codewords in $ \G_{24} $.
\begin{itemize}
\item $ 0^{24} \in \G_{24} $.
\item $ a = b = 0^8 $ and $ x = 1^8 $, so $ 1^{24} \in \G_{24} $.
\item $ a = x = 1^8 $ and $ b = 0^8 $, so $ 0^81^80^8 \in \G_{24} $.
\item $ a = 10001110, b = 10011001, x = 01001011 $, so $ 110001011101001001011100 \in \G_{24} $.
\end{itemize}
\end{example*}

\begin{proposition}
$ \G_{24} $ is a linear code of dimension $ 12 $.
\end{proposition}

\begin{proof}
Linear, since $ 0^{24} \in \G_{24} $ and
\begin{align*}
& \br{a_1 + x_1}\br{b_1 + x_1}\br{a_1 + b_1 + x_1} + \br{a_2 + x_2}\br{b_2 + x_2}\br{a_2 + b_2 + x_2} & a_i, b_i \in H', \qquad x_i \in K' \\
= & \br{a_1 + a_2 + x_1 + x_2}\br{b_1 + b_2 + x_1 + x_2}\br{a_1 + a_2 + b_1 + b_2 + x_1 + x_2} \in \G_{24},
\end{align*}
since $ a_1 + a_2, b_1 + b_2 \in H' $ and $ x_1 + x_2 \in K' $. For dimension, suppose
$$ \br{a_1 + x_1}\br{b_1 + x_1}\br{a_1 + b_1 + x_1} = \br{a_2 + x_2}\br{b_2 + x_2}\br{a_2 + b_2 + x_2}, \qquad a_i, b_i \in H', \qquad x_i \in K'. $$
Then
\begin{enumerate}
\item $ a_1 + x_1 = a_2 + x_2 $,
\item $ b_1 + x_1 = b_2 + x_2 $, and
\item $ a_1 + b_1 + x_1 = a_2 + b_2 + x_2 $.
\end{enumerate}
$ 1 $ and $ 2 $ implies that $ a_1 + b_1 = a_2 + b_2 $. Substituting in $ 3 $, $ x_1 = x_2 $, so $ 1 $ and $ 2 $ implies that $ a_1 = a_2 $ and $ b_1 = b_2 $. Thus distinct choices of triple $ abx $ give distinct codewords in $ \G_{24} $. Thus $ \abs{\G_{24}} $ is the number of triples $ abx $, which is $ 2^4 \cdot 2^4 \cdot 2^4 = 2^{12} $. Thus $ \G_{24} $ has dimension $ 12 $.
\end{proof}

\pagebreak

\subsubsection{Basis}

$$ \br{a + x}\br{b + x}\br{a + b + x} = a0^8a + 0^8bb + xxx. $$
These are in $ \G_{24} $. If $ a_i, b_i, c_i $ for $ 1 \le i \le 4 $ are bases of $ H' $ and $ K' $ then a basis of $ \G_{24} $ is
$$ a_i0^8a_i, \qquad 0^8b_ib_i, \qquad x_ix_ix_i, \qquad 1 \le i \le 4. $$
Thus
$$ H' = \sp \br{a_1, a_2, a_3, a_4} = \sp \br{b_1, b_2, b_3, b_4}, \qquad K' = \sp \br{x_1, x_2, x_3, x_4}. $$

\subsubsection{Minimum distance}

\begin{theorem}
\label{thm:1.15}
$ \G_{24} $ has minimum distance $ \d\br{\G_{24}} = 8 $.
\end{theorem}

This will take a few steps to prove. For $ v, w \in \ZZ_2^n $, define $ \sbr{v, w} $ as the number of places where $ v $ and $ w $ both have one.

\begin{proposition}
\label{prop:1.16}
Let $ v, w \in \ZZ_2^n $.
\begin{enumerate}
\item $ \wt \br{v + w} = \wt v + \wt w - 2\sbr{v, w} $.
\item Suppose $ 4 \mid \wt v $ and $ 4 \mid \wt w $. Then $ 4 \mid \wt \br{v + w} $ if and only if $ \sbr{v, w} $ is even.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Let $ r = \wt v, s = \wt w, t = \sbr{v, w} $. Reordering the coordinates, we get
$$
\begin{array}{rcccc}
v = & \overbrace{1 \dots 1}^t & \overbrace{1 \dots 1}^{r - t} & \overbrace{0 \dots 0}^{s - t} & 0 \dots 0 \\
w = & 1 \dots 1 & 0 \dots 0 & 1 \dots 1 & 0 \dots 0 \\
v + w = & 0 \dots 0 & 1 \dots 1 & 1 \dots 1 & 0 \dots 0
\end{array}.
$$
Thus $ \wt \br{v + w} = r + s - 2t $.
\item Follows from $ 1 $.
\end{enumerate}
\end{proof}

\lecture{7}{Tuesday}{23/10/18}

\begin{proposition}
\label{prop:1.17}
If $ a, b, x \in \ZZ_2^n $, then $ \sbr{a, x} + \sbr{b, x} + \sbr{a + b, x} $ is even.
\end{proposition}

\begin{proof}
Let $ r = \sbr{a, x} $ and $ s = \sbr{b, x} $. Reordering coordinates,
$$
\begin{array}{rccccc}
x = & \overbrace{1 \dots 1}^u & \overbrace{1 \dots 1}^{s - u} & \overbrace{1 \dots 1}^{r - u} & 1 \dots 1 & 0 \dots 0 \\
a = & 1 \dots 1 & 1 \dots 1 & 0 \dots 0 & 0 \dots 0 & \dots \\
b = & 1 \dots 1 & 0 \dots 0 & 1 \dots 1 & 0 \dots 0 & \dots \\
a + b = & 0 \dots 0 & 1 \dots 1 & 1 \dots 1 & 0 \dots 0 & \dots
\end{array}.
$$
Then $ \sbr{a, x} + \sbr{b, x} + \sbr{a + b, x} = r + s + r - u + s - u = 2\br{r + s - u} $.
\end{proof}

\begin{proposition}
\label{prop:1.18}
If $ c \in \G_{24} $ then $ 4 \mid \wt c $.
\end{proposition}

\begin{proof}
Let
$$ c = \br{a + x}\br{b + x}\br{a + b + x} = ab\br{a + b} + xxx = v + w, \qquad a, b \in H', \qquad x \in K'. $$
Then $ a, b, a + b \in H' $ and $ x \in K' $, so $ 4 \mid \wt v $ and $ 4 \mid \wt w $, and $ \sbr{v, w} = \sbr{a, x} + \sbr{b, x} + \sbr{a + b, x} $ is even by \ref{prop:1.17}. So $ 4 \mid \wt \br{v + w} = \wt c $ by \ref{prop:1.16}.
\end{proof}

\pagebreak

\begin{proof}[Proof of \ref{thm:1.15}]
Suppose $ \d\br{\G_{24}} < 8 $. By \ref{prop:1.18}, there exists $ 0 \ne c \in \G_{24} $ such that $ \wt c = 4 $, so
$$ c = \br{a + x}\br{b + x}\br{a + b + x}, \qquad a, b \in H', \qquad x \in K'. $$
By \ref{prop:1.16}, $ \wt \br{a + x} = \wt a + \wt x - 2\sbr{a, x} $, so $ \wt \br{a + x} $ is even. Similarly, $ \wt \br{b + x} $ and $ \wt \br{a + b + x} $ are even. One of $ a + x, b + x, a + b + x $ must be zero since $ \wt c = 4 $. That is, $ x = a, b, a + b $, so $ x \in H' \cap K' = \cbr{0^8, 1^8} $, by \ref{prop:1.13}. Now $ a + x, b + x, a + b + x \in H' $, so have weight zero, four, or eight. As $ \wt c = 4 $, two of $ a + x, b + x, a + b + x $ are zero. That is, $ x $ is two of $ a, b, a + b $, and the other is then zero. The following are the possibilities.
\begin{itemize}
\item $ a = b = x $ and $ a + b = 0 $, so $ c = 0^80^8x $.
\item $ a = a + b = x $ and $ b = 0 $, so $ c = 0^8x0^8 $.
\item $ b = a + b = x $ and $ a = 0 $, so $ c = x0^80^8 $.
\end{itemize}
So $ \wt c = 0 $ or $ \wt c = 8 $, a contradiction. Thus $ \d\br{\G_{24}} \ge 8 $. As there exists $ c \in \G_{24} $ of weight eight, $ \d\br{\G_{24}} = 8 $.
\end{proof}

\begin{theorem}
The extended Golay code $ \G_{24} $ has length $ 24 $, dimension $ 12 $, and minimum distance eight.
\end{theorem}

\subsubsection{Construction of \texorpdfstring{$ \G_{23} $}{G23}}

\begin{definition*}
The \textbf{Golay code} $ \G_{23} \subseteq \ZZ_2^{23} $ is the codewords of $ \G_{24} $ with the last bit removed.
\end{definition*}

As $ \G_{24} $ is a linear code, so is $ \G_{23} $. Also, $ \abs{\G_{23}} = \abs{\G_{24}} = 2^{12} $ so $ \dim \G_{23} = 12 $.

\begin{theorem}
$ \G_{23} $ is $ 3 $-perfect.
\end{theorem}

\begin{proof}
\hfill
\begin{itemize}
\item $ 3 $-error correcting, that is want $ \d\br{\G_{23}} \ge 7 $. Since $ \G_{23} $ has the codeword $ 0^80^81^7 $ for $ a = b = x = 1^8 $, $ \d\br{\G_{23}} \le 7 $. Since $ \d\br{\G_{24}} = 8 $, $ \d\br{\G_{23}} \ge 7 $. Thus $ \d\br{\G_{23}} = 7 $ and $ 3 $-error correcting.
\item Then
$$ \abs{\G_{23}} = 2^{12} = \dfrac{2^{23}}{\binom{23}{0} + \binom{23}{1} + \binom{23}{2} + \binom{23}{3}}. $$
Thus $ \G_{23} $ is $ 3 $-perfect.
\end{itemize}
\end{proof}

\begin{proposition}
\hfill
\begin{enumerate}
\item Codewords in $ \G_{24} $ have weights $ 0, 8, 12, 16, 24 $. If $ N_i $ is the number of codewords of weight $ i $, then $ N_i = N_{24 - i} $.
\item Codewords in $ \G_{23} $ have weights $ 0, 7, 8, 11, 12, 15, 16, 23 $. If $ M_i $ is the number of codewords of weight $ i $, then $ M_i = M_{23 - i} $.
\item Codewords in $ \G_{24} $ are those of $ \G_{23} $ with a parity check bit $ x_{24} = x_1 + \dots + x_{23} $ added.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item By \ref{prop:1.18}, $ 4 \mid \wt c $ for all $ c \in \G_{24} $, and $ \wt c \ge 8 $ by \ref{thm:1.15}. Also, $ 1^{24} \in \G_{24} $, so there is a bijection $ x \mapsto x + 1^{24} $, from the codewords of weight $ i $, to the codewords of weight $ 24 - i $, so $ N_i = N_{24 - i} $, so there are codewords of weights $ 0, 24, 8, 16 $. Last time in example we saw codeword of weight $ 12 $. No codewords of weight $ 20 $ since no codewords of weight $ 4 $.
\item There are codewords of weights $ 0 $ and $ 23 $. Since $ \G_{24} $ has $ 0^81^80^8 $, there are codewords of weights $ 8 $ and $ 15 $ in $ \G_{23} $. Since $ \G_{24} $ has $ 0^80^81^8 $, there are codewords of weights $ 7 $ and $ 16 $ in $ \G_{23} $. Since $ \G_{24} $ has codewords of weight $ 12 $, there are codewords of weights $ 11 $ and $ 12 $.
\item This follows from the fact that all weights in $ \G_{24} $ are even.
\end{enumerate}
\end{proof}

\pagebreak

\subsubsection{The \texorpdfstring{$ 5 $}{5}-design associated with \texorpdfstring{$ \G_{24} $}{G24}}

How do we calculate $ N_i $ and $ M_i $? The best way is via the following. Recall that a $ t $-design with parameters $ \br{v, k, r_t} $, or a $ t $-$ \br{v, k, r_t} $ design, is a pair $ \br{X, \BBB} $ where $ X $ is a set of $ v $ points and $ \BBB $ is a collection of subsets of $ X $ of size $ k $ called blocks such that every set of $ t $ points lies in exactly $ r_t $ blocks. To avoid degeneracy cases, assume $ X, \BBB \ne \emptyset $ and $ v \ge k \ge t $, so $ r_t > 0 $. Use the codewords of weight eight in $ \G_{24} $ to define a $ t $-design for $ t = 5 $. Let $ X = \cbr{1, \dots, 24} $. Let
$$ \B_c = \cbr{i \in X \st c\br{i} = 1}, \qquad c \in \G_{24}, \qquad \wt c = 8, \qquad \BBB = \cbr{\B_c \st c \in C, \ \wt c = 8}, $$
so $ N_8 = \abs{\BBB} $. These blocks are called \textbf{octads}.

\begin{example*}
Let $ c = 1^80^80^8 $. Then $ \B_c = \cbr{1, \dots, 8} $.
\end{example*}

\lecture{8}{Tuesday}{23/10/18}

\begin{theorem}
$ \br{X, \BBB} $ is a $ 5 $-$ \br{24, 8, 1} $ design.
\end{theorem}

\begin{proof}
Prove $ r_t = 1 $. There is a bijection
$$ \correspondence{\text{vectors} \ v \ \text{in} \ \ZZ_2^n}{\text{subsets} \ S_v = \cbr{i \in X \st v\br{i} = 1} \ \text{of} \ X = \cbr{1, \dots, n}}. $$
Let $ v \in \ZZ_2^{24} $ such that $ \wt v = 5 $, that is $ \abs{S_v} = 5 $. The aim is to show there exists a unique $ c \in \G_{24} $ of weight eight such that $ S_v \subseteq S_c = \B_c $. Delete the last bit of $ v $ to get $ v' \in \ZZ_2^{23} $. Then $ \wt v' = 4 $ or $ \wt v' = 5 $. As $ \G_{23} $ is $ 3 $-perfect, there exists a unique $ c' \in \G_{23} $ such that $ \d\br{v', c'} \le 3 $.
\begin{itemize}
\item If $ \wt v' = 4 $, then $ \wt c' = 7 $ and $ S_{v'} \subseteq S_{c'} $, so $ v = v'1 $ and $ c = c'1 \in \G_{24} $. Thus $ S_v \subseteq S_c $.
\item If $ \wt v' = 5 $, then $ \wt c' = 7 $ or $ \wt c' = 8 $ and $ S_{v'} \subseteq S_{c'} $, so $ v = v'0 $ and either $ c = c'0 \in \G_{24} $ if $ \wt c' = 8 $, or $ c = c'1 \in \G_{24} $ if $ \wt c' = 7 $. Then $ S_v \subseteq S_c $.
\end{itemize}
Suppose there exists $ c_0 $ such that $ \wt c_0 = 8 $ and $ S_v \subseteq S_{c_0} $. Well, $ \sbr{c, c_0} \ge 5 $, since $ S_v \subseteq S_c \cap S_{c_0} $. So
$$ \wt \br{c + c_0} = \wt c + \wt c_0 - 2\sbr{c, c_0} \le 8 + 8 - 10 = 6. $$
But $ c + c_0 \in \G_{24} $ and $ \d\br{\G_{24}} = 8 $. Thus $ c = c_0 $.
\end{proof}

Using this design, we can obtain lots of information about $ \G_{23} $ and $ \G_{24} $, such as $ N_i $ and $ M_i $. We need some design theory.

\begin{proposition}
Let $ \br{X, \BBB} $ be a $ t $-$ \br{v, k, r_t} $ design. Then $ \br{X, \BBB} $ is also a $ \br{t - 1} $-$ \br{v, k, r_{t - 1}} $ design, where
$$ r_{t - 1} = \dfrac{v - t + 1}{k - t + 1}r_t. $$
\end{proposition}

\begin{proof}
Let $ S \subseteq X $ with $ \abs{S} = t - 1 $. Let $ r\br{S} $ be the number of blocks containing $ S $. Let $ N $ be the number of pairs $ \br{x, B} $ where $ x \in X \setminus S $ and $ B $ is a block such that $ S \cup \cbr{x} \subseteq B $. Then
$$ N = \br{\text{the number of points in} \ X \setminus S} \times \br{\text{the number of blocks} \ B \ \text{containing} \ S \cup \cbr{x}} = \br{v - t + 1}r_t, $$
and
$$ N = \br{\text{the number of} \ B \ \text{containing} \ S} \times \br{\text{the number of} \ x \ \text{in} \ B \setminus S} = r\br{S}\br{k - t + 1}. $$
Thus
$$ r\br{S} = \dfrac{v - t + 1}{k - t + 1}r_t. $$
\end{proof}

\begin{corollary}
\label{cor:1.24}
A $ t $-$ \br{v, k, r_t} $ design is an $ s $-$ \br{v, k, r_s} $ design for all $ 0 \le s \le t - 1 $ where
$$ r_{t - 1} = \dfrac{v - t + 1}{k - t + 1}r_t, \qquad \dots, \qquad r = r_1 = \dfrac{v - 1}{k - 1}r_2, \qquad b = r_0 = \dfrac{v}{k}r_1. $$
\end{corollary}

\pagebreak

Applying this to the $ 5 $-design from $ \G_{24} $,
$$ r_5 = 1, \qquad r_4 = \dfrac{20}{4}\br{1} = 5, \qquad r_3 = \dfrac{21}{5}\br{5} = 21, \qquad r_2 = \dfrac{22}{6}\br{21} = 77, $$
$$ r = r_1 = \dfrac{23}{7}\br{77} = 253, \qquad b = r_0 = \dfrac{24}{8}\br{253} = 759. $$

\begin{proposition}
\hfill
\begin{enumerate}
\item In $ \G_{24} $, the number of codewords of weight eight is $ N_8 = 759 $.
\item In $ \G_{23} $, the number of codewords of weights seven and eight are $ M_7 = 253 $ and $ M_8 = 506 $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item $ N_8 $ is the number of octads, which is $ b = 759 $.
\item $ c' \in \G_{23} $ has weight seven if and only if $ c' + e_{24} \in \G_{24} $ has weight eight. So $ M_7 $ is the number of octads containing one, which is $ r_1 = 253 $, and $ M_8 = N_8 - M_7 = 759 - 253 = 506 $.
\end{enumerate}
\end{proof}

The other values $ N_{12}, M_{11}, M_{12} $ are in sheet $ 2 $. \footnote{Exercise}

\subsubsection{Check matrix}

Observe that the dot product on $ \ZZ_2^n $ is $ x \cdot y = xy^\intercal \in \ZZ_2 $.

\begin{proposition}
\label{prop:1.26}
For all $ c, d \in \G_{24} $, $ c \cdot d = 0 $.
\end{proposition}

\begin{proof}
$ \wt \br{c + d} = \wt c + \wt d - 2\sbr{c, d} $. As $ 4 \mid \wt c, \wt d, \wt \br{c + d} $, $ \sbr{c, d} $ is even. Hence $ c \cdot d = cd^\intercal = \sbr{c, d} = 0 $.
\end{proof}

Let $ b_1, \dots, b_{12} $ be a basis of $ \G_{24} $. Take
$$ A = \threebyone{b_1}{\vdots}{b_{12}}, $$
a $ 12 \times 24 $ matrix, since for all $ c \in \G_{24} $, by \ref{prop:1.26}, $ Ac^\intercal = 0 $.

\subsubsection{Error correction}

Suppose a codeword $ c $ is sent and $ t $ errors are made, where $ 1 \le t \le 3 $. So the received vector is
$$ x = c + e_{i_1} + \dots + e_{i_t} \in \ZZ_2^{24}. $$
To see if $ x_1 $ is correct, there are $ 253 $ codewords in $ \G_{24} $ of weight eight with one in the first coordinate. Call them $ c_1, \dots, c_{253} $. Let the corresponding octads be $ \B_1, \dots, \B_{253} $. That is, those containing one. Consider the dot products $ x \cdot c_i $ for $ 1 \le i \le 253 $. If $ x $ were in $ \G_{24} $, then $ x \cdot c_i = 0 $ for all $ i $. But $ x \notin \G_{24} $. We count how many of these are one.

\begin{proposition}
The number of dot products $ x \cdot c_i $ equal to one is
$$
\begin{array}{c|cc}
t & x_1 \ \text{correct} & x_1 \ \text{incorrect} \\
\hline
1 & 77 & 253 \\
2 & 112 & 176 \\
3 & 125 & 141
\end{array}.
$$
\end{proposition}

\lecture{9}{Wednesday}{24/10/18}

Hence the number tells whether $ x_1 $ is correct.

\pagebreak

\begin{proof}
Let $ L $ be the number of $ x \cdot c $ that equal one.
\begin{itemize}[leftmargin=0.5in]
\item[$ t = 1 $.] Here $ x = c + e_k $. If $ x_1 $ is correct, then $ 1 \ne k $, so
$$ x \cdot c_i = e_k \cdot c_i =
\begin{cases}
1 & k \in \B_i \\
0 & k \notin \B_i \\
\end{cases}.
$$
Thus $ L $ is the number of $ i $ such that $ k \in \B_i $, which is $ r_2 = 77 $, the number of octads containing $ 1 $ and $ k $. If $ x_1 $ is incorrect, then $ k = 1 $, so $ x \cdot c_i = e_1 \cdot c_i = 1 $. Thus $ L = r_1 = 253 $.
\item[$ t = 2 $.] Let $ x = c + e_k + e_l $. If $ x_1 $ is correct, then
$$ x \cdot c_i = e_k \cdot c_i = e_l \cdot c_i =
\begin{cases}
1 & k \in \B_i \ \text{and} \ l \notin \B_i, \ \text{or} \ k \notin \B_i \ \text{and} \ l \in \B_i \\
0 & \text{else}
\end{cases},
$$
so the number of $ i $ such that $ k \in \B_i $ and $ l \notin \B_i $ is $ r_2 - r_3 = 77 - 21 = 56 $. Thus $ L = 56 + 56 = 112 $. If $ x_1 $ is incorrect, then $ x = c + e_1 + e_k $, so
$$ x \cdot c_i = e_1c_i + e_kc_i = 1 +
\begin{cases}
1 & k \in \B_i \\
0 & k \notin \B_i \\
\end{cases}
=
\begin{cases}
0 & k \in \B_i \\
1 & k \notin \B_i \\
\end{cases}.
$$
Thus $ L $ is the number of $ \B_i $ not containing $ k $, which is $ r_1 - r_2 = 253 - 77 = 176 $.
\item[$ t = 3 $.] Sheet $ 2 $. \footnote{Exercise}
\end{itemize}
\end{proof}

\subsection{Cyclic codes}

\subsubsection{Some ring theory}

Recall that a \textbf{commutative ring} $ R $ has $ + $ and $ \times $ such that
\begin{itemize}
\item $ \br{R, +} $ is an abelian group,
\item $ \times $ is commutative and associative, and
\item $ \times $ is distributive over $ + $.
\end{itemize}

\begin{example*}
The \textbf{polynomial ring} $ \ZZ_2\sbr{x} $ is the ring of polynomials
$$ f\br{x} = a_0 + \dots + a_nx^n, \qquad a_i \in \ZZ_2. $$
\end{example*}

A subset $ I \subseteq R $ is an \textbf{ideal} if $ I $ is a subgroup of $ \br{R, +} $ and $ IR \subseteq I $, that is $ ir \in I $ for all $ i \in I $ and $ r \in R $.

\begin{example*}
For $ a \in R $,
$$ I = \abr{a} = \cbr{ar \st r \in R} $$
is a \textbf{principal ideal}. In $ \ZZ_2\sbr{x} $, if $ a = x^n - 1 $ then
$$ \abr{a} = \cbr{\br{x^n - 1}f\br{x} \st f\br{x} \in \ZZ_2\sbr{x}}. $$
\end{example*}

The \textbf{coset} of $ I $ in $ \br{R, +} $ is
$$ r + I = \cbr{r + i \st i \in I}, $$
and $ r + I = s + I $ if and only if $ r - s \in I $. Define the \textbf{quotient ring}
$$ R / I = \cbr{\text{cosets} \ r + I \st r \in R}, $$
where addition and multiplication are
$$ \br{r_1 + I} + \br{r_2 + I} = \br{r_1 + r_2} + I, \qquad \br{r_1 + I} + \br{r_2 + I} = \br{r_1r_2} + I. $$
These are well-defined, and $ R / I $ is a ring. Our main example is the ring
$$ \ZZ_2\sbr{x} / \abr{x^n - 1}, \qquad n \in \NN. $$

\pagebreak

\begin{example*}
Let $ R = \ZZ_2\sbr{x} $ and $ I = \abr{x^2 - 1} $. Then
$$ R / I = \cbr{0 + I, 1 + I, x + I, x + 1 + I}, $$
so $ x^2 + I = x^2 + \br{1 + x^2} + I = 1 + I $ and $ x^3 + I = x\br{x^2} + I = x + I $. Writing $ \overline{x} = x + I $,
$$ R / I = \cbr{0, 1, \overline{x}, \overline{x} + 1}, $$
so $ \overline{x}\br{\overline{x} + 1} = \overline{x}^2 + \overline{x} = 1 + \overline{x} $, since $ \overline{x}^2 = 1 $.
\end{example*}

\begin{example*}
Let $ R = \ZZ_2\sbr{x} $ and $ I = \abr{x^3 - 1} $. Then $ \overline{x}\br{1 + \overline{x}^2} = \overline{x} + 1 $.
\end{example*}

In general is the following.

\begin{proposition}
$$ \ZZ_2\sbr{x} / \abr{x^n - 1} = \cbr{a_0 + \dots + a_{n - 1}\overline{x}^{n - 1} \st a_i \in \ZZ_2}, \qquad \overline{x} = x + \abr{x^n - 1}, $$
where multiplication is determined by $ \overline{x}^n = 1 $.
\end{proposition}

Hence there exists a bijection
$$ \function[\pi]{\ZZ_2^n}{\ZZ_2\sbr{x} / \abr{x^n - 1}}{\br{a_0, \dots, a_{n - 1}}}{a_0 + \dots + a_{n - 1}\overline{x}^{n - 1}}. $$
This is an isomorphism of groups.

\subsubsection{Cyclic codes}

\begin{definition*}
A linear code $ C \subseteq \ZZ_2^n $ is \textbf{cyclic} if $ \br{x_1, \dots, x_n} \in C $ implies that $ \br{x_n, x_1, \dots, x_{n - 1}} \in C $, which implies all further shifts $ \br{x_{n - 1}, x_n, x_1, \dots, x_{n - 2}} \in C $, etc.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item $ C = \cbr{000, 110, 101, 011} $ is cyclic.
\item $ \Ham 3 $ is cyclic with check matrix
$$ \threebyone{1 & 0 & 1 & 1 & 1 & 0 & 0}{1 & 1 & 1 & 0 & 0 & 1 & 0}{0 & 1 & 1 & 1 & 0 & 0 & 1}, $$
since the shifted matrix
$$ \threebyone{0 & 1 & 0 & 1 & 1 & 1 & 0}{0 & 1 & 1 & 1 & 0 & 0 & 1}{1 & 0 & 1 & 1 & 1 & 0 & 0} $$
gives the same code.
\item $ \G_{23} $ is equivalent to a cyclic code. Have to permute the coordinates.
\end{itemize}
\end{example*}

\begin{example*}
Let $ C = \cbr{000, 110, 101, 011} $. Then
$$ \pi\br{C} = \cbr{0, 1 + \overline{x}, 1 + \overline{x}^2, \overline{x} + \overline{x}^2} \subseteq \ZZ_2\sbr{x} / \abr{x^3 - 1}. $$
\end{example*}

\begin{proposition}
\label{prop:1.29}
$ C \subseteq \ZZ_2^n $ is a cyclic linear code if and only if $ \pi\br{C} $ is an ideal of $ \ZZ_2\sbr{x} / \abr{x^n - 1} $.
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item[$ \impliedby $] Suppose $ I = \pi\br{C} $ is an ideal. Then $ C $ is linear, since $ c, d \in C $ implies that $ \pi\br{c}, \pi\br{d} \in I $, so $ \pi\br{c} + \pi\br{d} = \pi\br{c + d} \in I $, so $ c + d \in C $. Then $ C $ is cyclic, since letting $ c = \br{c_0, \dots, c_{n - 1}} \in C $ implies that $ \pi\br{c} = c_0 + \dots + c_{n - 1}\overline{x}^{n - 1} $, so
$$ \overline{x}\pi\br{c} = c_0\overline{x} + \dots + c_{n - 1}\overline{x}^n = c_{n - 1} + c_0\overline{x} + \dots + c_{n - 2}\overline{x}^{n - 1} = \pi\br{\br{c_{n - 1}, c_0, \dots, c_{n - 2}}}, $$
so $ \br{c_{n - 1}, c_0, \dots, c_{n - 2}} \in C $. So $ C $ is a cyclic linear code.
\item[$ \implies $] Sheet $ 2 $. \footnote{Exercise}
\end{itemize}
\end{proof}

\pagebreak

\lecture{10}{Tuesday}{30/10/18}

\begin{fact*}
$ \ZZ_2\sbr{x} $ has a division algorithm. Given $ f\br{x}, g\br{x} \in \ZZ_2\sbr{x} $ such that $ g \ne 0 $, there exist $ q\br{x}, r\br{x} \in \ZZ_2\sbr{x} $ such that
$$ f\br{x} = q\br{x}g\br{x} + r\br{x}, \qquad \deg r < \deg g. $$
\end{fact*}

\begin{definition*}
A polynomial $ p\br{x} \in \ZZ_2\sbr{x} $ is \textbf{irreducible} if it cannot be factorised as a product of polynomials of smaller degree.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item $ x^2 + 1 = \br{x + 1}^2 $ is not irreducible.
\item $ x^2 + x + 1 $ is irreducible.
\item $ x^4 + x^2 + 1 = \br{x^2 + x + 1}^2 $ is not irreducible, since $ \br{a + b}^2 = a^2 + b^2 $ for $ a, b \in \ZZ_2\sbr{x} $.
\item $ x^4 + x + 1 $ is irreducible.
\end{itemize}
\end{example*}

\begin{fact*}
Every polynomial in $ \ZZ_2\sbr{x} $ is a unique product of irreducible polynomials, so can define \textbf{highest common factor} and \textbf{lowest common multiple} of polynomials in $ \ZZ_2\sbr{x} $.
\end{fact*}

\subsubsection{Construction}

Fix $ n \in \NN $. Let $ p\br{x} \in \ZZ_2\sbr{x} $ such that $ p\br{x} $ divides $ x^n - 1 $. Have an ideal
$$ \abr{p\br{\overline{x}}} = \cbr{p\br{\overline{x}}f\br{\overline{x}} \st f\br{\overline{x}} \in \ZZ_2\sbr{x} / \abr{x^n - 1}} \subseteq \ZZ_2\sbr{x} / \abr{x^n - 1}, \qquad \overline{x} = x + \abr{x^n - 1}. $$

\begin{fact*}
Every ideal in $ \ZZ_2\sbr{x} / \abr{x^n - 1} $ arises in this way for some $ \phi\br{x} $ dividing $ x^n - 1 $.
\end{fact*}

By \ref{prop:1.29}, $ \pi^{-1}\br{\abr{p\br{\overline{x}}}} $ is a cyclic linear code.

\begin{example*}
\hfill
\begin{itemize}
\item Let $ n = 3 $. Then
$$ x^3 - 1 = \br{x + 1}\br{x^2 + x + 1}. $$
Take $ p\br{x} = x + 1 $, so
$$ \abr{p\br{\overline{x}}} = \cbr{0, 1 + \overline{x}, 1 + \overline{x}^2, \overline{x} + \overline{x}^2}. $$
This gives the cyclic code
$$ C = \cbr{000, 110, 011, 101}. $$
\item Let $ n = 6 $. Then
$$ x^6 - 1 = \br{x + 1}^2\br{x^2 + x + 1}^2. $$
So $ x^6 - 1 $ has nine possible divisors, so nine possible cyclic linear codes. Take
$$ p\br{\overline{x}} = \br{\overline{x}^2 + \overline{x} + 1}^2 = \overline{x}^4 + \overline{x}^2 + 1, $$
so
$$ C = \cbr{000000, 101010, 010101, 111111}. $$
\end{itemize}
\end{example*}

\begin{definition*}
Call $ p\br{x} $ a \textbf{generator polynomial} for the corresponding cyclic linear code.
\end{definition*}

\begin{proposition}
If the generator polynomial has degree $ n - k $, then $ \dim C = k $.
\end{proposition}

\begin{proof}
True if $ k = 0 $, that is $ p\br{x} = x^n - 1 $, so $ C = \cbr{0} $. Assume $ k \ge 1 $. Claim that
$$ p\br{\overline{x}}, \dots, \overline{x}^{k - 1}p\br{\overline{x}} $$
is a basis for $ \pi\br{C} $.

\pagebreak

\begin{itemize}
\item Linear independence.
$$ \sum_{i = 0}^{k - 1} \lambda_ix^ip\br{x}, \qquad \lambda_i \in \ZZ_2, $$
has degree less than $ n $, so is not in $ \abr{x^n - 1} $ unless all $ \lambda_i = 0 $. Thus
$$ \sum_{i = 0}^{k - 1} \lambda_i\overline{x}^ip\br{\overline{x}} = 0 \in \ZZ_2\sbr{x} / \abr{x^n - 1} $$
implies that $ \lambda_i = 0 $.
\item Span. The span of the given set is
$$ \cbr{g\br{\overline{x}}p\br{\overline{x}} \st g\br{\overline{x}} \in \ZZ_2\sbr{x} / \abr{x^n - 1} \ \text{of degree less than} \ k}. $$
Need to show this is equal to
$$ \cbr{f\br{\overline{x}}p\br{\overline{x}} \st f\br{\overline{x}} \in \ZZ_2\sbr{x} / \abr{x^n - 1}}. $$
For $ f\br{x} \in \ZZ_2\sbr{x} $, there exists $ q\br{x}, r\br{x} $ such that
$$ f\br{x}p\br{x} = q\br{x}\br{x^n - 1} + r\br{x}, \qquad \deg r < n. $$
Then $ p\br{x} $ divides $ r\br{x} $, so $ r\br{x} = p\br{x}g\br{x} $ for some $ g $, so $ \deg g + n - k < n $, so $ \deg g < k $. So $ g\br{\overline{x}}p\br{\overline{x}} = f\br{\overline{x}}p\br{\overline{x}} $.
\end{itemize}
\end{proof}

\begin{example*}
Let $ n = 7 $. Then
$$ x^7 - 1 = \br{x + 1}\br{x^3 + x + 1}\br{x^3 + x^2 + 1}. $$
Let $ p\br{x} = x^3 + x + 1 $. Then $ \dim C = 4 $ and a basis is
$$ 1101000, \qquad 0110100, \qquad 0011010, \qquad 0001101. $$
\end{example*}

\subsubsection{Check matrix}

Let $ p\br{x} $ divide $ x^n - 1 $, the generator polynomial for the cyclic linear code $ C $. Assume $ p\br{x} \ne x^n - 1 $. Then
$$ x^n - 1 = p\br{x}q\br{x}, \qquad p\br{x} = p_0 + \dots + p_{n - k}x^{n - k}, \qquad q\br{x} = q_0 + \dots + q_kx^k, \qquad p_i, q_i \in \ZZ_2. $$
Basis of $ C $ is the rows of the $ k \times n $ matrix
$$ G =
\begin{pmatrix}
p_0 & \dots & p_{n - k} & & 0 \\
& \ddots & \ddots & \ddots & \\
0 & & p_0 & \dots & p_{n - k}
\end{pmatrix}.
$$
This is the \textbf{generator matrix} of $ C $. Define an $ \br{n - k} \times n $ matrix
$$ H =
\begin{pmatrix}
0 & & q_k & \dots & q_0 \\
& \reflectbox{$ \ddots $} & \reflectbox{$ \ddots $} & \reflectbox{$ \ddots $} & \\
q_k & \dots & q_0 & & 0
\end{pmatrix}.
$$

\begin{proposition}
$ HG^\intercal = 0 $. That is, $ H $ is the check matrix for $ C $.
\end{proposition}

\begin{proof}
Sheet $ 2 $. \footnote{Exercise}
\end{proof}

\begin{example*}
Let $ n = 7 $, and $ p\br{x} = x^3 + x + 1 $ and $ q\br{x} = \br{x + 1}\br{x^3 + x^2 + 1} $. The check matrix is
$$ H =
\begin{pmatrix}
0 & 0 & 1 & 0 & 1 & 1 & 1 \\
0 & 1 & 0 & 1 & 1 & 1 & 0 \\
1 & 0 & 1 & 1 & 1 & 0 & 0
\end{pmatrix}
= \Ham 3. $$
\end{example*}

\lecture{11}{Tuesday}{30/10/18}

Lecture 11 is a class test.

\pagebreak

\subsection{BCH codes}

\lecture{12}{Wednesday}{31/10/18}

This is a family of codes where we have good control of length, dimension, minimum distance, and error correction process.

\subsubsection{Some more ring theory}

\begin{fact*}
For every $ k \in \ZZ_{\ge 1} $, there exists a finite field of order $ 2^k $. The construction is
$$ \FF_{2^k} = \ZZ_2\sbr{x} / \abr{p_k\br{x}}, $$
where $ p_k\br{x} $ is irreducible of degree $ k $.
\end{fact*}

\begin{example*}
Let $ \FF_4 = \ZZ_2\sbr{x} / \abr{x^2 + x + 1} $. Write $ \alpha = x + \abr{x^2 + x + 1} $. The elements of $ \FF_4 $ are
$$ \cbr{0, 1, \alpha, \alpha + 1}. $$
\end{example*}

\begin{example*}
Let $ \FF_8 = \ZZ_2\sbr{x} / \abr{x^3 + x + 1} $. Write $ \alpha = x + \abr{x^3 + x + 1} $. The elements of $ \FF_8 $ are
$$ \cbr{0, 1, \alpha, \alpha + 1, \alpha^2, \alpha^2 + 1, \alpha^2 + \alpha, \alpha^2 + \alpha + 1}. $$
\end{example*}

\begin{fact*}
The multiplicative group $ \br{\FF_{2^k}^*, \times} $ is cyclic. That is, there exists $ \beta \in \FF_{2^k} $ such that $ \FF_{2^k}^* = \abr{\beta} $ and the order of $ \beta $ is $ 2^k - 1 $. Call such a $ \beta $ a \textbf{primitive element}.
\end{fact*}

\begin{example*}
\hfill
\begin{itemize}
\item $ \FF_4^* = \abr{\alpha} $, since $ \alpha^2 = \alpha + 1 $.
\item $ \FF_8^* = \abr{\alpha} $.
\item $ \FF_{16} = \ZZ_2\sbr{x} / \abr{x^4 + x + 1} $. Let $ \alpha = x + \abr{x^4 + x + 1} $.
\begin{itemize}
\item $ \alpha $ is a primitive element, since $ \alpha $ has order $ 15 $.
\item $ \alpha^3 $ is not, since $ \alpha^3 $ has order five.
\item $ \alpha^5 = \alpha^2 + \alpha $ is not, since $ \alpha^5 $ has order three.
\end{itemize}
\end{itemize}
\end{example*}

Caution that $ x + \abr{p_k\br{x}} $ is not necessarily a primitive element of $ \ZZ_2\sbr{x} / \abr{p_k\br{x}} $.

\begin{fact*}
Every element $ \gamma \in \FF_{2^k}^* $ has a \textbf{minimal polynomial}, which is a polynomial $ m\br{x} \in \FF_2\sbr{x} $ that is irreducible for which $ m\br{\gamma} = 0 $, and $ m\br{x} $ is unique, $ \deg m = k $, and $ m\br{x} $ divides $ x^{2^k - 1} - 1 $.
\end{fact*}

\begin{example*}
For $ \FF_8 $,
\begin{itemize}
\item the minimal polynomial of $ \alpha $ is $ x^3 + x + 1 $,
\item the minimal polynomial of $ \alpha^2 $ is $ x^3 + x + 1 $, since $ \alpha^6 + \alpha^2 + 1 = \br{\alpha^3 + \alpha + 1}^2 = 0 $, and
\item the minimal polynomial of $ \alpha^3 $ is $ x^3 + x^2 + 1 $, since $ \br{1 + \alpha}^3 = \alpha^3 + \alpha^2 + \alpha + 1 = \alpha^2 = \br{1 + \alpha}^2 + 1 $.
\end{itemize}
\end{example*}

\begin{note*}
In general, if $ \gamma \in \FF_{2^k}^* $, then $ \gamma $ and $ \gamma $ have the same minimal polynomial, since $ m\br{\gamma^2} = m\br{\gamma}^2 = 0 $.
\end{note*}

\subsubsection{Definition of BCH codes}

Let $ k, d \in \ZZ_{\ge 2} $. Let $ \beta $ be a primitive element of $ \FF_{2^k} $. For each $ i \ge 1 $, let $ m_i\br{x} $ be the minimal polynomial of $ \beta^i $. Let $ p\br{x} $ be the least common multiple of $ m_1\br{x}, \dots, m_{d - 1}\br{x} $. The cyclic code of length $ 2^k - 1 $ with generator polynomial $ p\br{x} $ is called the \textbf{BCH code} of length $ 2^k - 1 $ and \textbf{designed distance} $ d $.

\begin{example*}
Let $ \FF_8 $ with primitive element $ \alpha $ as above.
\begin{itemize}[leftmargin=0.5in]
\item[$ d = 3 $.] $ m_1\br{x} $ is the minimal polynomial of $ \alpha $, which is $ x^3 + x + 1 $, and $ m_2\br{x} $ is the minimal polynomial of $ \alpha^2 $, which is $ x^3 + x + 1 $. So $ p\br{x} = x^3 + x + 1 $ and the BCH code is $ \Ham 3 $.
\item[$ d = 4 $.] $ m_3\br{x} $ is the minimal polynomial of $ \alpha^3 $, which is $ x^3 + x^2 + 1 $. So
$$ p\br{x} = \br{x^3 + x + 1}\br{x^3 + x^2 + 1} = x^6 + x^5 + x^4 + x^3 + x^2 + x + 1, $$
and the BCH code is $ \cbr{0^7, 1^7} $.
\end{itemize}
\end{example*}

\pagebreak

\begin{theorem}
\label{thm:1.32}
Let $ n = 2^k - 1 $ and let $ C $ be a BCH code of length $ n $ and designed distance $ d $. Then
\begin{enumerate}
\item $ \d\br{C} \ge d $, and
\item letting $ t = \fbr{d / 2} $, that is $ d = 2t $ or $ d = 2t + 1 $, then $ \dim C \ge n - kt $.
\end{enumerate}
\end{theorem}

\begin{example*}
Let $ \FF_{16} $ with $ \alpha $ primitive element as above.
\begin{itemize}[leftmargin=0.5in]
\item[$ d = 3 $.] $ p\br{x} = x^4 + x + 1 $. So the BCH code has length $ 15 $, dimension $ 11 $, and minimum distance at least three. This is $ \Ham 4 $.
\item[$ d = 5 $.] $ m_3\br{x} $ is the minimal polynomial of $ \alpha^3 $, which is $ x^4 + x^3 + x^2 + x + 1 $, so
$$ p\br{x} = \br{x^4 + x + 1}\br{x^4 + x^3 + x^2 + x + 1}. $$
So the BCH code has length $ 15 $, dimension seven, and minimum distance at least five.
\end{itemize}
\end{example*}

\begin{note*}
For code $ C $ of length $ 15 $ correcting two errors, the Hamming bound implies that $ \dim C \le 8 $, and the G-V bound implies that there exists a code of dimension six.
\end{note*}

\begin{proof}[Proof of \ref{thm:1.32}]
\hfill
\begin{enumerate}
\item Omitted.
\item Let $ p\br{x} = \lcm\br{m_1\br{x}, \dots, m_{d - 1}\br{x}} $. Know
\begin{itemize}
\item $ m_i\br{x} = m_{2i}\br{x} $ for all $ i $, since $ \alpha^i $ and $ \alpha^{2i} $ have the same minimal polynomial,
\item $ d - 1 \le 2t $, and
\item $ \deg m_i\br{x} \le k $ for all $ i $.
\end{itemize}
Thus $ p\br{x} $ is the product of at most $ t $ of the $ m_i $, so $ \dim C = n - \deg p \le n - kt $.
\end{enumerate}
\end{proof}

\subsection{Automorphism group of a code}

Recall that the \textbf{symmetric group} $ \SSS_n $ is the group of all permutations, that is bijections, of $ \cbr{1, \dots, n} $. Recall that equivalent codes are those for which the columns have been permuted in some way.

\begin{definition*}
The \textbf{automorphism group} of a code $ C \subseteq \ZZ_2^n $ is
$$ \Aut C = \cbr{\sigma \in \SSS_n \st \forall \br{c_1, \dots, c_n} \in C, \ \br{c_{\sigma\br{1}}, \dots, c_{\sigma\br{n}}} \in C}. $$
\end{definition*}

\begin{remark*}
For a linear code $ C $, $ C $ is cyclic if and only if $ \abr{\br{1 \dots n}} \le \Aut C $.
\end{remark*}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ C = \cbr{0^n, 1^n} $. Then $ \Aut C = \SSS_n $.
\item Let $ C = \cbr{000, 110, 011, 101} $. Then $ \Aut C = \SSS_3 $.
\end{itemize}
\end{example*}

\begin{definition*}
Let $ \M_{23} = \Aut \G_{23} $ and $ \M_{24} = \Aut \G_{24} $. These are called \textbf{Mathieu groups}.
\end{definition*}

These groups are very famous. They are two of the $ 26 $ \textbf{sporadic simple groups}.

\pagebreak

\section{Graphs}

\subsection{Strongly regular graphs}

\subsubsection{Regular graphs}

\lecture{13}{Tuesday}{06/11/18}

\begin{definition*}
A \textbf{graph} $ \Gamma $ is a pair $ \br{V, E} $ where $ V = V\br{\Gamma} $ is a set of \textbf{vertices} and $ E = E\br{\Gamma} $ is a set of $ 2 $-subsets of $ V $ called \textbf{edges}. Assume $ V \ne \emptyset $. Write $ u \sim v $ if and only if $ \cbr{u, v} \in E $. A graph is \textbf{regular of valency $ k $} if every vertex has $ k $ \textbf{neighbours}.
\end{definition*}

\begin{definition*}
The \textbf{complement} $ \overline{\Gamma} $ of a graph $ \Gamma $ is the graph with vertex set $ V $ such that $ u \sim v $ in $ \overline{\Gamma} $ if and only if $ u \nsim v $ in $ \Gamma $.
\end{definition*}

\begin{example*}
$$
\begin{array}{ccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (-0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (0.5, -1);
\end{tikzpicture}
\\
\Gamma & & \overline{\Gamma}
\end{array}
$$
\end{example*}

\begin{definition*}
A \textbf{path} in $ \Gamma $ is a sequence of vertices $ v_0, \dots, v_k $ such that $ v_i \sim v_{i + 1} $ for all $ i $. The path has \textbf{length} $ k $. Then $ \Gamma $ is \textbf{connected} if there is a path between any two vertices. If $ v, w \in V $, the \textbf{distance} $ \d\br{v, w} $ between $ v $ and $ w $ is the length of the shortest path from $ v $ to $ w $. Write $ \d\br{v, w} = \infty $ if no such path. For $ x \in V $, define
$$ \Gamma_i\br{x} = \cbr{v \in V \st \d\br{x, v} = i}, \qquad i \ge 0. $$
Write $ \Gamma\br{x} = \Gamma_1\br{x} $, the set of things \textbf{adjacent} to $ x $.
\end{definition*}

\begin{definition*}
Let $ \Gamma $ be a connected graph. The \textbf{diameter} of $ \Gamma $ is
$$ \diam \Gamma = \max\cbr{\d\br{v, w} \st v, w \in V}. $$
\end{definition*}

\begin{example*}
Let $ \Gamma $ be
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above]{$ f $};
\fill (1, 0) circle (0.1) node[above]{$ a $};
\fill (2, 0) circle (0.1) node[above]{$ b $};
\fill (-0.5, -0.5) circle (0.1) node[left]{$ e $};
\fill (0, -1) circle (0.1) node[below]{$ d $};
\fill (1, -1) circle (0.1) node[below]{$ c $};
\draw (0, 0) to (1, 0);
\draw (1, 0) to (2, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1, -1);
\draw (-0.5, -0.5) to (0, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}.
$$
\begin{itemize}
\item $ \d\br{a, b} = 1 $ and $ \d\br{b, e} = 3 $.
\item $ \Gamma $ is connected.
\item $ \Gamma\br{a} = \Gamma_1\br{a} = \cbr{f, c, b}, \Gamma_2\br{a} = \cbr{d, e}, \Gamma_0\br{a} = \cbr{a} $.
\item $ \diam \Gamma = 3 $.
\end{itemize}
\end{example*}

\begin{example*}
$$
\begin{array}{ccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0, -1);
\draw (1.5, -0.5) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\draw (1, 0) node[above]{Petersen graph};
\fill (0, 0) circle (0.1);
\fill (2, 0) circle (0.1);
\fill (0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (2.5, -1) circle (0.1);
\fill (2, -1) circle (0.1);
\fill (1, -1.5) circle (0.1);
\fill (1, -2) circle (0.1);
\draw (0, 0) to (2, 0);
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -0.5);
\draw (2, 0) to (1.5, -0.5);
\draw (2, 0) to (2.5, -1);
\draw (0.5, -0.5) to (1, -1.5);
\draw (0.5, -0.5) to (2, -1);
\draw (1.5, -0.5) to (0, -1);
\draw (1.5, -0.5) to (1, -1.5);
\draw (-0.5, -1) to (0, -1);
\draw (-0.5, -1) to (1, -2);
\draw (0, -1) to (2, -1);
\draw (2, -1) to (2.5, -1);
\draw (2.5, -1) to (1, -2);
\draw (1, -1.5) to (1, -2);
\end{tikzpicture}
\\
\diam = 3 & & \diam = 2
\end{array}
$$
\end{example*}

\begin{note*}
$ \diam \Gamma \le 1 $ if and only if every pair of distinct vertices is adjacent.
\end{note*}

\begin{example*}
\textbf{Complete graphs} $ \K_n $, where $ n $ is the number of vertices, are
$$
\begin{array}{ccccccccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\draw (0, 0) to (1, 0);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0.5, -1);
\draw (1, 0) to (0.5, -1);
\end{tikzpicture}
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0, -1);
\draw (0, 0) to (1, -1);
\draw (1, 0) to (0, -1);
\draw (1, 0) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
& \qquad & \dots \\
\K_1 & & \K_2 & & \K_3 & & \K_4 & &
\end{array}.
$$
\end{example*}

\pagebreak

\begin{definition*}
Graphs $ \Gamma = \br{V, E} $ and $ \Gamma' = \br{V', E'} $ are \textbf{isomorphic} if there exists a bijection $ \phi : V \to V' $ such that $ u \sim v $ in $ \Gamma $ if and only if $ \phi\br{u} \sim \phi\br{v} $ in $ \Gamma' $. That is,
$$ E' = \phi\br{E} = \cbr{\cbr{\phi\br{u}, \phi\br{v}} \st \cbr{u, v} \in E}. $$
That is, $ \phi $ sends edges to edges and non-edges to non-edges.
\end{definition*}

\begin{example*}
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\end{tikzpicture}
\qquad
\begin{tikzpicture}
\draw (-1.5, -0.5) node{$ \cong $};
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (0.5, -1);
\draw (0, 0) to (1.5, -0.5);
\draw (1, 0) to (-0.5, -0.5);
\draw (1, 0) to (0.5, -1);
\draw (-0.5, -0.5) to (1.5, -0.5);
\end{tikzpicture}
$$
\end{example*}

\begin{proposition}
Let $ \Gamma $ be a connected graph that is regular of valency $ k $ and has diameter $ d \ge 1 $. Then
$$ \abs{V\br{\Gamma}} \le 1 + k + k\br{k - 1} + \dots + k\br{k - 1}^{d - 1} = \N\br{k, d}. $$
\end{proposition}

\begin{proof}
Let $ x \in V\br{\Gamma} $. Then
$$ V\br{\Gamma} = \Gamma_0\br{x} \cup \Gamma_1\br{x} \cup \dots \cup \Gamma_d\br{x}, $$
so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\draw (0, -0.5) node{$ x $};
\draw (2, 0) circle (0.5) node{$ k $};
\draw (2, -1) node{$ \Gamma\br{x} $};
\draw (5, 0) circle (1) node{$ \le k\br{k - 1} $};
\draw (5, -1.5) node{$ \Gamma_2\br{x} $};
\draw (7.5, 0) node{$ \dots $};
\draw (10, 0) circle (1) node{$ \le k\br{k - 1}^{d - 1} $};
\draw (10, -1.5) node{$ \Gamma_d\br{x} $};
\draw (0, 0) to (1.5, 0);
\draw (2.5, 0) to (4, 0);
\draw (6, 0) to (7, 0);
\draw (8, 0) to (9, 0);
\end{tikzpicture}.
$$
Thus
$$ \abs{V\br{\Gamma}} = 1 + k + \abs{\Gamma_2\br{x}} + \dots + \abs{\Gamma_d\br{x}} \le 1 + k + k\br{k - 1} + \dots + k\br{k - 1}^{d - 1}. $$
\end{proof}

\begin{definition*}
A \textbf{Moore graph} is a connected regular graph of valency $ k $ and diameter $ d $ such that $ \abs{V\br{\Gamma}} = \N\br{k, d} $.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ k = 2 $. Then $ \abs{V\br{\Gamma}} = 1 + 2d $ so $ \Gamma $ is a $ \br{1 + 2d} $-gon
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\draw (0.5, -1) node{$ \dots $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\end{tikzpicture}.
$$
\item Let $ k = 3 $ and $ d = 2 $. Then $ \abs{V\br{\Gamma}} = 1 + 3 + 6 = 10 $, such as the Petersen graph.
\item Let $ k = 4 $ and $ d = 2 $. Then $ \abs{V\br{\Gamma}} = 1 + 4 + 12 = 17 $. Claim that there is no such graph. Suppose $ \Gamma = \br{V, E} $ is such a graph of $ \abs{V} = 17 $, valency four, and diameter two. $ \Gamma $ has no
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\end{tikzpicture},
\qquad
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0, -1);
\draw (1, 0) to (1, -1);
\draw (0, -1) to (1, -1);
\end{tikzpicture},
$$
since $ \Gamma $ is
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, 0.5) circle (0.1);
\fill (0.5, 0.5) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (0.5, -0.5) circle (0.1);
\fill (-1, 1) circle (0.1);
\fill (-0.5, 1) circle (0.1);
\fill (0.5, 1) circle (0.1);
\fill (1, 1) circle (0.1);
\fill (-1, 0.5) circle (0.1);
\fill (1, 0.5) circle (0.1);
\fill (-1, -0.5) circle (0.1);
\fill (1, -0.5) circle (0.1);
\fill (-1, -1) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (-0.5, 0.5);
\draw (0, 0) to (0.5, 0.5);
\draw (0, 0) to (-0.5, -0.5);
\draw (0, 0) to (0.5, -0.5);
\draw (-0.5, 0.5) to (-1, 1);
\draw (-0.5, 0.5) to (-0.5, 1);
\draw (0.5, 0.5) to (0.5, 1);
\draw (0.5, 0.5) to (1, 1);
\draw (-0.5, 0.5) to (-1, 0.5);
\draw (0.5, 0.5) to (1, 0.5);
\draw (-0.5, -0.5) to (-1, -0.5);
\draw (0.5, -0.5) to (1, -0.5);
\draw (-0.5, -0.5) to (-1, -1);
\draw (-0.5, -0.5) to (-0.5, -1);
\draw (0.5, -0.5) to (0.5, -1);
\draw (0.5, -0.5) to (1, -1);
\end{tikzpicture}.
$$

\pagebreak

Take an edge $ 0 \sim \infty $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[below]{$ 0 $};
\fill (1, 0) circle (0.1) node[below]{$ \infty $};
\fill (-0.5, 0.5) circle (0.1) node[left]{$ a $};
\fill (1.5, 0.5) circle (0.1) node[right]{$ x $};
\fill (-0.5, 0) circle (0.1) node[left]{$ b $};
\fill (1.5, 0) circle (0.1) node[right]{$ y $};
\fill (-0.5, -0.5) circle (0.1) node[left]{$ c $};
\fill (1.5, -0.5) circle (0.1) node[right]{$ z $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, 0.5);
\draw (1, 0) to (1.5, 0.5);
\draw (0, 0) to (-0.5, 0);
\draw (1, 0) to (1.5, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\end{tikzpicture}.
$$
$ a $ is not adjacent to $ x, y, z $, since no squares, so $ a $ and $ x $ have a common neighbour say $ \br{a, x} $. Similarly get vertices $ \br{a, y}, \br{a, z}, \br{b, x}, \br{b, y}, \br{b, z}, \br{c, x}, \br{c, y}, \br{c, z} $. This gives nine vertices, else get squares. This accounts for all vertices in $ \Gamma $. Also, $ \br{a, x} \nsim \br{a, y}, \br{a, x} \nsim \br{a, z}, \br{a, x} \nsim \br{b, x}, \br{a, x} \nsim \br{c, x} $, since there are no triangles
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ a $};
\fill (1, 0.5) circle (0.1) node[right]{$ \br{a, x} $};
\fill (1, -0.5) circle (0.1) node[right]{$ \br{a, y} $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (1, -0.5);
\end{tikzpicture},
\qquad
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ a $};
\fill (1, 0.5) circle (0.1) node[right]{$ \br{a, x} $};
\fill (1, -0.5) circle (0.1) node[right]{$ \br{a, z} $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (1, -0.5);
\end{tikzpicture},
\qquad
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ a $};
\fill (1, 0.5) circle (0.1) node[right]{$ \br{a, x} $};
\fill (1, -0.5) circle (0.1) node[right]{$ \br{b, x} $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (1, -0.5);
\end{tikzpicture},
\qquad
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ a $};
\fill (1, 0.5) circle (0.1) node[right]{$ \br{a, x} $};
\fill (1, -0.5) circle (0.1) node[right]{$ \br{c, x} $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (1, -0.5);
\end{tikzpicture}.
$$
Now $ \br{a, x} $ has two neighbours from $ \br{b, y}, \br{b, z}, \br{c, z}, \br{c, z} $. Say $ \br{a, x} \sim \br{b, y} $. Then $ \br{a, x} \nsim \br{c, y} $ and $ \br{a, x} \nsim \br{b, z} $, since there are no squares
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ \br{a, x} $};
\fill (1, 0.5) circle (0.1) node[above]{$ \br{b, y} $};
\fill (1, -0.5) circle (0.1) node[below]{$ \br{c, y} $};
\fill (2, 0) circle (0.1) node[right]{$ y $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (2, 0);
\draw (1, -0.5) to (2, 0);
\end{tikzpicture},
\qquad
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ \br{a, x} $};
\fill (1, 0.5) circle (0.1) node[above]{$ \br{b, y} $};
\fill (1, -0.5) circle (0.1) node[below]{$ \br{b, z} $};
\fill (2, 0) circle (0.1) node[right]{$ b $};
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (1, -0.5);
\draw (1, 0.5) to (2, 0);
\draw (1, -0.5) to (2, 0);
\end{tikzpicture},
$$
so $ \br{a, x} \sim \br{c, z} $. Now $ \br{b, y} $ has two neighbours in $ \br{a, x}, \br{a, z}, \br{c, x}, \br{c, z} $. Since $ \br{b, y} \sim \br{a, x} $, $ \br{b, y} \nsim \br{c, x} $ and $ \br{b, y} \nsim \br{a, z} $, so $ \br{b, y} \sim \br{c, z} $. But then
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ \br{a, x} $};
\fill (1, 0) circle (0.1) node[right]{$ \br{b, y} $};
\fill (0.5, -1) circle (0.1) node[below]{$ \br{c, z} $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0.5, -1);
\draw (1, 0) to (0.5, -1);
\end{tikzpicture},
$$
a contradiction.
\end{itemize}
\end{example*}

A question is for which values of $ k $ is there a Moore graph of valency $ k $ and diameter two? The answer is only $ k = 2 $, the \textbf{$ 5 $-cycle}, $ k = 3 $, the Petersen graph, $ k = 7 $, the \textbf{Hoffman-Singleton graph}, or $ k = 57 $, which is unknown. We will prove this using the theory of strongly regular graphs.

\lecture{14}{Tuesday}{06/11/18}

Lecture 14 is a problems class.

\subsubsection{Strongly regular graphs}

\lecture{15}{Wednesday}{07/11/18}

\begin{definition*}
A \textbf{strongly regular graph} with parameters $ \br{v, k, \lambda, \mu} $, or $ \srg\br{v, k, \lambda, \mu} $ is a graph with $ v $ vertices that is regular of valency $ k $ such that
\begin{itemize}
\item every pair of adjacent vertices have exactly $ \lambda $ common neighbours, and
\item every pair of non-adjacent vertices have exactly $ \mu $ common neighbours, and
\end{itemize}
\end{definition*}

\begin{note*}
We do not include the complete graphs $ \K_n $ or $ \overline{\K_n} $, that is $ \lambda $ and $ \mu $ are defined.
\end{note*}

\begin{example*}
\hfill
\begin{itemize}
\item $ n \cdot \K_m $ is the disjoint union of $ n $ copies of $ \K_m $,
$$
\begin{tikzpicture}
\draw (0, 0) circle (0.5) node{$ \K_m $};
\draw (4, 0) circle (0.5) node{$ \K_m $};
\draw [dashed] (0.5, 0) to node[below]{$ n $} (3.5, 0);
\end{tikzpicture}.
$$
For $ n, m \ge 2 $,
$$ n \cdot \K_m = \srg\br{nm, m - 1, m - 2, 0}. $$

\pagebreak

\item $ \K_{n\sbr{m}} $ is the graph with $ n $ parts of size $ m $ such that $ u \sim v $ if and only if $ u $ and $ v $ are in different parts, the \textbf{complete multipartite graph}
$$
\begin{tikzpicture}
\draw (0, 0) ellipse (0.5 and 1);
\fill (0, 0.5) circle (0.1);
\fill (0, -0.5) circle (0.1);
\draw [dashed] (0, 0.5) to node[left]{$ m $} (0, -0.5);
\draw (4, 0) ellipse (0.5 and 1);
\fill (4, 0.5) circle (0.1);
\fill (4, -0.5) circle (0.1);
\draw [dashed] (4, 0.5) to node[right]{$ m $} (4, -0.5);
\draw [dashed] (0.5, 0) to node[below]{$ n $} (3.5, 0);
\draw (0, 0.5) to (4, 0.5);
\draw (0, 0.5) to (4, -0.5);
\draw (0, -0.5) to (4, 0.5);
\draw (0, -0.5) to (4, -0.5);
\end{tikzpicture}.
$$
For $ n, m \ge 2 $,
$$ \K_{n\sbr{m}} = \srg\br{nm, nm - m, nm - 2m, nm - m}. $$
When $ n = 2 $, this is the \textbf{complete bipartite graph}.
\end{itemize}
\end{example*}

\begin{note*}
$ \K_{n\sbr{m}} = \overline{n \cdot \K_m} $. For example,
$$
\begin{array}{ccc}
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\fill (2, 0) circle (0.1);
\fill (1.5, -1) circle (0.1);
\fill (2.5, -1) circle (0.1);
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\draw (2, 0) to (1.5, -1);
\draw (2, 0) to (2.5, -1);
\draw (1.5, -1) to (2.5, -1);
\end{tikzpicture},
& \qquad &
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (0, -0.5) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (1, -0.5) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (1, -0.5);
\draw (0, 0) to (1, -1);
\draw (0, -0.5) to (1, 0);
\draw (0, -0.5) to (1, -0.5);
\draw (0, -0.5) to (1, -1);
\draw (0, -1) to (1, 0);
\draw (0, -1) to (1, -0.5);
\draw (0, -1) to (1, -1);
\end{tikzpicture}
\\
2 \cdot \K_3 & & \K_{2\sbr{3}}
\end{array}.
$$
\end{note*}

\begin{proposition}
\label{prop:2.2}
Let $ \Gamma = \srg\br{v, k, \lambda, \mu} $. Then
\begin{enumerate}
\item if $ \mu > 0 $, then $ \diam \Gamma = 2 $, so $ \Gamma $ is connected,
\item if $ \mu = 0 $, then $ \Gamma \cong n \cdot \K_m $ for some $ n, m \ge 2 $, and
\item if $ \mu = k $, then $ \Gamma \cong \K_{n\sbr{m}} $ for some $ n, m \ge 2 $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item If $ u $ and $ v $ are distinct vertices then either $ u \sim v $ or $ u \nsim v $, in which case $ u $ and $ v $ have a common neighbour.
\item Suppose $ \mu = 0 $. Let $ u $ be a vertex with neighbours $ u_1, \dots, u_k $. Since $ \mu = 0 $, $ u_i \sim u_j $ for all $ i \ne j $, else, $ u $ is a common neighbour of $ u_i $ and $ u_j $. So the vertices $ u, u_1, \dots, u_k $ form $ \K_{k + 1} $. Any other vertex $ v $ also lies in a $ \K_{k + 1} $. Repeat.
\item Sheet $ 3 $. \footnote{Exercise}
\end{enumerate}
\end{proof}

\begin{proposition}
Let $ \Gamma = \srg\br{v, k, \lambda, \mu} $. Then
$$ \overline{\Gamma} = \srg\br{v, v - k - 1, v - 2k + \mu - 2, v - 2k + \lambda}. $$
\end{proposition}

\begin{proof}
Sheet $ 3 $. \footnote{Exercise}
\end{proof}

\begin{example*}
\hfill
\begin{itemize}
\item Moore graphs with diameter two is
$$ \srg\br{1 + k^2, k, 0, 1}, $$
since no triangles, so $ \lambda = 0 $, and no squares, so $ \mu = 1 $.

\pagebreak

\item The \textbf{Triangular graph} $ \T\br{n} $ for $ n \ge 2 $, has
\begin{itemize}
\item vertices $ 2 $-subsets of $ \cbr{1, \dots, n} $, and
\item $ \cbr{i, j} \sim \cbr{k, l} $ if and only if $ \abs{\cbr{i, j} \cap \cbr{k, l}} = 1 $,
\end{itemize}
so $ v = \binom{n}{2} $ and $ k = 2\br{n - 2} $. Then $ \cbr{i, j} \sim \cbr{i, k} $ has common neighbours $ \cbr{i, l} $ for $ l \ne i, j, k $, and also $ \cbr{j, k} $, so $ \lambda = n - 2 $, and $ \cbr{i, j} \nsim \cbr{k, l} $ has common neighbours are $ \cbr{i, k}, \cbr{i, l}, \cbr{j, k}, \cbr{j, l} $, so $ \mu = 4 $. Thus for $ n \ge 4 $,
$$ \T\br{n} = \srg\br{\binom{n}{2}, 2\br{n - 2}, n - 2, 4}. $$
Show $ \overline{\T\br{5}} $ is the Petersen graph. Sheet $ 3 $. \footnote{Exercise}
\item The \textbf{Lattice graph} $ \L\br{n} $ has
\begin{itemize}
\item vertices $ \br{i, j} $ for $ i, j \in \cbr{1, \dots, n} $, and
\item $ \br{i, j} \sim \br{k, l} $ if and only if $ i = k $ or $ j = l $.
\end{itemize}
For example, for $ n = 3 $,
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (0.5, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0, -0.5) circle (0.1);
\fill (0.5, -0.5) circle (0.1);
\fill (1, -0.5) circle (0.1);
\fill (0, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\fill (1, -1) circle (0.1);
\draw (0, 0) to (0.5, 0);
\draw (0.5, 0) to (1, 0);
\draw (0, 0) to [bend left=45] (1, 0);
\draw (0, 0) to (0, -0.5);
\draw (0.5, 0) to (0.5, -0.5);
\draw (1, 0) to (1, -0.5);
\draw (0, -0.5) to (0.5, -0.5);
\draw (0.5, -0.5) to (1, -0.5);
\draw (0, -0.5) to [bend left=45] (1, -0.5);
\draw (0, -0.5) to (0, -1);
\draw (0.5, -0.5) to (0.5, -1);
\draw (1, -0.5) to (1, -1);
\draw (0, -1) to (0.5, -1);
\draw (0.5, -1) to (1, -1);
\draw (0, -1) to [bend left=45] (1, -1);
\draw (0, 0) to [bend right=45] (0, -1);
\draw (0.5, 0) to [bend right=45] (0.5, -1);
\draw (1, 0) to [bend right=45] (1, -1);
\end{tikzpicture}.
$$
Thus for $ n \ge 2 $,
$$ \L\br{n} = \srg\br{n^2, 2\br{n - 1}, n - 2, 2}. $$
\item Let $ p \equiv 1 \mod 4 $ be a prime. Then $ \ZZ_p $ is a field. Let $ Q = \cbr{x^2 \st x \in \ZZ_p^*} $. This is a subgroup of $ \br{\ZZ_p^*, \times} $. Define a homomorphism
$$ \function[\phi]{\ZZ_p^*}{Q}{x}{x^2}. $$
Then $ K = \ker \phi = \cbr{x \in \ZZ_p^* \st x^2 = 1} = \cbr{\pm 1} $, so $ \abs{Q} = \abs{\ZZ_p^*} / \abs{K} = \br{p - 1} / 2 $, and $ \ZZ_p^* $ has a unique element of order two, namely $ -1 \equiv p - 1 \in \ZZ_p^* $. Since $ p \equiv 1 \mod 4 $, $ \abs{Q} $ is even, so $ -1 \in Q $. The \textbf{Payley graph} $ \Pay\br{p} $ has
\begin{itemize}
\item vertices $ \ZZ_p $, and
\item $ x \sim y $ if and only if $ x - y \in Q $.
\end{itemize}
Note that $ -1 \in Q $, so $ x - y \in Q $ if and only if $ y - x \in Q $. For example, for $ p = 5 $, $ Q = \cbr{1, 4} $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ 0 $};
\fill (1, 0) circle (0.1) node[right]{$ 1 $};
\fill (-0.5, -0.5) circle (0.1) node[left]{$ 4 $};
\fill (1.5, -0.5) circle (0.1) node[right]{$ 2 $};
\fill (0.5, -1) circle (0.1) node[below]{$ 3 $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\end{tikzpicture}
$$
\end{itemize}
\end{example*}

\begin{proposition}
For $ p \equiv 1 \mod 4 $,
$$ \Pay\br{p} = \srg\br{p, \dfrac{p - 1}{2}, \dfrac{p - 5}{2}, \dfrac{p - 1}{4}}. $$
\end{proposition}

\begin{proof}
Sheet $ 3 $. \footnote{Exercise}
\end{proof}

\pagebreak

\subsection{Some theory of strongly regular graphs}

\subsubsection{Properties}

\begin{proposition}
\label{prop:2.5}
If $ \Gamma = \srg\br{v, k, \lambda, \mu} $ then
$$ k\br{k - \lambda - 1} = \mu\br{v - k - 1}. $$
\end{proposition}

\begin{proof}
Let $ x $ be a vertex. Each vertex in $ \Gamma\br{x} $ has $ \lambda $ neighbours in $ \Gamma\br{x} $, so has $ k - \lambda - 1 $ neighbours in $ \Gamma_2\br{x} $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\draw (0, -0.5) node{$ x $};
\draw (2, 0) circle (1);
\draw (2, -1.5) node{$ \Gamma\br{x} $};
\draw (5, 0) circle (1);
\draw (5, -1.5) node{$ \Gamma_2\br{x} $};
\draw (0, 0) to (1, 0);
\draw (3, 0) to (4, 0);
\fill (2, 0.5) circle (0.1);
\draw (2, 0.5) to (1.5, -0.5);
\draw (2, 0.5) to (2.5, -0.5);
\draw [dashed] (1.5, -0.5) to node[below]{$ \lambda $} (2.5, -0.5);
\draw (2, 0.5) to (5, 0.5);
\draw (2, 0.5) to (5, -0.5);
\draw [dashed] (5, 0.5) to node[right]{$ k - \lambda - 1 $} (5, -0.5);
\end{tikzpicture}.
$$
Each vertex in $ \Gamma_2\br{x} $ has $ \mu $ neighbours in $ \Gamma\br{x} $, so has $ k - \mu $ neighbours in $ \Gamma_2\br{x} $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\draw (0, -0.5) node{$ x $};
\draw (2, 0) circle (1);
\draw (2, -1.5) node{$ \Gamma\br{x} $};
\draw (5, 0) circle (1);
\draw (5, -1.5) node{$ \Gamma_2\br{x} $};
\draw (0, 0) to (1, 0);
\draw (3, 0) to (4, 0);
\fill (5, 0.5) circle (0.1);
\draw (5, 0.5) to (4.5, -0.5);
\draw (5, 0.5) to (5.5, -0.5);
\draw [dashed] (4.5, -0.5) to node[below]{$ k - \mu $} (5.5, -0.5);
\draw (5, 0.5) to (2, 0.5);
\draw (5, 0.5) to (2, -0.5);
\draw [dashed] (2, 0.5) to node[left]{$ \mu $} (2, -0.5);
\end{tikzpicture}.
$$
Let $ N $ be the number of $ \cbr{u, v} $ such that $ u \in \Gamma\br{x} $ and $ v \in \Gamma_2\br{x} $. Then counting $ N $ two ways,
$$ k\br{k - \lambda - 1} = N = \mu\br{v - k - 1}. $$
\end{proof}

\lecture{16}{Tuesday}{13/11/18}

\textbf{Distance distribution diagram (DDD)} for $ \srg\br{v, k, \lambda, \mu} $ is
$$
\begin{tikzpicture}
\draw (0, 0) circle (0.25) node{$ 1 $};
\draw (2, 0) circle (0.5) node{$ k $};
\draw (6, 0) circle (1) node{$ v - k - 1 $};
\draw (0.25, 0) to (1.5, 0);
\draw (2.5, 0) node[below right]{$ k - \lambda - 1 $} to (5, 0) node[below left]{$ \mu $};
\draw (2, -0.5) node[below]{$ \lambda $};
\draw (6, -1) node[below]{$ k - \mu $};
\end{tikzpicture}.
$$

\begin{example*}
Let $ \Gamma = \srg\br{v, k, 0, 1} $. Then
$$
\begin{tikzpicture}
\draw (0, 0) circle (0.25) node{$ 1 $};
\draw (2, 0) circle (0.5) node{$ k $};
\draw (6, 0) circle (1) node{$ v - k - 1 $};
\draw (0.25, 0) to (1.5, 0);
\draw (2.5, 0) node[below right]{$ k - 1 $} to (5, 0) node[below left]{$ 1 $};
\draw (2, -0.5) node[below]{$ 0 $};
\draw (6, -1) node[below]{$ k - 1 $};
\end{tikzpicture}.
$$
\ref{prop:2.5} implies that $ k\br{k - 1} = v - k - 1 $, so $ v = k^2 + 1 $. Thus $ \Gamma $ is a Moore graph of dimension two.
\end{example*}

\pagebreak

\subsubsection{Adjacency matrices}

\begin{definition*}
Let $ \Gamma $ be a graph with vertices $ e_1, \dots, e_v $. The \textbf{adjacency matrix} $ A $ of $ \Gamma $ is $ A = \br{a_{ij}} $ where
$$ a_{ij} =
\begin{cases}
1 & e_i \sim e_j \\
0 & \text{otherwise}
\end{cases}.
$$
\end{definition*}

\begin{example*}
Let $ \Gamma $ be
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ e_1 $};
\fill (1, 0) circle (0.1) node[right]{$ e_2 $};
\fill (-0.5, -0.5) circle (0.1) node[left]{$ e_5 $};
\fill (1.5, -0.5) circle (0.1) node[right]{$ e_3 $};
\fill (0.5, -1) circle (0.1) node[below]{$ e_4 $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\end{tikzpicture}.
$$
Then
$$ A =
\begin{pmatrix}
0 & 1 & 0 & 0 & 1 \\
1 & 0 & 1 & 0 & 0 \\
0 & 1 & 0 & 1 & 0 \\
0 & 0 & 1 & 0 & 1 \\
1 & 0 & 0 & 1 & 0
\end{pmatrix}.
$$
\end{example*}

$ A $ is symmetric, entries $ 0 $'s and $ 1 $'s, and $ 0 $'s on the diagonal. For strongly regular graphs, $ A $ has nice properties.

\begin{proposition}
\label{prop:2.6}
Let $ \Gamma = \srg\br{v, k, \lambda, \mu} $, with adjacency matrix $ A $. Let $ \J = \br{x_{ij}} $ be a $ v \times v $ matrix where $ x_{ij} = 1 $ for all $ i $ and $ j $. Then
\begin{enumerate}
\item $ A\J = k\J $, and
\item $ A^2 = \br{\lambda - \mu}A + \br{k - \mu}\I + \mu\J $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item
$$ A\threebyone{1}{\vdots}{1} = k\threebyone{1}{\vdots}{1}, $$
so $ A\J = k\J $.
\item $ A $ is symmetric, so $ A = A^\intercal $. Let $ V = \cbr{e_1, \dots, e_v} $. Then
$$ \br{A^2}_{ij} = \br{AA^\intercal}_{ij} = A_{i\cdot}A_{\cdot j}^\intercal = A_{i\cdot} \cdot A_{j\cdot} = \abs{\cbr{e_k \in V \st e_i \sim e_k, \ e_j \sim e_k}} =
\begin{cases}
k & i = j \\
\lambda & i \sim j \\
\mu & i \nsim j, \ i \ne j
\end{cases}.
$$
Then $ A^2 $ has $ k $ on the diagonal, $ \lambda $ where $ A $ has one, and $ \mu $ where $ A $ has zero, off the diagonal. Thus
$$ A^2 = k\I + \lambda A + \mu\br{\J - A - \I} = \br{\lambda - \mu}A + \br{k - \mu}\I + \mu\J. $$
\end{enumerate}
\end{proof}

The key to the study of strongly regular graphs are the eigenvalues of the adjacency matrix $ A $. For any graph with adjacency matrix $ A $, since $ A $ is a real symmetric matrix, it has real eigenvalues and is diagonalisable, that is there exists an invertible matrix $ P $ such that
$$ P^{-1}AP = \threebythree{\lambda_1}{}{0}{}{\ddots}{}{0}{}{\lambda_v}. $$
We call the $ \lambda_i $ the \textbf{eigenvalues} of $ \Gamma $. The \textbf{multiplicity} of $ \lambda_i $ is the number of times, with repeats, that it appears, which is equal to the algebraic multiplicity and the geometric multiplicity.

\pagebreak

\subsubsection{Main theorem}

\begin{theorem}[Main theorem]
\label{thm:2.7}
Let $ \Gamma = \srg\br{v, k, \lambda, \mu} $ where $ \mu > 0 $, that is $ \Gamma $ is connected. Let $ A $ be the adjacency matrix of $ \Gamma $. Then
\begin{enumerate}
\item $ A $ has exactly three distinct eigenvalues $ k, r_1, r_2 $ where $ r_1 $ and $ r_2 $ are the roots of
$$ x^2 - \br{\lambda - \mu}x - \br{k - \mu} = \br{x - r_1}\br{x - r_2}, $$
\item the eigenvalue $ k $ has multiplicity one, and eigenvalues $ r_1 $ and $ r_2 $ have multiplicities $ m_1 $ and $ m_2 $ where
$$ m_1 + m_2 = v - 1, \qquad r_1m_1 + r_2m_2 = -k, $$
\item either $ r_1, r_2 \in \ZZ $ or
$$ \br{v, k, \lambda, \mu} = \br{4\mu + 1, 2\mu, \mu - 1, \mu}. $$
\end{enumerate}
\end{theorem}

We will prove this later. The $ \srg\br{4\mu + 1, 2\mu, \mu - 1, \mu} $ are called the \textbf{conference graphs}.

\begin{note*}
\textbf{Conference matrix theorem} is that these graphs only exist when $ 4\mu + 1 $ is a sum of two squares. Proved by Belevitch in 1950, and elementary linear algebra proof by van Lint and Seidel in 1966.
\end{note*}

\subsubsection{Application to Moore graphs}

First some applications.

\begin{theorem}
If there exists a Moore graph of diameter two and valency $ k $, then $ k = 2, 3, 7, 57 $.
\end{theorem}

\begin{note*}
For diameter at least three, the only Moore graphs are $ \br{2d + 1} $-gons, where $ k = 2 $, by Morell in 1973.
\end{note*}

\begin{proof}
Let $ \Gamma $ be such a graph with adjacency matrix $ A $. Note that $ \Gamma = \srg\br{k^2 + 1, k, 0, 1} $. Since $ \mu = 1 > 0 $, \ref{thm:2.7} applies. By \ref{thm:2.7}.$ 1 $, $ A $ has three eigenvalues $ k, r_1, r_2 $ where $ r_1 $ and $ r_2 $ are the roots of
$$ x^2 - \br{\lambda - \mu}x - \br{k - \mu} = x^2 + x - \br{k - 1}. $$
Then
$$ r_1, r_2 = \dfrac{1}{2}\br{-1 \pm \sqrt{4k - 3}}. $$
By \ref{thm:2.7}.$ 2 $, the multiplicities of $ r_1 $ and $ r_2 $ are $ m_1 $ and $ m_2 $ where
$$ m_1 + m_2 = k^2, \qquad r_1m_1 + r_2m_2 = -k. $$
Then
$$ \dfrac{m_1}{2}\br{-1 + \sqrt{4k - 3}} + \dfrac{m_2}{2}\br{-1 - \sqrt{4k - 3}} = -k, $$
so
\begin{equation}
\label{eq:2}
\sqrt{4k - 3}\br{m_1 - m_2} = \br{m_1 + m_2} - 2k = k^2 - 2k = k\br{k - 2}.
\end{equation}
By \ref{thm:2.7}.$ 3 $, either $ r_1, r_2 \in \ZZ $, or $ \br{v, k, \lambda, \mu} = \br{5, 2, 0, 1} $, then $ \Gamma $ is
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (-0.5, -0.5) circle (0.1);
\fill (1.5, -0.5) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (-0.5, -0.5);
\draw (1, 0) to (1.5, -0.5);
\draw (-0.5, -0.5) to (0.5, -1);
\draw (1.5, -0.5) to (0.5, -1);
\end{tikzpicture},
$$
and $ k = 2 $, so done. Thus assume $ r_1, r_2 \in \ZZ $. Then $ \sqrt{4k - 3} \in \ZZ $. By $ \br{\ref{eq:2}} $, $ 4k - 3 \mid k^2\br{k - 2}^2 $. Now $ \gcd\br{4k - 3, k} $ divides three and $ \gcd\br{4k - 3, k - 2} $ divides five, so $ 4k - 3 \mid 3^2 \cdot 5^2 $ and $ 4k - 3 $ is square. So $ 4k - 3 = 1^2, 3^2, 5^2, 3^2 \cdot 5^2 $, so $ k = 1, 3, 7, 57 $. But $ k \ne 1 $ or else $ \Gamma $ is
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\draw (0, 0) to (1, 0);
\end{tikzpicture},
$$
which is complete.
\end{proof}

\pagebreak

\subsubsection{Friendship theorem}

\lecture{17}{Tuesday}{13/11/18}

This is the following.

\begin{theorem}
In a graph $ \Gamma $ in which any two vertices have exactly one common neighbour, there exists a vertex that is adjacent to all other vertices. That is, the graph of $ \Gamma $ is a windmill
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (-0.5, 1) circle (0.1);
\fill (0.5, 1) circle (0.1);
\fill (-1, 0.5) circle (0.1);
\fill (1, 0.5) circle (0.1);
\fill (-1, -0.5) circle (0.1);
\fill (1, -0.5) circle (0.1);
\fill (-0.5, -1) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (-0.5, 1);
\draw (0, 0) to (0.5, 1);
\draw (0, 0) to (-1, 0.5);
\draw (0, 0) to (1, 0.5);
\draw (0, 0) to (-1, -0.5);
\draw (0, 0) to (1, -0.5);
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -1);
\draw [dashed] (-0.5, 1) to (0.5, 1);
\draw (-0.5, 1) to (-1, 0.5);
\draw (0.5, 1) to (1, 0.5);
\draw [dashed] (-1, 0.5) to (-1, -0.5);
\draw [dashed] (1, 0.5) to (1, -0.5);
\draw (-1, -0.5) to (-0.5, -1);
\draw (1, -0.5) to (0.5, -1);
\draw [dashed] (-0.5, -1) to (0.5, -1);
\end{tikzpicture}.
$$
\end{theorem}

\begin{proof}
Assume $ \Gamma $ has more than one vertex. Suppose for a contradiction that no vertex is adjacent to every other vertex.
\begin{enumerate}[leftmargin=0.5in, label=Step \arabic*.]
\item $ \Gamma $ is regular, so $ \srg\br{v, k, 1, 1} $. For a vertex $ P $, let $ v\br{P} $ be the number of neighbours of $ P $. First show,
\begin{equation}
\label{eq:3}
P \nsim Q \qquad \implies \qquad v\br{P} = v\br{Q}.
\end{equation}
$ P $ and $ Q $ have a unique common neighbour $ R $. $ P $ and $ R $ have a unique common neighbour $ S $. $ Q $ and $ R $ have a unique common neighbour $ T $. Let the remaining neighbours of $ P $ be $ u_1, \dots, u_l $, and let the remaining neighbours of $ Q $ be $ v_1, \dots, v_m $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ P $};
\fill (2, 0) circle (0.1) node[right]{$ Q $};
\fill (0, -1) circle (0.1) node[left]{$ S $};
\fill (1, -1) circle (0.1) node[below]{$ R $};
\fill (2, -1) circle (0.1) node[right]{$ T $};
\fill (0.5, 1) circle (0.1) node[above]{$ u_1 $};
\fill (0.5, 0) circle (0.1) node[below]{$ u_l $};
\fill (1.5, 1) circle (0.1) node[above]{$ v_1 $};
\fill (1.5, 0) circle (0.1) node[below]{$ v_m $};
\draw (0, 0) to (1, -1);
\draw (2, 0) to (1, -1);
\draw (0, 0) to (0, -1);
\draw (1, -1) to (0, -1);
\draw (2, 0) to (2, -1);
\draw (1, -1) to (2, -1);
\draw (0, 0) to (0.5, 1);
\draw (0, 0) to (0.5, 0);
\draw [dashed] (0.5, 1) to (0.5, 0);
\draw (2, 0) to (1.5, 1);
\draw (2, 0) to (1.5, 0);
\draw [dashed] (1.5, 1) to (1.5, 0);
\end{tikzpicture}.
$$
$ u_i \ne v_j $ since $ R $ is the unique neighbour of $ P $ and $ Q $. Now $ u_1 $ and $ Q $ have a common neighbour, not $ R $ or $ T $, since if $ T $, then $ P $ and $ T $ would have two common neighbours, and if $ R $, then $ S $ and $ u_1 $ would have two common neighbours. So common neighbour is one of $ v_i $, say $ v_1 $. Similarly, $ u_2 $ and $ Q $ have a unique common neighbour, not $ R $ or $ T $, not $ v_1 $, otherwise $ u_1 $ and $ u_2 $ have two common neighbours. So $ u_2 $ is adjacent to some $ v_i $ where $ i > 1 $, say $ v_2 $. Carrying on, $ u_l $ is adjacent to $ v_l $, hence $ m \ge l $. Similarly, $ l \ge m $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ P $};
\fill (2, 0) circle (0.1) node[right]{$ Q $};
\fill (0, -1) circle (0.1) node[left]{$ S $};
\fill (1, -1) circle (0.1) node[below]{$ R $};
\fill (2, -1) circle (0.1) node[right]{$ T $};
\fill (0.5, 1) circle (0.1) node[above]{$ u_1 $};
\fill (0.5, 0) circle (0.1) node[below]{$ u_l $};
\fill (1.5, 1) circle (0.1) node[above]{$ v_1 $};
\fill (1.5, 0) circle (0.1) node[below]{$ v_l $};
\draw (0, 0) to (1, -1);
\draw (2, 0) to (1, -1);
\draw (0, 0) to (0, -1);
\draw (1, -1) to (0, -1);
\draw (2, 0) to (2, -1);
\draw (1, -1) to (2, -1);
\draw (0, 0) to (0.5, 1);
\draw (0, 0) to (0.5, 0);
\draw [dashed] (0.5, 1) to (0.5, 0);
\draw (2, 0) to (1.5, 1);
\draw (2, 0) to (1.5, 0);
\draw [dashed] (1.5, 1) to (1.5, 0);
\draw (0.5, 1) to (1.5, 1);
\draw (0.5, 0) to (1.5, 0);
\end{tikzpicture}.
$$
Thus $ v\br{P} = l + 2 = v\br{Q} $. So $ \br{\ref{eq:3}} $ holds. Now there exist $ P $ and $ Q $ such that $ P \nsim Q $. If not then $ \Gamma $ is complete, so $ \Gamma $ is
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (0.5, -1) circle (0.1);
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0.5, -1);
\draw (1, 0) to (0.5, -1);
\end{tikzpicture},
$$
a contradiction of assumption. Let $ R $ be the unique common neighbour of $ P $ and $ Q $. Let $ S $ be any vertex other than $ P $, $ Q $, and $ R $. Then $ S $ is not adjacent to both $ P $ and $ Q $, so without loss of generality $ S \nsim P $. By $ \br{\ref{eq:3}} $, $ v\br{S} = v\br{P} = v\br{Q} $. By assumption, $ R $ is not adjacent to every vertex in $ \Gamma $, so there exists $ S' $ such that $ R \nsim S' $ so $ v\br{R} = v\br{S'} = v\br{P} = v\br{Q} $. Thus $ \Gamma $ is regular. Hence
$$ \Gamma = \srg\br{v, k, 1, 1}, \qquad k \ge 3, $$
since no strongly regular graph has $ k = 1 $, and if $ k = 2 $, then $ \Gamma = \K_3 $, a contradiction.

\pagebreak

\item There is no such $ \Gamma $. DDD is
$$
\begin{tikzpicture}
\draw (0, 0) circle (0.25) node{$ 1 $};
\draw (2, 0) circle (0.5) node{$ k $};
\draw (6, 0) circle (1) node{$ v - k - 1 $};
\draw (0.25, 0) to (1.5, 0);
\draw (2.5, 0) node[below right]{$ k - 2 $} to (5, 0) node[below left]{$ 1 $};
\draw (2, -0.5) node[below]{$ 1 $};
\draw (6, -1) node[below]{$ k - 1 $};
\end{tikzpicture}.
$$
\ref{prop:2.5} implies that $ k\br{k - 2} = v - k - 1 $, so $ v = k^2 - k + 1 $. Since $ \mu > 0 $, we can apply \ref{thm:2.7}. By \ref{thm:2.7}.$ 1 $ the eigenvalues of $ \Gamma $ are $ k, r_1, r_2 $ where $ r_1 $ and $ r_2 $ are the roots of $ x^2 - \br{k - 1} $. So $ r_1 = \sqrt{k - 1} $ and $ r_2 = -\sqrt{k - 1} $. By \ref{thm:2.7}.$ 2 $, $ r_i $ have multiplicities $ m_i $ where
$$ m_1 + m_2 = v - 1 = k^2 - k = k\br{k - 1}, \qquad m_1\sqrt{k - 1} - m_2\sqrt{k - 1} = -k, $$
that is $ \sqrt{k - 1}\br{m_1 - m_2} = -k $, so $ \br{k - 1}\br{m_1 - m_2}^2 = k^2 $, so $ k - 1 \mid k^2 $. But $ \gcd\br{k - 1, k} = 1 $, so $ k - 1 = 1 $, that is $ k = 2 $, a contradiction.
\end{enumerate}
\end{proof}

\subsubsection{Proof of the main theorem}

\begin{proof}[Proof of \ref{thm:2.7}]
Let $ \Gamma = \srg\br{v, k, \lambda, \mu} $ where $ \mu > 0 $. Let $ A $ be the adjacency matrix of $ \Gamma $. By \ref{prop:2.6}, $ A\J = k\J $ and
\begin{equation}
\label{eq:4}
A^2 = \br{\lambda - \mu}A + \br{k - \mu}\I + \mu\J.
\end{equation}
Let
$$ \overline{1} = \threebyone{1}{\vdots}{1}. $$
\begin{enumerate}[leftmargin=0.5in, label=Step \arabic*.]
\item Prove that $ k $ is an eigenvalue. $ A\overline{1} = k\overline{1} $ so $ k $ is an eigenvalue with eigenvector $ \overline{1} $.
\item Let $ r_1 $ and $ r_2 $ be the roots of
$$ x^2 - \br{\lambda - \mu}x - \br{k - \mu}. $$
Prove that $ A $ has at most three distinct eigenvalues $ k, r_1, r_2 $, and any eigenvector not in $ \sp \overline{1} $ has eigenvalue $ r_1 $ or $ r_2 $. Let $ w $ be an eigenvector, so $ Aw = \epsilon w $ for some $ \epsilon $. Assume $ w $ is not in $ \sp \overline{1} $. By $ \br{\ref{eq:4}} $
$$ A^2w = \br{\lambda - \mu}Aw + \br{k - \mu}\I w + \mu\J w. $$
Then $ \J w = c\overline{1} $ where $ c $ is the sum of entries in $ w $. Then
$$ \epsilon^2w = \br{\lambda - w}\epsilon w + \br{k - \mu}w + \mu c\overline{1}, $$
so
$$ \br{\epsilon^2 - \br{\lambda - \mu}\epsilon - \br{k - \mu}}w = \mu c\overline{1} \in \sp \overline{1}. $$
Thus
$$ \epsilon^2 - \br{\lambda - \mu}\epsilon - \br{k - \mu} = 0. $$
\item Prove that $ k $ has multiplicity one, and $ k \ne r_1, r_2 $. If $ k = r_1 $ or $ k = r_2 $, then
$$ k^2 - \br{\lambda - \mu}k - \br{k - \mu} = 0. $$
By \ref{prop:2.5}, $ k\br{k - \lambda - 1} = \mu\br{v - k - 1} $, so
$$ \mu v = k^2 - \br{\lambda - \mu}k - \br{k - \mu} = 0, $$
so $ \mu = 0 $, a contradiction of assumption. Thus $ k \ne r_1, r_2 $. By step $ 2 $, $ k $ has multiplicity one.

\pagebreak

\item Prove that the multiplicities of $ r_1 $ and $ r_2 $ satisfy
$$ m_1 + m_2 = v - 1, \qquad r_1m_1 + r_2m_2 = -k, $$
where if $ r_i $ is not an eigenvalue then $ m_i = 0 $. $ k $ has multiplicity one, so eigenvalues are
$$ k, \qquad \underbrace{r_1, \dots, r_1}_{m_1}, \qquad \underbrace{r_2, \dots, r_2}_{m_2}, $$
so $ 1 + m_1 + m_2 = r $. There exists an invertible matrix $ P $ such that
$$ P^{-1}AP =
\begin{pmatrix}
k & & & & & 0 \\
& r_1 & & & & & \\
& & \ddots & & & & \\
& & & r_1 & & & \\
& & & & r_2 & & \\
& & & & & \ddots & \\
0 & & & & & & r_2
\end{pmatrix}.
$$
Then
$$ k + m_1r_1 + m_2r_2 = \Tr P^{-1}AP = \Tr P^{-1}\br{PA} = \Tr A = 0, $$
where \textbf{trace} is the sum of the diagonal elements.

\lecture{18}{Wednesday}{14/11/18}

\item Prove that either $ r_1, r_2 \in \ZZ $ or
$$ \br{v, k, \lambda, \mu} = \br{4\mu + 1, 2\mu, \mu - 1, \mu}. $$
Let $ r_1 $ and $ r_2 $ be the roots of
$$ x^2 - \br{\lambda - \mu}x - \br{k - \mu}. $$
So
$$ r_1, r_2 = \dfrac{1}{2}\br{\lambda - \mu \pm \sqrt{\br{\lambda - \mu}^2 + 4\br{k - \mu}}} = \dfrac{1}{2}\br{\lambda - \mu \pm \sqrt{D}}. $$
By step $ 4 $,
$$ \dfrac{m_1}{2}\br{\lambda - \mu + \sqrt{D}} + \dfrac{m_1}{2}\br{\lambda - \mu - \sqrt{D}} = -k, $$
so
\begin{equation}
\label{eq:5}
\br{\lambda - \mu}\br{m_1 + m_2} + \sqrt{D}\br{m_1 - m_2} = -2k.
\end{equation}
\begin{itemize}
\item Suppose $ m_1 \ne m_2 $. Then $ \sqrt{D} \in \QQ $, so $ \sqrt{D} \in \ZZ $, since $ \sqrt{D} = a / b $ implies that $ D = a^2 / b^2 \in \ZZ $, so $ b^2 \mid a^2 $, so $ b \mid a $. Suppose $ r_i \notin \ZZ $, then $ r_1, r_2 \in \ZZ $ and have the form $ x / 2 $, where $ x $ is odd, so $ r_1r_2 \notin \ZZ $. But $ r_1r_2 = -\br{k - \mu} \in \ZZ $, a contradiction. Thus $ r_1, r_2 \in \ZZ $.
\item Suppose $ m_1 = m_2 = m $. From step $ 4 $, $ 2m = v - 1 $. From $ \br{\ref{eq:5}} $, $ \br{\lambda - \mu}\br{2m} = -2k $, so $ m\br{\mu - \lambda} = k $. Then $ m \mid k $. But $ 0 < k < v - 1 = 2m $, since $ \Gamma $ is not $ \K_v $ or $ \overline{\K_v} $, so $ k = m $, so $ \mu - \lambda = 1 $, so $ \lambda = \mu - 1 $. By \ref{prop:2.5},
$$ k\br{k - \lambda - 1} = \mu\br{v - k - 1} = \mu k, $$
since $ 2k = v - 1 $, so $ \mu = k - \lambda - 1 $. Thus $ k = \mu + \lambda + 1 = 2\mu $, and $ v = 2m + 1 = 4\mu + 1 $.
\end{itemize}
So step $ 5 $ holds.
\item Prove that $ r_1 \ne r_2 $. Suppose $ r_1 = r_2 $. Then
$$ 0 = D = \br{\lambda - \mu}^2 + 4\br{k - \mu} \ge 0, $$
since $ \mu \le k $, so $ \lambda = \mu = k $. But $ \lambda \le k - 1 $, a contradiction.
\item Prove that $ m_1, m_2 > 0 $. Suppose $ m_2 = 0 $. By step $ 4 $, $ m_1 = v - 1 $ and $ m_1r_1 = -k $. Then $ r_1 \in \QQ $. By the same argument in the proof of step $ 5 $, $ r_1 \in \ZZ $. Then $ m_1 \mid k $ so $ v - 1 \le k < v - 1 $, a contradiction.
\end{enumerate}
\ref{thm:2.7}.$ 1 $ holds by steps $ 1, 2, 3, 6, 7 $, \ref{thm:2.7}.$ 2 $ holds by steps $ 3 $ and $ 4 $, and \ref{thm:2.7}.$ 3 $ holds by step $ 5 $.
\end{proof}

\pagebreak

\subsubsection{Strongly regular graphs with small \texorpdfstring{$ v $}{v}}

A question is what are the possible parameters of $ \srg\br{15, k, \lambda, \mu} $?

\begin{example*}
\hfill
\begin{itemize}
\item $ \T\br{6} = \srg\br{15, 8, 4, 4} $.
\item $ \overline{\T\br{6}} = \srg\br{15, 6, 1, 3} $.
\item $ 3 \cdot \K_5 = \srg\br{15, 4, 3, 0} $.
\item $ 5 \cdot \K_3 = \srg\br{15, 2, 1, 0} $.
\item $ \K_{3\sbr{5}} = \srg\br{15, 10, 5, 10} $.
\item $ \K_{5\sbr{3}} = \srg\br{15, 12, 9, 12} $.
\end{itemize}
\end{example*}

\begin{proposition}
If $ \Gamma = \srg\br{15, k, \lambda, \mu} $ then the parameters of $ \Gamma $ are those of $ \T\br{6}, 3 \cdot \K_5, 5 \cdot \K_3 $ or their complements.
\end{proposition}

\begin{proof}
If $ k > 7 $, then the valency of $ \overline{\Gamma} $ is at most seven. Suppose $ k \le 7 $. If $ \mu = 0 $, then \ref{prop:2.2} implies that $ \Gamma $ is $ 3 \cdot \K_5 $ or $ 5 \cdot \K_3 $. Suppose $ \mu > 0 $, so $ \Gamma $ is connected of diameter two. Note that $ 2 \le k $. The following are the cases.
\begin{enumerate}[leftmargin=0.5in]
\item[$ k = 2 $.] $ \Gamma $ is a $ 15 $-gon, which is not diameter two.
\item[$ k = 3 $.] $ 3\br{2 - \lambda} = 11\mu $, a contradiction.
\item[$ k = 4 $.] $ 4\br{3 - \lambda} = 10\mu $, so $ 2\br{3 - \lambda} = 5\mu $, a contradiction.
\item[$ k = 5 $.] $ 5\br{4 - \lambda} = 9\mu $, a contradiction.
\item[$ k = 6 $.] $ 6\br{5 - \lambda} = 8\mu $, so $ 3\br{5 - \lambda} = 4\mu $, so $ 3 \mid \mu $ and $ 4 \mid \br{5 - \lambda} $, so $ \mu = 3 $ and $ \lambda = 1 $. Thus $ \br{15, 6, 1, 3} $ and $ \overline{\T\br{6}} $ has these parameters.
\item[$ k = 7 $.] $ 7\br{6 - \lambda} = 7\mu $, so $ 6 - \lambda = \mu $. Let $ r_1 $ and $ r_2 $ be the roots of
$$ x^2 - \br{\lambda - \mu}x - \br{k - \mu} = x^2 - \br{2\lambda - 6}x - \br{\lambda + 1}, $$
so
$$ r_1, r_2 = \lambda - 3 \pm \sqrt{\br{\lambda - 3}^2 + \lambda + 1} = \lambda - 3 \pm \sqrt{\lambda^2 - 5\lambda + 10}. $$
By \ref{thm:2.7}.$ 3 $, $ r_1, r_2 \in \ZZ $, since $ k $ is odd, so $ \sqrt{\lambda^2 - 5\lambda + 10} \in \ZZ $, and $ \lambda < k - 1 = 6 $, so $ \lambda = 2, 3 $. Let $ \lambda = 2 $. Then $ r_1, r_2 = 1, -3 $, so $ m_1 + m_2 = 14 $ and $ m_1 - 3m_2 = -7 $. Thus $ 4m_2 = 21 $, a contradiction, and $ \lambda = 3 $ is similar.
\end{enumerate}
\end{proof}

\subsection{Two weight codes}

\lecture{19}{Tuesday}{20/11/18}

\begin{definition*}
A linear code $ C \subseteq \ZZ_2^n $ is a \textbf{two weight code} if there exist $ w_1, w_2 \in \NN $ such that every non-zero codeword in $ C $ has weight $ w_1 $ or $ w_2 $.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item The extended Hamming code $ H' $ is a two weight code with non-zero weights four and eight.
\item $ C = \cbr{x \in \ZZ_2^5 \st \wt x \ \text{even}} $ is a two weight code with non-zero weights two and four.
\end{itemize}
\end{example*}

\begin{definition*}
For a non-zero linear code $ C \subseteq \ZZ_2^n $, a \textbf{generator matrix} for $ C $ is a $ k \times n $ matrix whose rows form a basis of $ C $ where $ k = \dim C $.
\end{definition*}

\pagebreak

\subsubsection{Macdonald codes}

\begin{definition*}
Let $ G $ be a matrix whose columns are vectors in $ \ZZ_2^k \setminus \cbr{0} $ where $ k \ge 1 $. A \textbf{simplex code} is a linear code $ C \subseteq \ZZ_2^n $ where $ n = 2^k - 1 $ with generator matrix $ G $.
\end{definition*}

\begin{fact*}
A simplex code of length $ 2^k - 1 $ for $ k \ge 1 $ has exactly one non-zero weight, namely $ 2^{k - 1} $. A typical non-zero element of $ C $ has the form $ xG $ where $ x \in \ZZ_2^k \setminus \cbr{0} $. Write $ G = \onebythree{y_1}{\dots}{y_n} $, so the columns are $ y_i $. Then $ xG = \onebythree{x \cdot y_1}{\dots}{x \cdot y_n} $. The weight of $ xG $ is the number of $ y_i $ such that $ x \cdot y_i = 1 $. By linear algebra, $ \cbr{y \in \ZZ_2^k \st x \cdot y = 0} $ is a subspace of $ \ZZ_2^k $ of dimension $ k - 1 $. Thus $ \wt xG = 2^k - 1 - \br{2^{k - 1} - 1} = 2^{k - 1} $.
\end{fact*}

\begin{definition*}
Let $ \overline{G} $ be a matrix whose columns are vectors in $ \ZZ_2^k \setminus \abr{e_{k - i + 1}, \dots, e_k} $ where $ 1 \le i < k $. A \textbf{Macdonald code} is a linear code of length $ 2^k - 2^i $ with generator matrix $ \overline{G} $.
\end{definition*}

By the fact above this code is a two weight code with weights $ 2^{k - 1} $ and $ 2^{k - 1} - 2^{i - 1} $.

\begin{example*}
Let $ k = 3 $, and
$$ G =
\begin{pmatrix}
1 & 1 & 1 & 0 & 1 & 0 & 0 \\
1 & 1 & 0 & 1 & 0 & 1 & 0 \\
1 & 0 & 1 & 1 & 0 & 0 & 1
\end{pmatrix}.
$$
The non-zero weight is four.
\begin{itemize}
\item Let $ i = 1 $. Removing $ \br{0, 0, 1}^\intercal $,
$$ \overline{G} =
\begin{pmatrix}
1 & 1 & 1 & 0 & 1 & 0 \\
1 & 1 & 0 & 1 & 0 & 1 \\
1 & 0 & 1 & 1 & 0 & 0
\end{pmatrix}.
$$
The non-zero weights are four and three.
\item Let $ i = 2 $. Removing $ \br{0, 0, 1}^\intercal, \br{0, 1, 0}^\intercal, \br{0, 1, 1}^\intercal $,
$$ \overline{G} =
\begin{pmatrix}
1 & 1 & 1 & 1 \\
1 & 1 & 0 & 0 \\
1 & 0 & 1 & 0
\end{pmatrix}.
$$
The non-zero weights are four and two.
\end{itemize}
\end{example*}

\subsubsection{Strongly regular graphs from two weight codes}

\begin{definition*}
A linear code $ C \subseteq \ZZ_2^n $ is \textbf{projective} if it has a generator matrix whose columns are non-zero and pairwise distinct.
\end{definition*}

\begin{theorem}[Delsarte]
\label{thm:2.11}
Let $ C \subseteq \ZZ_2^n $ be a linear two weight projective code, with weights $ w_1 $ and $ w_2 $ where $ w_1 < w_2 $. Let $ \Gamma\br{C} $ be the graph with vertex set $ C $ where $ x \sim y $ if $ \d\br{x, y} = \wt \br{x + y} = w_1 $. Then $ \Gamma\br{C} $ is strongly regular.
\end{theorem}

\begin{example*}
Let $ C = H', w_1 = 4, w_2 = 8 $. In $ \overline{\Gamma\br{C}} $, $ x \sim y $ if and only if $ x + y = 1^8 $. So $ \overline{\Gamma\br{C}} $ is
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1);
\fill (0.5, 0) circle (0.1);
\fill (1, 0) circle (0.1);
\fill (1.5, 0) circle (0.1);
\fill (2, 0) circle (0.1);
\fill (2.5, 0) circle (0.1);
\fill (3, 0) circle (0.1);
\fill (3.5, 0) circle (0.1);
\fill (4, 0) circle (0.1);
\fill (4.5, 0) circle (0.1);
\fill (5, 0) circle (0.1);
\fill (5.5, 0) circle (0.1);
\fill (6, 0) circle (0.1);
\fill (6.5, 0) circle (0.1);
\fill (7, 0) circle (0.1);
\fill (7.5, 0) circle (0.1);
\draw (0, 0) to (0.5, 0);
\draw (1, 0) to (1.5, 0);
\draw (2, 0) to (2.5, 0);
\draw (3, 0) to (3.5, 0);
\draw (4, 0) to (4.5, 0);
\draw (5, 0) to (5.5, 0);
\draw (6, 0) to (6.5, 0);
\draw (7, 0) to (7.5, 0);
\end{tikzpicture}.
$$
This is $ 8 \cdot \K_2 $. Thus $ \Gamma\br{C} = \K_{8\sbr{2}} $.
\end{example*}

\begin{proof}
Let $ k = \dim C $, and $ b_1 $ and $ b_2 $ be the number of codewords of weight $ w_1 $ and $ w_2 $ respectively. For $ i = 1, 2 $, let $ A_i $ be a $ b_i \times n $ matrix whose rows are codewords of weight $ w_i $. Let
$$ A = \twobyone{A_1}{A_2}, $$
a $ \br{b_1 + b_2} \times n $ matrix. Claim that each column of $ A $ has weight $ 2^{k - 1} $. Let
$$ \function[\phi_i]{C}{\ZZ_2}{\br{c_1, \dots, c_n}}{c_i}. $$

\pagebreak

Now $ \col i $ of $ A $ is not zero, since $ C $ is projective. So $ \im \phi_i = \ZZ_2 $. Thus $ \ker \phi_i $ has dimension $ k - 1 $. So $ \col i $ has $ 2^{k - 1} - 1 $ zeroes and $ 2^{k - 1} $ ones. Thus
$$ b_1 + b_2 = 2^k - 1, \qquad b_1w_1 + b_2w_2 = n2^{\br{k - 1}}, $$
which is the number of ones in $ A $. So we can compute $ b_1 $ and $ b_2 $ in terms of the given parameters, $ w_1, w_2, k, n $. Let $ i \le j \le n $. Let $ r_1 $ and $ r_2 $ be the number of zeroes in $ \col j $ of $ A_1 $ and $ A_2 $ respectively. Claim that $ r_1 $ and $ r_2 $ are independent of the choice $ j $. Let $ C' = \ker \phi_j $. This is a linear code of dimension $ k - 1 $ such that the $ j $-th entry is zero, with $ r_i $ codewords of weight $ w_i $ for $ i = 1, 2 $. In the matrix whose rows are elements of $ C $ the $ j $-th column is zero and all other columns are non-zero, since $ C $ is projective. Thus we can compute $ r_1 $ and $ r_2 $ as above,
$$ r_1 + r_2 = \abs{C'} - 1 = 2^{k - 1} - 1, \qquad r_1w_1 + r_2w_2 = \br{n - 1}2^{k - 2}. $$
Now each column of $ A_i $ has $ r_i $ zeroes. Let $ a_1, \dots, a_{b_1} $ be the rows of $ A_i $, the codewords in $ C $ of weight $ w_1 $. We can compute
$$ D = \sum_{i = 1}^{b_1} \d\br{a_i, a_1} = \br{n - w_1}\br{b_1 - r_1} + w_1r_1, $$
since reordering gives that
$$
\begin{array}{ccc}
a_1 & \overbrace{0 \qquad \dots \qquad 0}^{n - w_1} & \overbrace{1 \qquad \dots \qquad 1}^{w_1} \\
\begin{array}{c}
a_2 \\
\vdots \\
a_{b_1}
\end{array}
& \twobyone{\text{column has}}{b_1 - r_1 \ \text{ones}} & \twobyone{\text{column has}}{r_1 \ \text{zeroes}}
\end{array}.
$$
Let $ s_1 $ be the number of $ a_i $ such that $ \d\br{a_i, a_1} = w_1 $, and $ s_2 $ be the number of $ a_i $ such that $ \d\br{a_i, a_1} = w_2 $, so
$$ s_1 + s_2 = b_1 - 1, \qquad s_1w_1 + s_2w_2 = D. $$
We can compute $ s_1 $ in terms of $ n, k, w_1, w_2 $. Now consider the graph $ \Gamma\br{C} $. In this graph, neighbours of zero are $ a_1, \dots, a_{b_1} $. If $ x \in C $, then neighbours of $ x $ are $ x + a_1, \dots, x + a_{b_1} $, since
\begin{itemize}
\item $ \wt \br{x + xa_1} = \wt a_1 = w_1 $, so $ x + a_i \sim x $, and
\item if $ y \sim x $, then $ \wt \br{y + x} = w_1 $, so $ y + x = a_i $ for some $ i $,
\end{itemize}
so $ \Gamma\br{C} $ is regular of valency $ b_1 $. Then
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[left]{$ 0 $};
\fill (1, 0) circle (0.1) node[right]{$ a_1 $};
\draw (0.5, -1) circle (0.5) node{$ s_1 $};
\draw (0, 0) to (1, 0);
\draw (0, 0) to (0.3, -0.5);
\draw (1, 0) to (0.7, -0.5);
\end{tikzpicture}.
$$
Since $ a_1 $ was an arbitrary neighbour of zero, if $ 0 \sim c $ then zero and $ c $ have $ s_1 $ common neighbours. For an edge $ \cbr{x, y} $, there is a bijection
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above]{$ z $};
\fill (-0.5, -1) circle (0.1) node[left]{$ x $};
\fill (0.5, -1) circle (0.1) node[right]{$ y $};
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\end{tikzpicture}
\qquad
\begin{tikzpicture}
\draw (-1.5, -0.5) node{$ \to $};
\fill (0, 0) circle (0.1) node[above]{$ z + x $};
\fill (-0.5, -1) circle (0.1) node[left]{$ 0 $};
\fill (0.5, -1) circle (0.1) node[right]{$ x + y $};
\draw (0, 0) to (-0.5, -1);
\draw (0, 0) to (0.5, -1);
\draw (-0.5, -1) to (0.5, -1);
\end{tikzpicture}.
$$
Thus $ x $ and $ y $ also have $ s_1 $ common neighbours. Similarly, working with codewords of weight $ w_2 $, we get that the number of common neighbours of two non-adjacent vertices is constant.
\end{proof}

\lecture{20}{Tuesday}{20/11/18}

Lecture 20 is a problems class.

\pagebreak

\subsection{Automorphism group of a graph}

\lecture{21}{Wednesday}{21/11/18}

\begin{definition*}
Let $ \Gamma = \br{V, E} $ be a graph. The \textbf{automorphism group} of $ \Gamma $ is
$$ \Aut \Gamma = \cbr{\phi \in \Sym V \st \phi \ \text{is a graph isomorphism}} = \cbr{\phi \in \Sym V \st v \sim w \iff \phi\br{v} \sim \phi\br{w}}. $$
\end{definition*}

It is a subgroup of $ \Sym V $.

\begin{example*}
\hfill
\begin{itemize}
\item If $ \Gamma = \K_n $, so $ V = \cbr{1, \dots, n} $, then $ \Aut \Gamma = \SSS_n $.
\item If $ \Gamma = \overline{\K_n} $ then $ \Aut \overline{\Gamma} = \SSS_n $.
\item $ \Aut \Gamma = \Aut \overline{\Gamma} $ for all graphs $ \Gamma $. Sheet $ 3 $. \footnote{Exercise}
\item We may view $ \SSS_n $ as a subgroup of $ \Aut \T\br{n} $ where $ \T\br{n} $ is a triangular graph. Let $ \sigma \in \SSS_n $. Define
$$ \function[\phi_\sigma]{V\br{\T\br{n}}}{V\br{\T\br{n}}}{\cbr{i, j}}{\cbr{\sigma\br{i}, \sigma\br{j}}}, \qquad i, j \in \cbr{1, \dots, n}, \qquad i \ne j. $$
Check $ \phi_\sigma \in \Aut \T\br{n} $. \footnote{Exercise} Define
$$ \function[\phi]{\SSS_n}{\Aut \T\br{n}}{\sigma}{\phi_\sigma}. $$
Check this is a injective group homomorphism. \footnote{Exercise}
\begin{itemize}
\item Group homomorphism, since
$$ \phi_\sigma\phi_\tau = \phi_{\sigma\tau}, \qquad \sigma, \tau \in \SSS_n. $$
\item Injective. Suppose $ \phi_\sigma = \id $. Then
$$ \cbr{\sigma\br{i}, \sigma\br{j}} = \phi_\sigma\br{\cbr{i, j}} = \cbr{i, j}, \qquad \cbr{i, j} \in V\br{\T\br{n}}. $$
Claim that $ \sigma = 1 $, since $ \sigma\br{1} = 1, 2 $ and $ \sigma\br{1} = 1, 3 $, so $ \sigma\br{1} = 1 $, and similarly $ \sigma\br{i} = i $ for all $ i $.
\end{itemize}
\end{itemize}
\end{example*}

\pagebreak

\section{Designs}

\subsection{\texorpdfstring{$ t $}{t}-designs}

\begin{definition*}
A \textbf{$ t $-$ \br{v, k, r_t} $ design}, or \textbf{$ t $-design} with parameters $ \br{v, k, r_t} $, is a pair $ \br{X, \BBB} $ where
\begin{itemize}
\item $ X $ is a set of size $ V $, where its elements are called \textbf{points},
\item $ \BBB $ is a collection of $ k $-subsets of $ X $, where its elements are called \textbf{blocks}, and
\item every $ t $-subset of $ X $ lies in exactly $ r_t $ blocks.
\end{itemize}
Assume that $ X \ne \emptyset $, $ \BBB \ne \emptyset $, and $ v \ge k \ge t \ge 0 $. Say $ \br{X, \BBB} $ is \textbf{trivial} if $ \BBB $ is all the $ k $-subsets of $ X $. A $ 1 $-design is a \textbf{design}. Write $ r = r_1 $ and $ b = \abs{\BBB} $.
\end{definition*}

\begin{example*}
\hfill
\begin{itemize}
\item Octads of $ \G_{24} $ form a $ 5 $-$ \br{24, 8, 1} $ design.
\item The codewords of weight four in the extended Hamming code $ H' $ form a $ 3 $-$ \br{8, 4, 1} $ design. Sheet $ 4 $. \footnote{Exercise}
\item Let
$$ X = \ZZ_2^k \setminus \cbr{0}, \qquad \BBB = \cbr{\cbr{x, y, x + y} \st x, y \in X, \ x \ne y}, \qquad k \ge 3. $$
This is a $ 2 $-$ \br{2^k - 1, 3, 1} $ design. Sheet $ 4 $. \footnote{Exercise} When $ k = 3 $, this is the Fano plane
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above]{$ 1 $};
\fill (-0.5, -1) circle (0.1) node[left]{$ 2 $};
\fill (0.5, -1) circle (0.1) node[right]{$ 4 $};
\fill (0, -1.35) circle (0.1) node[below]{$ 7 $};
\fill (-1, -2) circle (0.1) node[left]{$ 3 $};
\fill (0, -2) circle (0.1) node[below]{$ 6 $};
\fill (1, -2) circle (0.1) node[right]{$ 5 $};
\draw (0, 0) to (-1, -2);
\draw (0, 0) to (0, -2);
\draw (0, 0) to (1, -2);
\draw (-0.5, -1) to (1, -2);
\draw (0.5, -1) to (-1, -2);
\draw (-1, -2) to (1, -2);
\draw (0, -1.35) circle (0.6);
\end{tikzpicture}.
$$
\end{itemize}
\end{example*}

Recall \ref{cor:1.24}.

\begin{proposition}
\label{prop:3.1}
A $ t $-$ \br{v, k, r_t} $ design is an $ s $-$ \br{v, k, r_s} $ design for all $ 0 \le s < t $ where
$$ r_s = \dfrac{\br{v - t + 1} \dots \br{v - s}}{\br{k - t + 1} \dots \br{k - s}}r_t. $$
\end{proposition}

\begin{corollary}
If there exists a $ t $-$ \br{v, k, r_t} $ design, then
$$ \br{k - t + 1} \dots \br{k - s} \mid \br{v - t + 1} \dots \br{v - s}r_t, \qquad 0 \le s < t. $$
\end{corollary}

\begin{example*}
\hfill
\begin{itemize}
\item Does there exist a $ 2 $-$ \br{56, 11, 1} $ design?
$$ r = r_1 = \dfrac{56 - 2 + 1}{11 - 2 + 1}\br{1} = \dfrac{55}{10} \notin \ZZ, $$
so no.
\item Does there exist a $ 2 $-$ \br{46, 10, 1} $ design?
$$ r = r_1 = \dfrac{46 - 2 + 1}{10 - 2 + 1}\br{1} = \dfrac{45}{9} = 5, \qquad b = r_0 = \dfrac{46}{10}\br{5} = 23. $$
So there is no contradiction. But no such design exists, see soon.
\end{itemize}
\end{example*}

\textbf{Existence conjecture} is that given $ t, k, r_t $, fixed, if divisibility conditions hold, is there a $ t $-$ \br{v, k, r_t} $ design for all but finitely many $ v $? Yes, by Keevash in 2014 and 2018.

\pagebreak

\subsection{Some theory of \texorpdfstring{$ 2 $}{2}-designs}

When $ \br{X, \BBB} $ is a $ 2 $-$ \br{v, k, r_2} $ design, write $ \lambda $ for $ r_2 $.

\begin{proposition}
For a $ 2 $-$ \br{v, k, \lambda} $ design,
$$ bk = vr, \qquad r\br{k - 1} = \lambda\br{v - 1}. $$
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}
\item In \ref{prop:3.1}, take $ s = 0 $ and $ t = 1 $, so $ b = r_0 = vr / k $.
\item In \ref{prop:3.1}, take $ s = 1 $ and $ t = 2 $, so $ r = r_1 = \lambda\br{v - 1} / \br{k - 1} $.
\end{itemize}
\end{proof}

The following is the first major result.

\begin{theorem}[Fisher's inequality]
\label{thm:3.4}
Suppose there exists a $ 2 $-$ \br{v, k, \lambda} $ design, where $ v > k $, that is more than one block. Then $ b \ge v $ and $ r \ge k $.
\end{theorem}

\lecture{22}{Tuesday}{27/11/18}

\begin{example*}
Does there exist a $ 2 $-$ \br{46, 10, 1} $ design? Saw that $ b = 23 < 46 = v $, a contradiction. So no.
\end{example*}

\subsubsection{Incidence matrices}

\begin{definition*}
Let $ \br{X, \BBB} $ be a $ 2 $-$ \br{v, k, \lambda} $ design. Let $ X = \cbr{x_1, \dots, x_v} $ and $ \BBB = \cbr{\B_1, \dots, \B_b} $. Then the \textbf{incidence matrix} of $ \br{X, B} $ is the matrix $ \br{a_{ij}} $ where
$$ a_{ij} =
\begin{cases}
1 & x_i \in \B_j \\
0 & x_i \notin \B_j
\end{cases}.
$$
\end{definition*}

So the incidence matrix $ A $ is indexed by $ x_i $ and $ \B_j $. Every column has $ k $ ones, and every row has $ r $ ones.

\begin{proposition}
\label{prop:3.5}
Let $ A $ be the incidence matrix of a $ 2 $-$ \br{v, k, \lambda} $ design. Then
$$ AA^\intercal = \threebythree{r}{}{\lambda}{}{\ddots}{}{\lambda}{}{r} = \lambda \J_v + \br{r - \lambda}\I_v, $$
a $ v \times v $ matrix.
\end{proposition}

\begin{proof}
$$ \br{AA^\intercal}_{ij} = A_{i\cdot} \cdot A_{j\cdot} = \abs{\cbr{B \in \BBB \st x_i \in B, \ x_j \in B}} =
\begin{cases}
r & i = j \\
\lambda & i \ne j
\end{cases}.
$$
\end{proof}

\begin{proposition}
For $ A $ as in \ref{prop:3.5},
$$ \det AA^\intercal = \br{r - \lambda}^{v - 1}\br{\lambda\br{v - 1} + r}. $$
\end{proposition}

\begin{proof}
\begin{align*}
\abs{\threebythree{r}{}{\lambda}{}{\ddots}{}{\lambda}{}{r}}
& = \abs{
\begin{pmatrix}
r & \lambda - r & \dots & \lambda - r \\
\lambda & r - \lambda & & 0 \\
\vdots & & \ddots & \\
\lambda & 0 & & r - \lambda \\
\end{pmatrix}
} & \text{subtract column one from all others} \\
& = \abs{
\begin{pmatrix}
r + \br{v - 1}\lambda & 0 & \dots & 0 \\
\lambda & r - \lambda & & 0 \\
\vdots & & \ddots & \\
\lambda & 0 & & r - \lambda \\
\end{pmatrix}
} & \text{add all other rows to row one} \\
& = \br{r - \lambda}^{v - 1}\br{\lambda\br{v - 1} + r}.
\end{align*}
\end{proof}

\pagebreak

\begin{proposition}
\label{prop:3.6}
Let $ C $ be an $ m \times n $ matrix and $ D $ an $ n \times r $ matrix. Then
$$ \rk CD \le \rk C, \qquad \rk CD \le \rk D. $$
\end{proposition}

\begin{proof}
Let $ D = \onebythree{d_1}{\dots}{d_r} $. Then $ \col\sp CD = \sp \br{Cd_1, \dots, Cd_r} \subseteq \col\sp C $. Similarly, $ \row\sp CD \subseteq \row\sp D $.
\end{proof}

\begin{proof}[Proof of \ref{thm:3.4}]
Since $ bk = vr $, suffices to show $ b \ge v $. Since $ \lambda\br{v - 1} = r\br{k - 1} $, the assumption $ v > k $ implies that $ r \ge \lambda $. By \ref{prop:3.6},
$$ \det AA^\intercal = \br{r - \lambda}^{v - 1}\br{\br{v - 1}\lambda + r} \ne 0, $$
so $ \rk AA^\intercal = v $. But $ A $ is $ v \times b $, so $ \rk A \le b $. Hence by \ref{prop:3.6}, $ v = \rk AA^\intercal \le \rk A \le b $.
\end{proof}

\subsubsection{Symmetric \texorpdfstring{$ 2 $}{2}-designs}

The extremal case of Fisher is $ b = v $, so $ k = r $.

\begin{definition*}
A $ 2 $-$ \br{v, k, \lambda} $ design is \textbf{symmetric} if $ b = v $.
\end{definition*}

\begin{example*}
Let
$$ X = \ZZ_2^3 \setminus \cbr{0}, \qquad \BBB = \cbr{\cbr{x, y, x + y} \st x, y \in X, \ x \ne y}. $$
This is a $ 2 $-$ \br{7, 3, 1} $ design. Then
$$ r = \dfrac{v - 1}{k - 1}\lambda = \dfrac{6}{2}\br{1} = 3 = k, $$
so symmetric, and $ b = v = 7 $. This is the Fano plane
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above]{$ 100 $};
\fill (-0.5, -1) circle (0.1) node[left]{$ 110 $};
\fill (0.5, -1) circle (0.1) node[right]{$ 101 $};
\fill (0, -1.35) circle (0.1) node[below]{$ 111 $};
\fill (-1, -2) circle (0.1) node[left]{$ 010 $};
\fill (0, -2) circle (0.1) node[below]{$ 011 $};
\fill (1, -2) circle (0.1) node[right]{$ 001 $};
\draw (0, 0) to (-1, -2);
\draw (0, 0) to (0, -2);
\draw (0, 0) to (1, -2);
\draw (-0.5, -1) to (1, -2);
\draw (0.5, -1) to (-1, -2);
\draw (-1, -2) to (1, -2);
\draw (0, -1.35) circle (0.6);
\end{tikzpicture}.
$$
\end{example*}

\begin{note*}
This is the smallest example of a projective plane.
\end{note*}

\begin{definition*}
A \textbf{projective plane} is a symmetric $ 2 $-$ \br{v, k, 1} $ design where $ k \ge 3 $.
\end{definition*}

\begin{theorem}
\label{thm:3.8}
In a symmetric $ 2 $-$ \br{v, k, \lambda} $ design, if $ v $ is even, then $ k - \lambda $ is a square.
\end{theorem}

\begin{example*}
Does there exist a $ 2 $-$ \br{22, 7, 2} $ design?
$$ r = \dfrac{v - 1}{k - 1}\lambda = \dfrac{21}{6}\br{2} = 7 = k, $$
so design is symmetric and $ b = v = 22 $ is even, but $ k - \lambda = 7 - 2 = 5 $ is not a square, so no by \ref{thm:3.8}.
\end{example*}

\begin{proof}
As $ b = v $, the incidence matrix $ A $ is $ v \times v $, a square. So $ \det A $ exists and $ \det A = \det A^\intercal $. Then $ \det AA^\intercal = \det A\det A^\intercal = \det A^2 $. By \ref{prop:3.5},
$$ \det A^2 = \br{r - \lambda}^{v - 1}\br{\lambda\br{v - 1} + r}. $$
Now $ \lambda\br{r - 1} = r\br{k - 1} = k\br{k - 1} $. Then
$$ \det A^2 = \br{r - \lambda}^{v - 1}k^2. $$
The right hand side is the square of an integer, so $ \br{r - \lambda}^{v - 1} $ is a square, but $ v - 1 $ is odd so $ r - \lambda = k - \lambda $ is a square.
\end{proof}

\begin{note*}
If $ v $ is odd, then the \textbf{Bruck-Ryser-Chowla theorem} gives another necessary condition for the existence of a $ 2 $-$ \br{v, k, \lambda} $ design. The Diophantine equation
$$ z^2 = \br{k - \lambda}x^2 + \br{-1}^{\tfrac{v - 1}{2}}\lambda y^2 $$
has a solution $ x, y, z \in \ZZ $, not all zero. Various proofs, by linear algebra and number theory.
\end{note*}

\pagebreak

\begin{theorem}
\label{thm:3.9}
In a symmetric $ 2 $-$ \br{v, k, \lambda} $ design, any two distinct blocks intersect in $ \lambda $ points.
\end{theorem}

\begin{example*}
\hfill
\begin{itemize}
\item In the Fano plane, any two lines meet in one point.
\item In a projective plane, any two blocks, or \textbf{lines}, intersect in one point. In fact, projective planes are usually defined using the axioms, a set of points and a set of lines such that
\begin{itemize}
\item any two points lie on a unique line,
\item any two lines meet in a unique point, and
\item there exist four points, no three of which lie on a line.
\end{itemize}
\end{itemize}
\end{example*}

\lecture{23}{Tuesday}{27/11/18}

\begin{proof}[Proof of \ref{thm:3.9}]
By \ref{prop:3.5},
\begin{equation}
\label{eq:6}
AA^\intercal = \lambda\J = \br{k - \lambda}\I = \threebythree{k}{}{\lambda}{}{\ddots}{}{\lambda}{}{k}.
\end{equation}
Considering $ A^\intercal A $,
$$ \br{A^\intercal A}_{ij} = A_{i\cdot}^\intercal A_{\cdot j} = A_{\cdot i} \cdot A_{\cdot j} = \abs{\B_i \cap \B_j}. $$
If $ A^\intercal A = AA^\intercal $, then $ \abs{\B_i \cap \B_j} = \lambda $ when $ i \ne j $. Show $ A^\intercal A = AA^\intercal $.
\begin{itemize}
\item $ A $ is a square matrix, so $ \det A $ exists.
\item As before, we saw $ \det A^2 = \br{r - \lambda}^{v - 1}\br{\lambda\br{v - 1} + r} $. If $ r = \lambda $, then $ r = \lambda = k = v $, by standard equations, so $ v = b = 1 $, but $ v \ge 2 $, a contradiction.
\item Thus $ \det A \ne 0 $, so $ A $ is invertible.
\item $ A\J = r\J $ and $ \J A = k\J $. So $ A\J = \J A $.
\item By $ \br{\ref{eq:6}} $, $ A $ commutes with $ AA^\intercal $, that is $ A\br{AA^\intercal} = \br{AA^\intercal}A $. Multiply on the left by $ A^{-1} $ to get $ AA^\intercal = A^\intercal A $.
\end{itemize}
\end{proof}

\begin{note*}
A converse to \ref{thm:3.9} exists. A $ 2 $-$ \br{v, k, \lambda} $ design with $ v > k $ and the property that any two blocks meet in $ \lambda $ points is symmetric. Sheet $ 4 $. \footnote{Exercise}
\end{note*}

\subsection{Automorphism group of a design}

\subsubsection{Isomorphisms of designs}

\begin{definition*}
Designs $ \br{X_1, \BBB_1} $ and $ \br{X_2, \BBB_2} $ are \textbf{isomorphic} if there exists a bijection $ \phi : X_1 \to X_2 $ such that $ \phi\br{\BBB_1} = \BBB_2 $, where
$$ \phi\br{\BBB_1} = \cbr{\phi\br{B} \st B \in \BBB_1}, \qquad \phi\br{B} = \cbr{\phi\br{b} \st b \in B}, \qquad B \in \BBB_1. $$
\end{definition*}

\begin{note*}
Isomorphic designs have the same parameters, but the converse need not be true.
\end{note*}

\begin{example*}
Let
$$ X = \ZZ_7, \qquad \BBB_1 = \cbr{013 + i \st i \in \ZZ_7}, \qquad X = \ZZ_2^3 \setminus \cbr{0}, \qquad \BBB_2 = \cbr{\cbr{x, y, x + y} \st x, y \in X_2, \ x \ne y}, $$
which are $ 2 $-$ \br{7, 3, 1} $. Is $ \br{X_1, \BBB_1} \cong \br{X_2, \BBB_2} $?
The answer is yes. Want a bijection $ X_1 \to X_2 $, where
$$ 013 \mapsto \cbr{100, 010, 110}, \qquad 124 \mapsto \cbr{010, 001, 011}. $$

\pagebreak

The rest is forced, so
$$ 235 \mapsto \cbr{001, 110, 111} \qquad 346 \mapsto \cbr{110, 011, 101} \qquad 450 \mapsto \cbr{011, 111, 100} $$
$$ 561 \mapsto \cbr{111, 101, 010} \qquad 602 \mapsto \cbr{101, 100, 001}. $$
Have an isomorphism
$$ 0 \mapsto 100, \qquad 1 \mapsto 010, \qquad 2 \mapsto 001, \qquad 3 \mapsto 110, \qquad 4 \mapsto 011, \qquad 5 \mapsto 111, \qquad 6 \mapsto 101. $$
In fact send
$$ 0 \mapsto x, \qquad 1 \mapsto y, \qquad 2 \mapsto z, \qquad x \ne y, \qquad z \notin \cbr{x, y, x + y}. $$
Then get an isomorphism. There are $ 7 \cdot 6 \cdot 4 = 168 $ possible isomorphisms.
\end{example*}

\subsubsection{Automorphisms of designs}

\begin{definition*}
Let $ \DDD = \br{X, \BBB} $ be a design. The \textbf{automorphism group} of $ \DDD $ is
$$ \Aut \DDD = \cbr{\phi \in \Sym X \st \phi\br{\BBB} = \BBB}. $$
\end{definition*}

Prove $ \Aut \DDD $ is a subgroup of $ \Sym X $. Sheet $ 4 $. \footnote{Exercise}

\begin{example*}
\hfill
\begin{itemize}
\item Let $ \DDD $ be a trivial design, so $ \BBB $ is the $ k $-subsets of $ X $. Then $ \Aut \DDD = \Sym X $.
\item $ \Aut \DDD = \GL_3\br{\ZZ_2} $ where $ \DDD $ is the design from the last example.
\end{itemize}
\end{example*}

\subsection{Constructions of \texorpdfstring{$ 2 $}{2}-designs}

\subsubsection{Difference sets}

\begin{example*}
Let
$$ X = \ZZ_7 = \cbr{0, \dots, 6}, \qquad \B_0 = \cbr{0, 1, 3}. $$
Use $ \B_0 $ to define seven blocks
$$ \B_i = \B_0 + i = \cbr{x + i \st x \in \B_0}, \qquad 0 \le i \le 6. $$
Let $ \BBB = \cbr{\B_i \st i \in \ZZ_7} $. The blocks are $ 013, 124, 235, 346, 450, 561, 602 $. Claim that $ \br{X, \BBB} $ forms a $ 2 $-$ \br{7, 3, 1} $ design. Consider $ \B_0 = \cbr{0, 1, 3} $. The differences $ a - b $ where $ \br{a, b} \in \B_0 $ and $ a \ne b $ are
$$ 0 - 1 = 6, \qquad 0 - 3 = 4, \qquad 1 - 0 = 1, \qquad 1 - 3 = 5, \qquad 3 - 0 = 3, \qquad 3 - 1 = 2. $$
So the differences are $ 1, \dots, 6 $, and each occurs exactly once, so the claim holds by the statement below.
\end{example*}

\begin{definition*}
Let $ \lambda, v \in \NN $. Let
$$ \emptyset \ne \B_0 \subseteq \ZZ_v = \cbr{0, \dots, v - 1}. $$
Say $ \B_0 $ is a \textbf{$ \lambda $-difference set} if for all $ d \in \ZZ_v^* $, there exist exactly $ \lambda $ pairs $ \br{a, b} $ such that $ a - b = d $.
\end{definition*}

$ \lambda = 1 $ implies that $ \abs{\B_0} \ge 2 $.

\begin{proposition}
Let $ X = \ZZ_v $ and $ \B_0 \subseteq \ZZ_v $ be a $ \lambda $-difference set with $ \B_0 = k $. Let
$$ \BBB = \cbr{\B_0 + i \st i \in \ZZ_v}. $$
Then $ \br{X, \BBB} $ is a $ 2 $-$ \br{v, k, \lambda} $ design that is symmetric.
\end{proposition}

\begin{proof}
Let $ r, s \in \ZZ_v $ for $ r \ne s $. Then $ r, s \in \B_0 + i $ if and only if $ r - i, s - i \in \B_0 $. The number of such $ i $ is the number of pairs $ \br{a, b} $ with $ a, b \in \B_0 $ and $ a - b = r - s $. This equals $ \lambda $. Thus $ r $ and $ s $ lie in exactly $ \lambda $ blocks.
\end{proof}

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item Let
$$ X = \ZZ_{11}, \qquad \BBB = \cbr{x^2 \st x \in \ZZ_{11}^*} = \cbr{1, 4, 9, 5, 3}. $$
The differences $ a - b $, where there are $ 20 $ of them, each occurs twice. So
$$ \br{X, \cbr{\B_0, \dots, \B_0 + 10}} $$
is a $ 2 $-$ \br{11, 5, 2} $ design, which is symmetric.
\item Let
$$ X = \ZZ_{13}, \qquad \BBB = \cbr{0, 1, 3, 9}. $$
This is a $ 1 $-difference set, so get a $ 2 $-$ \br{13, 4, 1} $ design.
\end{itemize}
\end{example*}

The following is a family. Let $ p $ be an odd prime and $ Q = \cbr{x^2 \st x \in \ZZ_p^*} $. Seen $ Q $ is a subgroup of $ \br{\ZZ_p^*, \times} $ of order $ \br{p - 1} / 2 $.

\begin{proposition}
If $ p \equiv 3 \mod 4 $, then $ Q $ is a $ \lambda $-difference set where $ \lambda = \br{p - 3} / 4 $, so get a symmetric $ 2 $-$ \br{p, \br{p - 1} / 2, \br{p - 3} / 4} $ design.
\end{proposition}

\begin{example*}
$ p = 7 $ and $ p = 11 $ is in the examples above. The next $ p $ is $ 19 $, so parameters are $ \br{19, 9, 4} $.
\end{example*}

\begin{proof}
Since $ p \equiv 3 \mod 4 $, $ \abs{Q} = \br{p - 1} / 2 $ is odd. Since $ -1 \in \ZZ_p^* $ has order two, the cosets of $ Q $ in $ \br{\ZZ_p^*, \times} $ are $ Q $ and $ \br{-1}Q = -Q $. So $ \ZZ_p^* = Q \cup -Q $. For $ q \in \ZZ_p^* $, define
$$ S_q = \cbr{\br{a, b} \st a, b \in Q, \ a - b = q}. $$
\begin{itemize}
\item $ a - b = q $ if and only if $ ra - rb = rq $. So $ \br{a, b} \in S_q $ if and only if $ \br{ra, rb} \in S_q $. Thus $ \abs{S_q} = \abs{S_{rq}} $ for all $ r \in Q $ and $ q \in \ZZ_p^* $. In particular, $ \abs{S_q} $ is constant for $ q \in Q $.
\item Now $ \br{a, b} \in S_q $ if and only if $ \br{b, a} \in S_{-q} $ so $ \abs{S_q} = \abs{S_{-q}} $ for all $ q \in \ZZ_p^* $. Since $ Q \cup \br{-Q} = \ZZ_p^* $, $ \abs{S_q} $ is constant for $ q \in \ZZ_p^* $.
\end{itemize}
Thus $ Q $ is a $ \lambda $-difference set for some $ \lambda $. To find $ \lambda $, the number of ordered pairs $ \br{a, b} $ for $ a, b \in Q $ and $ a \ne b $ is $ \abs{Q}\br{\abs{Q} - 1} $. Also equals $ \lambda\br{p - 1} $. Since $ \abs{Q} = \br{p - 1} / 2 $, $ \lambda = \br{p - 3} / 4 $.
\end{proof}

\subsubsection{Affine planes}

Let the \textbf{Euclidean plane} be $ \RR^2 $. We define the points as vectors in $ \RR^2 $, and the blocks as straight lines, by Cartesian equations
$$ y = mx + c, \qquad x = d, $$
or by vector equations
$$ \cbr{v + \lambda w \st \lambda \in \RR} = v + \sp w, \qquad w \ne 0. $$
Any two points lie on a unique line, since points are $ x $ and $ y $ implies that the line is $ x + \sp \br{y - x} $. This is naturally an infinite $ 2 $-design. To make a finite $ 2 $-design, we replace $ \RR $ by any finite field $ F $, such as $ \ZZ_p $. The points are vectors in $ F^2 = \cbr{\br{a, b} \st a, b \in F} $, the vector space over $ F $ with basis $ \br{1, 0} $ and $ \br{0, 1} $, and the blocks, or lines, are sets of the form
$$ v + \sp w, \qquad v, w \in F^2, \qquad w \ne 0. $$

\begin{note*}
\hfill
\begin{itemize}
\item There are $ q^2 $ points where $ \abs{F} = q $. A fact is that $ q $ is a power of a prime.
\item The lines are solution sets of equations $ y = mx + c $ if and only if the line is $ \br{0, c} + \sp \br{1, m} $.
\item The lines are solution sets of equations $ x = d $ if and only if the line is $ \br{d, 0} + \sp \br{0, 1} $.
\end{itemize}
\end{note*}

\pagebreak

\lecture{24}{Wednesday}{28/11/18}

\begin{example*}
Let $ F = \ZZ_3 $. There are nine lines $ y = mx + c $ and $ x = d $.
\begin{itemize}
\item $ y = x $ is
$$ \cbr{\br{0, 0}, \br{1, 1}, \br{2, 2}} = \sp \br{1, 1}. $$
\item $ y = x + 1 $ is
$$ \cbr{\br{0, 1}, \br{1, 2}, \br{2, 0}} = \br{0, 1} + \sp \br{1, 1}. $$
\item $ x = 1 $ is
$$ \cbr{\br{1, 0}, \br{1, 1}, \br{1, 2}} = \br{1, 0} + \sp \br{0, 1}. $$
\end{itemize}
\end{example*}

\begin{proposition}
\hfill
\begin{enumerate}
\item Every line has $ q $ points.
\item Two points lie in a unique line.
\end{enumerate}
Hence, if $ \LLL $ is the set of lines, then $ \br{F^2, \LLL} $ is a $ 2 $-$ \br{q^2, q, 1} $ design.
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item A line has the form
$$ v + \sp w = \cbr{v + \lambda w \st \lambda \in F}, \qquad w \ne 0. $$
This has size $ q $ since $ \abs{F} = q $.
\item Let $ a, b \in F^2 $ where $ a \ne b $. Then $ a $ and $ b $ are in the line
$$ L = a + \sp \br{b - a} = \cbr{a + \lambda\br{b - a} \st \lambda \in F}. $$
Suppose $ L' $ is a line on $ a $ and $ b $, so
$$ L' = v + \sp w, \qquad v, w \in F^2, \qquad w \ne 0. $$
Then $ a = v + \lambda_1w $ and $ b = v + \lambda_2w $ for some $ \lambda_1, \lambda_2 \in F $. Note that $ \lambda_1 \ne \lambda_2 $. Then $ b - a = \br{\lambda_2 - \lambda_1}w $, so
$$ L = \cbr{a + \lambda\br{b - a} \st \lambda \in F} = \cbr{\br{v + \lambda_1w} + \lambda\br{\lambda_2 - \lambda_1}w \st \lambda \in F} = v + \sp w = L'. $$
\end{enumerate}
\end{proof}

\begin{definition*}
The $ 2 $-$ \br{q^2, q, 1} $ design $ \br{F^2, \LLL} $ is the \textbf{affine plane over $ F $}, denoted by $ \AG\br{2, F} $.
\end{definition*}

Thus any two lines meet in zero or one point. Call two lines \textbf{parallel} if they meet in zero points.

\begin{example*}
$ y = mx + c $ and $ y = mx + d $ where $ c \ne d $ are parallel.
\end{example*}

\begin{proposition}
$ \AG\br{2, F} $ has $ q^2 + q $ lines, where $ q = \abs{F} $. They fall into $ q + 1 $ pairwise disjoint sets of size $ q $, each consisting of parallel lines.
\end{proposition}

\begin{proof}
The $ q + 1 $ sets are
$$ \LLL_m = \cbr{y = mx + c \st c \in F}, \qquad m \in F, \qquad \LLL_\infty = \cbr{x = d \st d \in F}. $$
Each set contains $ q $ parallel lines.
\end{proof}

\begin{definition*}
The sets $ \LLL_m $ for $ m \in F \cup \cbr{\infty} $ are called \textbf{parallel classes} of lines.
\end{definition*}

\begin{proposition}
\label{prop:3.14}
Each point in $ F^2 $ lies on exactly one line in each parallel class.
\end{proposition}

\begin{proof}
Each parallel class contains $ q $ pairwise disjoint lines. Each line has $ q $ points. This accounts for $ q^2 = \abs{F^2} $ points.
\end{proof}

\pagebreak

\subsubsection{Projective planes}

Recall that a projective plane is a symmetric $ 2 $-$ \br{v, k, 1} $ design with $ k \ge 3 $.
\begin{itemize}
\item Any two points lie on a unique line.
\item Any two lines meet in a unique point, by \ref{thm:3.9}.
\end{itemize}
We can extend $ \AG\br{2, F} $ to get a projective plane.

\begin{example*}
In $ \AG\br{2, \ZZ_3} $, there are four parallel classes of lines $ \LLL_0, \LLL_1, \LLL_2, \LLL_\infty $. For each parallel class, add a new point $ p_m $ to the lines in $ \LLL_m $ where $ m \in F \cup \cbr{\infty} $. Now we have the $ 13 $ points
$$ p \in F^2, \qquad p_0, \qquad p_1, \qquad p_2, \qquad p_\infty. $$
We have the $ 12 $ lines
$$ \br{y = x} \cup \cbr{p_0} = \cbr{00, 11, 22, p_0}, \qquad \br{y = x + 1} \cup \cbr{p_1} = \cbr{01, 12, 20, p_1}, \qquad \dots. $$
Add one more line
$$ l_\infty = \cbr{p_0, p_1, p_2, p_\infty}. $$
Now we have $ 13 $ points and $ 13 $ lines. These form the projective plane over $ \ZZ_3 $,
$$
\begin{tikzpicture}
\fill (4, -0.5) circle (0.1) node[right]{$ p_0 $};
\draw (0, 0) to [bend left=15] (4, -0.5);
\draw (0, -0.5) node[left]{$ \LLL_0 $} to (4, -0.5);
\draw (0, -1) to [bend right=15] (4, -0.5);
\fill (2, 1.5) circle (0.1) node[above]{$ p_1 $};
\draw (1.5, -2.5) to [bend left=15] (2, 1.5);
\draw (2, -2.5) node[below]{$ \LLL_1 $} to (2, 1.5);
\draw (2.5, -2.5) to [bend right=15] (2, 1.5);
\fill (3.5, 1) circle (0.1) node[above right]{$ p_2 $};
\draw (0, -1.5) to [bend left=15] (3.5, 1);
\draw (0.5, -2) node[below left]{$ \LLL_2 $} to (3.5, 1);
\draw (1, -2.5) to [bend right=15] (3.5, 1);
\fill (0.5, 1) circle (0.1) node[above left]{$ p_\infty $};
\draw (3, -2.5) to [bend left=15] (0.5, 1);
\draw (3.5, -2) node[below right]{$ \LLL_\infty $} to (0.5, 1);
\draw (4, -1.5) to [bend right=15] (0.5, 1);
\draw (4, -0.5) arc (0:150:2);
\draw (4, -0.5) arc (-180:-150:2) node[right]{$ l_\infty $};
\end{tikzpicture}.
$$
\end{example*}

\begin{definition*}
In general, for a finite field $ F $ for $ \abs{F} = q $,
\begin{itemize}
\item start with $ \AG\br{2, F} $, points $ F^2 $, and lines $ y = mx + c $ and $ x = d $,
\item add $ q + 1 $ new points $ p_m $ for $ m \in F \cup \cbr{\infty} $,
\item to each line in $ \LLL_m $, add the point $ p_m $ for $ m \in F \cup \cbr{\infty} $, and
\item add one more line $ l_\infty = \cbr{p_m \st m \in F \cup \cbr{\infty}} $, the \textbf{line at infinity}.
\end{itemize}
Now have $ q^2 + q + 1 $ points,
$$ F^2, \qquad p_m, \qquad m \in F \cup \cbr{\infty}, $$
and $ q^2 + q + 1 $ lines,
$$ l \in \AG\br{2, F}, \qquad l_\infty. $$
This is the \textbf{projective plane over $ F $}, denoted by $ \PG\br{2, F} $.
\end{definition*}

\begin{proposition}
$ \PG\br{2, F} $ is a symmetric $ 2 $-$ \br{q^2 + q + 1, q + 1, 1} $ design, so is actually a projective plane.
\end{proposition}

\begin{proof}
Need to show that any two points lie on a unique line. Let $ x $ and $ y $ be points of $ \PG\br{2, F} $ where $ x \ne y $.
\begin{itemize}
\item Suppose $ x, y \in F^2 $. Then the unique line on $ x $ and $ y $ is the unique line $ x + \sp \br{y - x} $ from $ \AG\br{2, F} $.
\item Suppose $ x \in F^2 $ and $ y = p_m $ for some $ m \in F \cup \cbr{\infty} $. Then $ x $ lies on a unique line in the parallel class $ \LLL_m $, by \ref{prop:3.14}, say $ l $, and $ l \cup \cbr{\infty} $ is the unique line on $ x $ and $ y $.
\item Suppose $ x = p_{m_1} $ and $ y = p_{m_2} $ for some $ m_1, m_2 \in F \cup \cbr{\infty} $. Then $ l_\infty $ is the unique line on $ x $ and $ y $.
\end{itemize}
\end{proof}

\pagebreak

\subsubsection{More on projective planes}

\lecture{25}{Tuesday}{04/12/18}

Recall the axioms.
\begin{itemize}
\item Two points are on a unique line.
\item Two lines intersect in a unique point.
\item There exist four points, no three of which are collinear.
\end{itemize}
Sheet $ 4 $ implies that a projective plane defined by these axioms is equivalent to a $ 2 $-$ \br{n^2 + n + 1, n + 1, 1} $ design where $ n > 1 $. \footnote{Exercise} Call this the \textbf{projective plane} of \textbf{order} $ n $.

\begin{example*}
\hfill
\begin{itemize}
\item The Fano plane is the projective plane of order two.
\item $ \PG\br{2, F} $ is a projective plane over a field $ F $, and $ \abs{F} = q $ where $ q $ is a power of a prime $ p $, which is a $ 2 $-$ \br{q^2 + q + 1, q + 1, 1} $ design. So $ \PG\br{2, F} $ has order $ q $.
\end{itemize}
\end{example*}

\begin{note*}
There exist other projective planes. The smallest has order nine.
\end{note*}

Take triangles $ ABC $ and $ A'B'C' $, so
$$
\begin{tikzpicture}
\fill (0, 0) circle (0.1) node[above left]{$ A $};
\fill (1, -1) circle (0.1) node[above right]{$ B $};
\fill (1, -2) circle (0.1) node[below left]{$ C $};
\draw (0, 0) to (1, -2);
\draw (0, 0) to (1, -1);
\draw (1, -1) to (1, -2);
\fill (3, -0.5) circle (0.1) node[above right]{$ A' $};
\fill (3, -1) circle (0.1) node[below right]{$ B' $};
\fill (2.5, -1.75) circle (0.1) node[below right]{$ C' $};
\draw (3, -0.5) to (2.5, -1.75);
\draw (3, -0.5) to (3, -1);
\draw (3, -1) to (2.5, -1.75);
\fill (6, -1) circle (0.1) node[right]{$ D $};
\draw [dashed] (0, 0) to (6, -1);
\draw [dashed] (1, -1) to (6, -1);
\draw [dashed] (1, -2) to (6, -1);
\fill (1, -4) circle (0.1) node[below right]{$ P $};
\draw [dashed] (1, -2) to (1, -4);
\draw [dashed] (2.5, -1.75) to (1, -4);
\fill (1.8, -3.6) circle (0.1) node[below right]{$ Q $};
\draw [dashed] (1, -2) to (1.8, -3.6);
\draw [dashed] (2.5, -1.75) to (1.8, -3.6);
\fill (3, -3) circle (0.1) node[below right]{$ R $};
\draw [dashed] (1, -1) to (3, -3);
\draw [dashed] (3, -1) to (3, -3);
\draw [dashed, thick] (1, -4) to (3, -3);
\end{tikzpicture}.
$$
\textbf{Desargues condition} is that $ AA', BB', CC' $ all meet in a point if and only if $ P, Q, R $ are collinear.
\begin{itemize}
\item \textbf{Desargues theorem} is that $ \PG\br{2, F} $ for $ F $ a finite field satisfies this condition. Conversely, any finite projective plane satisfying this condition is isomorphic to $ \PG\br{2, F} $ for some finite field $ F $. Call the projective planes $ \PG\br{2, F} $ \textbf{Desarguesian}.
\item There exist \textbf{non-Desarguesian} projective planes, but they all have order a prime power. A question is do all finite projective planes have order a prime power? A corollary of Bruck-Ryser-Chowla is that if a projective plane of order $ n $ exists where $ n \equiv 1 \mod 4 $ or $ n \equiv 2 \mod 4 $, then $ n $ is a sum of squares. Bruck-Ryser-Chowla implies that for a symmetric $ 2 $-$ \br{v, k, \lambda} $ design for $ v $ odd,
$$ z^2 = \br{k - \lambda}x^2 + \br{-1}^{\tfrac{v - 1}{2}}\lambda y^2 $$
has an integer solution. Then $ v = n^2 + n + 1 $ is odd, and $ n \equiv 1, 2 \mod 4 $ implies that $ v \equiv 3 \mod 4 $. So $ z^2 = nx^2 - y^2 $. So $ nx^2 = z^2 + y^2 $. Thus $ n = \br{z / x}^2 + \br{y / x}^2 $, so $ n = a^2 + b^2 $ where $ a, b \in \ZZ $, by number theory.
\end{itemize}

\begin{example*}
Say $ n $ is not a prime power.
\begin{itemize}
\item $ n = 6 \equiv 2 \mod 4 $ is not a sum of squares. Thus no projective plane of order six.
\item $ n = 10 \equiv 2 \mod 4 $ but $ 10 = 1 + 9 $ so cannot use theorem. No such projective plane exists by a massive computer computation.
\item $ n = 12 $ is unknown.
\end{itemize}
\end{example*}

\pagebreak

\subsubsection{Higher-dimensional geometry}

Let $ F $ be a finite field. Define
$$ F^n = \cbr{\br{x_1, \dots, x_n} \st x_i \in F}. $$
This is a vector space over $ F $ of dimension $ n $, and $ \abs{F^n} = q^n $ where $ q = \abs{F} $.

\begin{definition*}
For $ 1 \le m \le n $, define the \textbf{$ q $-binomial coefficients}
$$ \binom{n}{m}_q = \dfrac{\br{q^n - 1} \dots \br{q^{n - m + 1}}}{\br{q^m - 1} \dots \br{q - 1}}. $$
\end{definition*}

\begin{example*}
$$ \binom{n}{1}_q = \dfrac{q^n - 1}{q - 1}, \qquad \binom{4}{2}_2 = \dfrac{\br{2^4 - 1}\br{2^3 - 1}}{\br{2^2 - 1}\br{2 - 1}} = \dfrac{15 \cdot 7}{3 \cdot 1} = 35, \qquad \binom{2}{1}_q = q + 1. $$
\end{example*}

\lecture{26}{Tuesday}{04/12/18}

Lecture 26 is a problems class.

\lecture{27}{Wednesday}{05/12/18}

\begin{proposition}
\label{prop:3.16}
Let $ 1 \le m \le n - 1 $, $ F $ be a field, and $ \abs{F} = q $.
\begin{enumerate}
\item The number of $ m $-dimensional subspaces of $ F^n $ is $ \binom{n}{m}_q $.
\item If $ 0 \ne v \in F^n $, then the number of $ m $-dimensional subspaces of $ F^n $ containing $ v $ is
$$
\begin{cases}
1 & m = 1 \\
\binom{n - 1}{m - 1}_q & m \ge 2
\end{cases}.
$$
\item If $ v, w \in F^n $ are linearly independent and $ m \ge 2 $, then the number of $ m $-dimensional subspaces of $ F^n $ containing $ v $ and $ w $ is
$$
\begin{cases}
1 & m = 2 \\
\binom{n - 2}{m - 2}_q & m > 2
\end{cases}.
$$
\end{enumerate}
\end{proposition}

The proof is later. Now define a design as follows. Let $ n \ge 2 $ and $ 1 \le m \le n - 1 $. The points are vectors in $ F^n $, and the blocks are subsets of the form
$$ v + W = \cbr{v + w \st w \in W}, \qquad v \in F^n, $$
and $ W $ is any $ m $-dimensional subspace of $ F^n $.

\begin{example*}
Let $ n = 2 $ and $ m = 1 $. The points are vectors in $ F^2 $, and the blocks are subsets of the form
$$ v + \sp w, \qquad v, w \in F^2, \qquad w \ne 0. $$
This is $ \AG\br{2, F} $.
\end{example*}

\begin{proposition}
\label{prop:3.17}
\hfill
\begin{enumerate}
\item This is a $ 2 $-$ \br{q^n, q^m, \lambda} $ design where
$$ \lambda =
\begin{cases}
1 & m = 1 \\
\binom{n - 1}{m - 1}_q & m \ge 2
\end{cases}.
$$
\item If $ F = \ZZ_2 $ and $ m \ge 2 $, then this is a $ 3 $-$ \br{2^n, 2^m, r_3} $ design where
$$ r_3 =
\begin{cases}
1 & m = 2 \\
\binom{n - 2}{m - 2}_2 & m > 2
\end{cases}.
$$
\end{enumerate}
\end{proposition}

We call this design $ \AG\br{n, F}_m $.

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item $ \AG\br{3, \ZZ_3}_1 $ is a $ 2 $-$ \br{27, 3, 1} $ design, which are points and lines in $ \ZZ_3^3 $.
\item $ \AG\br{3, \ZZ_3}_2 $ is a $ 2 $-$ \br{27, 9, 4} $ design.
\item $ \AG\br{3, \ZZ_2}_2 $ is a $ 3 $-$ \br{8, 4, 1} $ design. A fact is that this is isomorphic to the design obtained from weight four codewords in the extended Hamming code $ H' $.
\end{itemize}
\end{example*}

\begin{proof}[Proof of \ref{prop:3.17}]
\hfill
\begin{enumerate}
\item The lines have the size of an $ m $-dimensional subspace, which is $ q^m $. Let $ v, w \in F^n $ be distinct. Any block containing $ v $ has the form $ v + W $ for some $ m $-dimensional subspace $ W $. Now $ w \in v + W $ if and only if $ v - w \in W $. The number of blocks containing $ v $ and $ w $ is the number of $ m $-dimensional subspaces of $ F^n $ containing $ v - w $, which is what we want by \ref{prop:3.16}.
\item Let $ F = \ZZ_2 $ and $ m \ge 2 $. Let $ \cbr{v_1, v_2, v_3} $ be a $ 3 $-subset of $ F^n $. Any block containing $ v_1 $ has the form $ v_1 + W $ for some $ m $-dimensional subspace $ W $. Then $ v_2, v_3 \in v_1 + W $ if and only if $ v_1 - v_2, v_1 - v_3 \in W $. The number of blocks containing $ v_1, v_2, v_3 $ is the number of $ m $-dimensional subspaces containing $ v_1 - v_2 $ and $ v_2 - v_3 $, so $ F = \ZZ_2 $ implies that these are linearly independent, which is what we want by \ref{prop:3.16}.
\end{enumerate}
\end{proof}

\begin{proof}[Proof of \ref{prop:3.16}]
\hfill
\begin{enumerate}
\item An $ m $-dimensional subspace $ W $ has a basis $ w_1, \dots, w_m $. Let $ N $ be the number of pairs $ \br{\br{w_1, \dots, w_m}, W} $ where $ \br{w_1, \dots, w_m} $ is an ordered list of linearly independent vectors, and $ W = \sp \br{w_1, \dots, w_m} $.
\begin{itemize}
\item Then $ N $ is the number of such $ m $-tuples times one. Counting the number of $ m $-tuples $ \br{w_1, \dots, w_m} $ where $ \cbr{w_i} $ is linearly independent,
$$ q^n - 1 \ \text{choices of} \ w_1 \in F^n \setminus \cbr{0}, \qquad q^n - q \ \text{choices of} \ w_2 \in F^n \setminus \sp w_1, \qquad \dots. $$
Thus $ N = \br{q^n - 1} \dots \br{q^n - q^{m - 1}} $.
\item On the other hand, $ N $ is the number of $ m $-dimensional subspaces times the number of ordered bases of a particular $ m $-dimensional subspace $ W $, so
$$ N = \br{\text{number of $ m $-dimensional subspaces}} \times \br{q^m - 1} \dots \br{q^m - q^{m - 1}}. $$
Thus the number of $ m $-dimensional subspaces is
$$ \dfrac{\br{q^n - 1} \dots \br{q^n - q^{m - 1}}}{\br{q^m - 1} \dots \br{q^m - q^{m - 1}}} = \dfrac{\br{q^n - 1} \dots \br{q^{n - m + 1} - 1}}{\br{q^m - 1} \dots \br{q - 1}} = \binom{n}{m}_q. $$
\end{itemize}
\item Let $ 0 \ne v \in F^n $.
\begin{itemize}
\item If $ m = 1 $, then $ \sp v $ is the only one-dimensional subspace containing $ v $, as desired.
\item Suppose $ m \ge 2 $. Extend to a basis $ v, v_2, \dots, v_n $ of $ F^n $. Let $ V_0 = \sp \br{v_2, \dots, v_n} $. Let $ W $ be an $ m $-dimensional subspace of $ F^n $ containing $ v $. Let $ W_0 = W \cap V_0 $ be a subspace of $ V_0 $. Note that $ W_0 \cap \sp v = \cbr{0} $. Let $ w \in W $. Then $ w = \lambda v + w_0 $ where $ w_0 \in V_0 $, so $ w_0 = w - \lambda v \in W $. So $ w_0 \in W_0 $. Thus $ W = \sp v + W_0 $. Hence $ W = \sp v \oplus W_0 $, so $ W_0 $ has dimension $ m - 1 $. Proved that any $ m $-dimensional subspace of $ F^n $ containing $ v $ has the form $ \sp v \oplus U $ where $ U $ is an $ \br{m - 1} $-dimensional subspace of $ V_0 $. Thus the number of $ W $, the number of $ \br{m - 1} $-dimensional subspaces of $ V_0 $, which is $ \br{n - 1} $-dimensional, is $ \binom{n - 1}{m - 1}_q $, by $ 1 $.
\end{itemize}
\item Similar.
\end{enumerate}
\end{proof}

\pagebreak

\subsection{Designs and strongly regular graphs}

Have seen two weight codes give strongly regular graphs, by \ref{thm:2.11}. Have seen Golay codes give designs. Now see certain designs give strongly regular graphs.

\lecture{28}{Tuesday}{11/12/18}

\begin{definition*}
A $ 2 $-design is \textbf{quasisymmetric} if there are $ x, y \in \ZZ $ for $ x \ne y $ such that any two blocks intersect in $ x $ or $ y $ points, and both occur.
\end{definition*}

\begin{note*}
Symmetric if and only if two blocks meet in $ \lambda $ points and $ v > k $, by \ref{thm:3.9} and sheet $ 4 $. \footnote{Exercise}
\end{note*}

\begin{example*}
\hfill
\begin{itemize}
\item $ \AG\br{2, F} $ has lines meeting in zero or one point.
\item Golay code $ \G_{23} $ has
\begin{itemize}
\item points $ 23 $ coordinate positions, and
\item blocks $ \B_c $ such that $ \wt c = 7 $, which are seven coordinate positions with one.
\end{itemize}
This is a $ 4 $-$ \br{23, 7, 1} $ design, by sheet $ 2 $. \footnote{Exercise} Then $ c \ne d $ implies that $ \abs{\B_d \cap \B_c} = 1 $ or $ \abs{\B_d \cap \B_c} = 3 $.
\end{itemize}
\end{example*}

\begin{theorem}
\label{thm:3.18}
Let $ \br{X, \BBB} $ be a quasisymmetric $ 2 $-design with blocks intersecting in $ x $ or $ y $ points with $ x < y $. Define a graph $ \Gamma\br{\BBB} $ by $ \B_1 \sim \B_2 $ if and only if $ \abs{\B_1 \cap \B_2} = x $. Then $ \Gamma\br{\BBB} $ is strongly regular.
\end{theorem}

\begin{example*}
Let $ \br{X, \BBB} = \AG\br{2, F} $ and $ \abs{F} = q $. Then $ \Gamma\br{\BBB} $ has vertices lines and $ l_1 \sim l_2 $ if and only if $ l_1 $ and $ l_2 $ are parallel. Thus $ \Gamma\br{\BBB} $ is a union of $ q + 1 $ complete graphs.
\end{example*}

\begin{proposition}
\label{prop:3.19}
Suppose $ \Gamma $ is a graph with $ v $ vertices and adjacency matrix $ A $. Assume $ \Gamma \ne \K_v, \overline{\K_v} $. Then the following are equivalent.
\begin{enumerate}
\item $ \Gamma $ is strongly regular.
\item $ A^2 = \alpha A + \beta\I + \gamma\J $ for some $ \alpha, \beta, \gamma \in \RR $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{itemize}[leftmargin=0.5in]
\item[$ 1 \implies 2 $.] \ref{prop:2.6}.
\item[$ 2 \implies 1 $.] Assume $ 2 $. Then
$$ \br{A^2}_{ij} =
\begin{cases}
\beta + \gamma & i = j \\
\alpha + \gamma & i \ne j, \ i \sim j \\
\gamma & i \ne j, \ i \nsim j
\end{cases}.
$$
Also,
$$ \br{A^2}_{ij} = A_{i\cdot}A_{\cdot j} = A_{i \cdot} \cdot A_{j\cdot} = \abs{\cbr{k \in \Gamma \st i \sim k, \ j \sim k}}. $$
So
$$ \Gamma = \srg\br{v, \beta + \gamma, \alpha + \gamma, \gamma}. $$
\end{itemize}
\end{proof}

\pagebreak

\begin{proof}[Proof of \ref{thm:3.18}]
Let $ M $ be the $ v \times b $ incidence matrix of $ \br{X, \BBB} $ and $ A $ be the $ b \times b $ adjacency matrix of $ \Gamma\br{\BBB} $. By \ref{prop:3.5},
\begin{equation}
\label{eq:7}
MM^\intercal = \lambda \J_v + \br{r - \lambda}\I_v,
\end{equation}
\begin{equation}
\label{eq:8}
M\J_{b \times t} = r\J_{v \times t}, \qquad \J_{t \times v}M = k\J_{t \times b}.
\end{equation}
Considering $ M^\intercal M $, a $ b \times b $ matrix,
$$ \br{M^\intercal M}_{ij} = M_{\cdot i} \cdot M_{\cdot j} = \abs{\B_i \cap \B_j} =
\begin{cases}
k & i = j \\
x & i \ne j, \ \B_i \sim \B_j \\
y & i \ne j, \ \B_i \nsim \B_j
\end{cases}.
$$
Hence
\begin{equation}
\label{eq:9}
M^\intercal M = k\I_b + xA + y\br{\J_b - A - \I_b} = \br{x - y}A + \br{k - y}\I_b + y\J_b.
\end{equation}
As $ x \ne y $
$$ A = fM^\intercal M + g\I_b + k\J_b, \qquad f = \dfrac{1}{x - y}, \qquad g = \dfrac{y - k}{x - y}, \qquad k = \dfrac{-y}{x - y}. $$
Now we use $ \br{\ref{eq:7}} $ to $ \br{\ref{eq:9}} $ to compute
\begin{align*}
A^2
& = \br{fM^\intercal M + g\I_b + k\J_b}\br{fM^\intercal M + g\I_b + k\J_b} \\
& = f^2M^\intercal MM^\intercal M + g^2\I_b + k^2\J_b^2 + 2fgM^\intercal M + 2gk\J_b + kfM^\intercal M\J_b + kf\J_bM^\intercal M.
\end{align*}
To use \ref{prop:3.19}, show that each term here can be expressed in terms of $ A, \I_b, \J_b $.
\begin{align*}
M^\intercal MM^\intercal M
& = M^\intercal\br{\lambda\J_v + \br{r - \lambda}\I_v}M & \text{by} \ \br{\ref{eq:7}}, \\
& = \lambda k\J_{b \times v}M + \br{r - \lambda}M^\intercal M & \text{by} \ \br{\ref{eq:8}}, \\
& = \lambda k^2\J_b + \br{r - \lambda}M^\intercal M & \text{by} \ \br{\ref{eq:8}}, \\
& = \br{r - \lambda}\br{x - y}A + \br{r - \lambda}\br{k - y}\I_b + \br{\lambda k^2 + \br{r - \lambda}y}\J_b & \text{by} \ \br{\ref{eq:9}}. \\
\\
\J_b^2
& = b\J_b & . \\
\\
M^\intercal M
& = \br{x - y}A + \br{k - y}\I_b + y\J_b & \text{by} \ \br{\ref{eq:9}}. \\
\\
M^\intercal M\J_b
& = rM^\intercal \J_v & \text{by} \ \br{\ref{eq:8}}, \\
& = rk\J_b & \text{by} \ \br{\ref{eq:8}}. \\
\\
\J_bM^\intercal M
& = r\J_vM & \text{by} \ \br{\ref{eq:8}}, \\
& = rk\J_b & \text{by} \ \br{\ref{eq:8}}.
\end{align*}
From these, there exist $ \alpha, \beta, \gamma \in \QQ $ with
$$ A^2 = \alpha A + \beta\I_b + \gamma\J_b, $$
so by \ref{prop:3.19}, $ \Gamma\br{\BBB} $ is strongly regular. Work out the parameters. \footnote{Exercise}
\end{proof}

\lecture{29}{Tuesday}{11/12/18}

Lecture 29 is a class test.

\lecture{30}{Wednesday}{12/12/18}

Lecture 30 is a problems class.

\end{document}