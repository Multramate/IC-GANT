\def\module{M4P32 Number Theory: Elliptic Curves}
\def\lecturer{Prof Toby Gee}
\def\term{Autumn 2019}
\def\cover{}
\def\syllabus{}
\def\thm{section}

\input{../style/header}

\begin{document}

\input{../style/main}

\setcounter{section}{0}

\section{Introduction}

\lecture{1}{Thursday}{03/10/19}

The following are books.
\begin{itemize}
\item J W S Cassels, Lectures on elliptic curves, 1991
\item J H Silverman, The arithmetic of elliptic curves, 1986
\item J H Silverman and J Tate, Rational points on elliptic curves, 1992
\end{itemize}
Note that there are a lot of books on elliptic curves out there, and a lot of them are not relevant to this course, so either different topics, or they will be too advanced. Also, about half of this course will not actually be on elliptic curves. We are going to start off by looking at conics, which are simpler but are a good place to start in order to build intuition and technique. As explained below, we will be essentially following Cassels, although there is quite a lot of material that we will not cover, and our treatment of a $ 2 $-descent, that is our method for computing the rank of an elliptic curve over $ \QQ $, will be different. The overall aim of this course is to learn more about solving polynomial equations in $ \ZZ $ or $ \QQ $. For example,
$$ x^2 + y^2 = 5, \qquad y^2 = x^3 - x, \qquad x^4 + y^4 = 17. $$
Let $ k $ be a field, such as $ \QQ $, $ \RR $, $ \CC $, the field of $ p $ elements $ \FF_p $, or the $ p $-adic numbers $ \QQ_p $, and let its polynomial ring be $ k\sbr{x_0, \dots, x_n} $. A \textbf{monomial} is a term $ x_0^{a_0}\dots x_n^{a_n} $, which has degree $ a_0 + \dots + a_n $. The \textbf{degree} of a polynomial is the maximal degree of a monomial occuring in it.

\begin{example*}
$ x_1^5 + x_2x_3 + x_{10}x_{11}^5 $ has degree six.
\end{example*}

Equations in one variable are easy to solve over $ \QQ $.

\begin{example*}
Let $ 3x^5 - 9x^3 + x^2 + \tfrac{148}{81} = 0 $, so $ 243x^5 - 729x^3 + 81x^2 + 148 = 0 $. If $ x = a / b $ with $ \br{a, b} = 1 $, we need $ 243a^5 - 729a^3b^2 + 81a^2b^3 + 148b^5 = 0 $. Then $ b \ne 0 $, so $ a \ne 0 $, so $ a^2 \mid 148 $, so $ a \mid 2 $, so $ a = \pm 1, \pm 2 $. Similarly $ b^2 \mid 243 $, so $ b \mid 9 $, so $ b = \pm 1, \pm 3, \pm 9 $. Check each of these, and $ x = \tfrac{2}{3} $.
\end{example*}

More than two variables, over $ \QQ $, is hopeless, so let $ x $ and $ y $ be two variables.
\begin{itemize}
\item Degree one is very easy, since $ ax + by + c = 0 $ for $ b \ne 0 $ gives $ y = -c / b - \br{a / b}x $.
\item Degree two and three are in this course. Degree four can be reduced to degree three.
\end{itemize}

\begin{theorem}[Mordell's conjecture and Falting's theorem]
A general equation in two variables of degree greater than four has only finitely many solutions over $ \QQ $.
\end{theorem}

General equations are non-singular, so $ \br{x - y}\br{x^{100} + 10y + 1} = 0 $ and $ x^{73} - y^{109} = 0 $ are not general.

\begin{example}
Let $ x^2 + y^2 = c $ for $ c \in \QQ $.
\begin{itemize}
\item $ x^2 + y^2 = -1 $ has no solutions in $ \RR $.
\item $ x^2 + y^2 = 0 $ has $ \br{x, y} = \br{0, 0} $ in $ \RR $.
\item $ x^2 + y^2 = 1 $ has infinitely many solutions $ \br{x, y} = \br{\tfrac{3}{5}, \tfrac{4}{5}}, \br{\tfrac{5}{13}, \tfrac{12}{13}}, \dots $, since $ \br{a / c}^2 + \br{b / c}^2 = 1 $ gives $ a^2 + b^2 = c^2 $, which has infinitely many solutions $ \br{3, 4, 5}, \br{5, 12, 13}, \dots $.
\item $ x^2 + y^2 = 3 $ has no solutions in $ \QQ $, since $ a^2 + b^2 = 3c^2 $ has no solutions for $ a, b, c \in \ZZ $ and $ c \ne 0 $. Suppose $ a, b, c $ is such a solution. Then $ a^2 + b^2 \equiv 0 \mod 3 $. But all squares are $ 0 $ or $ 1 $ modulo $ 3 $, so $ a \equiv b \equiv 0 \mod 3 $. Write $ a = 3A $ and $ b = 3B $ gives $ 3\br{A^2 + B^2} = c^2 $, so $ 3 \mid c $. Write $ c = 3C $ gives $ A^2 + B^2 = 3C^2 $, a contradiction, by induction on the biggest power of $ 3 $ dividing $ c $. Next week $ x^2 + y^2 = 3 $ has no solutions in $ \QQ_3 $.
\end{itemize}
\end{example}

\begin{example}
$ x^2 + 2y^2 = 6 $ has $ \br{x, y} = \br{2, 1} $, which has line $ y - 1 = m\br{x - 2} $, so
$$ \br{2m\br{x - 2}}^2 + x^2 - 6 = 0 \qquad \implies \qquad \br{2m^2 + 1}x^2 + \br{4m - 8m^2}x + 2\br{1 - 2m}^2 - 6 = 0. $$
The sum of the roots of $ ax^2 + bx + c $ is $ -b / a $. So the second root, other than $ x = 2 $ and $ y = 1 $, is
$$ x = \dfrac{8m^2 - 4m}{2m^2 + 1} - 2 = \dfrac{4m^2 - 4m - 2}{2m^2 + 1}, \qquad y = \dfrac{-2m^2 - 4m + 1}{2m^2 + 1}. $$
\end{example}

\begin{exercise}
Do the case $ xy = 0 $.
\end{exercise}

\pagebreak

\section{The \texorpdfstring{$ p $}{p}-adic numbers}

\lecture{2}{Monday}{07/10/19}

\begin{definition}
A \textbf{norm} on a field $ k $ is a function $ \abs{\cdot} : k \to \RR $ such that
\begin{enumerate}
\item $ \abs{x} \ge 0 $ with equality if and only if $ x = 0 $,
\item $ \abs{xy} = \abs{x} \cdot \abs{y} $, and
\item $ \abs{x + y} \le \abs{x} + \abs{y} $.
\end{enumerate}
\end{definition}

$ 2 $ implies that $ \abs{1} = \abs{-1} = 1 $. So $ \abs{x} = \abs{-x} $.

\begin{example*}
Usual absolute value on $ \RR $, that is
$$ \abs{x} =
\begin{cases}
x & x \ge 0 \\
-x & x < 0 \\
\end{cases}.
$$
\end{example*}

\begin{remark}
Define
$$ \function[d\br{\cdot, \cdot}]{k^2}{\RR}{\br{x, y}}{\abs{x - y}}, $$
then $ d $ is a metric on $ k^2 $. Not every metric comes from a norm.
\end{remark}

\begin{definition}
Let $ k = \QQ $. Then the \textbf{$ p $-adic norm} is defined by
$$
\function[\abs{\cdot}_p]{\QQ}{\RR}{x}{
\begin{cases}
0 & x = 0 \\
p^{-n} & x = p^n\dfrac{a}{b}, \ n \in \ZZ, \ \br{p, a} = \br{p, b} = \br{a, b} = 1
\end{cases}
}.
$$
\end{definition}

\begin{lemma}
$ \abs{\cdot}_p $ is a norm, and in fact
\begin{enumerate}
\item[$ 3^* $.] $ \abs{x + y} \le \max\br{\abs{x}, \abs{y}} $.
\end{enumerate}
\end{lemma}

\begin{proof}
Without loss of generality, $ x, y \in \ZZ $. Also we may assume $ x, y, x + y \ne 0 $. Then $ 3^* $ is equivalent to, if $ p^n \mid x $ and $ p^n \mid y $, then $ p^n \mid \br{x + y} $.
\end{proof}

\begin{definition}
We say that $ 3^* $ is the \textbf{ultrametric inequality}. If $ \abs{\cdot} $ satisfies $ 3^* $, we say that $ \abs{\cdot} $ is \textbf{non-archimedean}.
\end{definition}

We have infinitely many norms on $ \QQ $, the one from $ \RR $, and the $ p $-adic norm $ \abs{\cdot}_p $ for each prime $ p $. Say that two norms $ \abs{\cdot}_1 $ and $ \abs{\cdot}_2 $ on $ k $ are \textbf{equivalent} if there exists $ \alpha > 0 $ such that $ \abs{\cdot}_1 = \abs{\cdot}_2^\alpha $.

\begin{exercise*}
Check two norms are equivalent if and only if the corresponding metrics give the same topology on $ k $.
\end{exercise*}

\begin{theorem}
Any norm on $ \QQ $ is equivalent to exactly one of
\begin{itemize}
\item the archimedean norm coming from $ \RR $,
\item a norm $ \abs{\cdot}_p $ for some uniquely determined $ p $, or
\item the discrete norm $ \abs{x} = 1 $ if $ x \ne 0 $.
\end{itemize}
\end{theorem}

\begin{lemma}
\label{lem:2.7}
If $ \abs{\cdot} $ is non-archimedean and $ \abs{x} \ne \abs{y} $, then $ \abs{x + y} = \max\br{\abs{x}, \abs{y}} $.
\end{lemma}

\begin{proof}
Without loss of generality $ \abs{x} > \abs{y} $. Write $ x = \br{x + y} + \br{-y} $, so that $ 3^* $ gives us
$$ \abs{x} \le \max\br{\abs{x + y}, \abs{-y}} \le \max\br{\abs{x}, \abs{y}, \abs{-y}} = \abs{x}. $$
So $ \abs{x} = \max\br{\abs{x + y}, \abs{y}} $. But $ \abs{x} > \abs{-y} = \abs{y} $, so $ \abs{x} = \abs{x + y} $.
\end{proof}

\begin{exercise}
Check Lemma \ref{lem:2.7} for $ \abs{\cdot}_p $ using the definition.
\end{exercise}

\pagebreak

Recall that
\begin{itemize}
\item a sequence $ \br{x_n} $ in $ k $ is \textbf{Cauchy} if for all $ \epsilon > 0 $ there exists $ N $ such that $ m, n \ge N $ implies that $ \abs{x_m - x_n} < \epsilon $, and
\item a sequence $ \br{x_n} $ \textbf{converges} to $ x \in k $ if for all $ \epsilon > 0 $ there exists $ M $ such that $ n \ge M $ implies that $ \abs{x_n - x} < \epsilon $.
\end{itemize}
$ \br{x_n} $ converges implies that $ \br{x_n} $ is Cauchy, but in general $ \br{x_n} $ is Cauchy does not imply that $ \br{x_n} $ converges.

\begin{example*}
\hfill
\begin{itemize}
\item $ \RR $ is complete.
\item $ \QQ $ is not complete with respect to the usual archimedean norm. For example, $ 3, 3.1, \dots \to \pi \notin \QQ $.
\end{itemize}
\end{example*}

\begin{example}
Let $ p = 2 $. Then $ \br{x_n} = 3, 33, \dots $ is Cauchy with respect to $ \abs{\cdot}_2 $, and $ x_n = \tfrac{10^n - 1}{3} \to -\tfrac{1}{3} $ as $ n \to \infty $ because $ \abs{x_n + \tfrac{1}{3}}_2 = \abs{\tfrac{10^n}{3}}_2 = \abs{2^n\tfrac{5^n}{3}}_2 = 2^{-n} \to 0 $.
\end{example}

\begin{example}
Let $ x_n = 5^{2^n} $. If $ p = 5 $, then $ x_n \to 0 $, since $ \abs{5^{2^n}}_5 = 5^{-2^n} \to 0 $ as $ n \to \infty $. If $ p = 2 $, then $ x_n \to 1 $ as $ n \to \infty $, since $ \br{1 + y}^2 = 1 + 2y + y^2 $. \footnote{Exercise}
\end{example}

\begin{example*}
A Cauchy sequence in $ \QQ $ for $ \abs{\cdot}_3 $ which does not converge. Take a sequence converging to $ \sqrt{7} $. That is, take $ \br{x_n} $ such that $ x_n^2 - 7 \to 0 $, that is $ \abs{x_n^2 - 7}_3 \to 0 $ as $ n \to \infty $. For example, take $ x_n \in \ZZ $, chosen such that $ x_n^2 \equiv 7 \mod 3^n $. For example,
$$ x_1 = 1, \qquad x_2 = 4, \qquad x_3 = 13, \qquad \dots. $$
\end{example*}

\begin{exercise}
If $ p > 2 $ and $ t \in \ZZ $ is not a square but is a quadratic residue modulo $ p $, that is there exists $ y $ such that $ y^2 \equiv t \mod p $, then there exists a Cauchy sequence $ \br{x_n} $ in $ \QQ $ with $ x_n^2 \to t $ as $ n \to \infty $, such as $ t = 1 - p $. If $ p = 2 $, then $ t = -7 $ works.
\end{exercise}

\lecture{3}{Tuesday}{08/10/19}

$ \QQ $ is not complete with respect to any $ \abs{\cdot}_p $. Let $ k $ be a field and $ \abs{\cdot} $ be non-archimedean. Let
$$ R = \cbr{\text{Cauchy sequences in} \ k}, $$
where $ \br{x_n} + \br{y_n} = \br{x_n + y_n} $ and $ \br{x_n}\br{y_n} = \br{x_ny_n} $. Let
$$ I = \cbr{\br{x_n} \st x_n \to 0 \ \text{as} \ n \to \infty}. $$

\begin{exercise*}
\hfill
\begin{itemize}
\item Check that $ I $ is an ideal in $ R $.
\item If $ \br{x_n} \notin I $, then there exists $ N $ such that $ n \ge N $ implies that $ x_n \ne 0 $. Show that furthermore the sequence $ \br{y_n} $ defined by
$$ y_n =
\begin{cases}
0 & n < N \\
\dfrac{1}{x_n} & n \ge N
\end{cases}
$$
is Cauchy, and $ x_ny_n = 1 $ for all $ n \ge N $, so $ \br{x_n}\br{y_n} - 1 \in I $.
\end{itemize}
\end{exercise*}

That is, $ I $ is a maximal ideal of $ R $, so $ \widehat{k} = R / I $ is a field. There is a natural map
$$ \function{k}{\widehat{k}}{x}{\br{x}_{n \ge 1}}. $$
This is an injection. Call $ \widehat{k} $ the \textbf{completion} of $ k $. The norm $ \abs{\cdot} $ extends to $ \widehat{k} $ by defining
$$ \abs{\br{x_n}} = \lim_{n \to \infty} \abs{x_n}. $$

\begin{exercise*}
\hfill
\begin{itemize}
\item Check that this is defined, and is a norm.
\item Check that if $ x_n \not\to 0 $, then $ \abs{x_n} $ is eventually constant, by using Lemma \ref{lem:2.7}.
\end{itemize}
\end{exercise*}

\pagebreak

\begin{lemma}
\label{lem:2.12}
$ k $ is dense in $ \widehat{k} $.
\end{lemma}

\begin{proof}
Need to show that if $ x \in \widehat{k} $ and $ \epsilon > 0 $, then there exists $ y \in k $ such that $ \abs{x - y} < \epsilon $. Write $ x = \br{x_n} $ for $ x_n \in k $, and choose $ N $ such that if $ m, n \ge N $, then $ \abs{x_m - x_n} < \epsilon $. Then take $ y = x_N $. Then $ \abs{x - y} = \lim_{n \to \infty} \abs{x_n - x_N} < \epsilon $.
\end{proof}

\begin{lemma}
$ \widehat{k} $ is complete.
\end{lemma}

\begin{proof}
Let $ \br{x_n} $ be a Cauchy sequence in $ \widehat{k} $, so $ x_n $ is itself an equivalence class of Cauchy sequences in $ k $. By Lemma \ref{lem:2.12}, for each $ n \ge 1 $ there exists $ y_n \in k $ such that $ \abs{x_n - y_n} < \tfrac{1}{n} $. Claim that $ y = \br{y_n} $ is a Cauchy sequence, and $ x_n \to y $ as $ n \to \infty $. Since
$$ \abs{y_m - y_n} \le \abs{y_m - x_m} + \abs{x_m - x_n} + \abs{x_n - y_n} < \dfrac{1}{m} + \dfrac{1}{n} + \abs{x_m - x_n}, $$
and $ \br{x_n} $ is Cauchy, so $ \br{y_n} $ is Cauchy. Then
$$ \abs{x_n - y} \le \abs{x_n - y_n} + \abs{y_n - y} < \dfrac{1}{n} + \abs{y_n - y}. $$
Need to check that $ \abs{y_n - y} \to 0 $ as $ n \to \infty $, which is what we did in the proof of Lemma \ref{lem:2.12}.
\end{proof}

\begin{definition}
Let $ k = \QQ $ and $ \abs{\cdot} = \abs{\cdot}_p $. Write the field of \textbf{$ p $-adic numbers} $ \QQ_p $ for $ \widehat{k} $, the completion of $ \QQ $ with respect to $ \abs{\cdot}_p $, and the ring of \textbf{$ p $-adic integers}
$$ \ZZ_p = \cbr{x \in \QQ_p \st \abs{x}_p \le 1} \subset \QQ_p. $$
\end{definition}

By construction or definition, $ \QQ \subset \QQ_p $, and $ \ZZ \subset \ZZ_p $.

\begin{exercise}
Show that $ \ZZ_p $ is a subring of $ \QQ_p $. More generally, if $ k $ is any non-archimedean field, then
$$ \cbr{x \in k \st \abs{x} \le 1} $$
is a subring of $ k $.
\end{exercise}

\begin{note*}
$ \tfrac{1}{p} \notin \ZZ_p $, and $ \abs{\tfrac{1}{p}}_p = p > 1 $. In fact $ \QQ_p = \ZZ_p\sbr{\tfrac{1}{p}} $, the field of fractions of $ \ZZ_p $.
\end{note*}

\begin{definition}
If $ k $ is any field with a norm $ \abs{\cdot} $, then we write
$$ \sum_{n = 1}^\infty a_n = \lim_{m \to \infty} \sum_{n = 1}^m a_n, $$
if this limit exists.
\end{definition}

\begin{lemma}
\label{lem:2.17}
If $ k $ is non-archimedean, and $ t_1, \dots, t_n \in k $, then
$$ \abs{\sum_{i = 1}^n t_i} \le \max_{1 \le i \le n} t_i. $$
In particular if $ \abs{t_i} \le R $ for all $ i $, then $ \abs{\sum_{i = 1}^n t_i} \le R $.
\end{lemma}

\begin{proof}
Induction on $ n $, where $ n = 2 $ is $ 3^* $.
\end{proof}

\begin{corollary}
\label{cor:2.18}
A sequence $ \br{t_n} $ is Cauchy if and only if $ \abs{t_n - t_{n + 1}} \to 0 $ as $ n \to \infty $.
\end{corollary}

\begin{proof}
If $ m > n $, then
$$ t_m - t_n = \br{t_m - t_{m - 1}} + \dots + \br{t_{n + 1} - t_n}, $$
and use Lemma \ref{lem:2.17}.
\end{proof}

\pagebreak

\begin{lemma}
If $ k $ is complete non-archimedean, such as $ k = \QQ_p $, then $ \sum_{n = 1}^\infty x_n $ converges if and only if $ x_n \to 0 $ as $ n \to \infty $. If $ \abs{x_n} \le R $ and $ x_n \to 0 $ then $ \abs{\sum_{n = 1}^\infty x_n} \le R $.
\end{lemma}

\begin{proof}
$ \sum_{n = 1}^\infty x_n $ converges if and only if
\begin{align*}
\br{\sum_{n = 1}^m x_n}_{m \ge 1} \ \text{converges} \qquad
& \iff \qquad \br{\sum_{n = 1}^m x_n}_{m \ge 1} \ \text{is Cauchy} & k \ \text{is complete} \\
& \iff \qquad x_{m + 1} \to 0 & \text{Corollary \ref{cor:2.18}}.
\end{align*}
The final statement then follows from Lemma \ref{lem:2.17}.
\end{proof}

\begin{lemma}
\label{lem:2.20}
If $ a_n \in \ZZ $ then $ \sum_{n = 0}^\infty a_np^n $ converges in $ \QQ_p $. If $ a_n = 0 $ for $ n < T $ and $ a_T \ne 0 $, and $ p \nmid a_T $, then
$$ \abs{\sum_{n = 0}^\infty a_np^n}_p = p^{-T}. $$
\end{lemma}

\begin{proof}
Since $ a_n \in \ZZ $, $ \abs{a_np^n}_p = \abs{a_n}_p \cdot \abs{p^n}_p \le \abs{p^n}_p = p^{-n} \to 0 $. Furthermore $ \abs{a_Tp^T}_p = p^{-T} $ and $ \abs{a_np^n}_p \le p^{-T - 1} $ if $ n \ge T + 1 $, so $ \abs{\sum_{n = T + 1}^\infty a_np^n}_p \le p^{-T - 1} $, so $ \abs{a_Tp^T + \sum_{n = T + 1}^\infty a_np^n}_p = p^{-T} $, by Lemma \ref{lem:2.7}.
\end{proof}

\lecture{4}{Thursday}{10/10/19}

\begin{proposition}
\label{prop:2.21}
\hfill
\begin{enumerate}
\item If $ a_n \in \cbr{0, \dots, p - 1} $, then $ \sum_n a_np^n $ converges to an element of $ \ZZ_p $. Furthermore if
$$ \sum_n a_np^n = \sum_n b_np^n, \qquad b_n \in \cbr{0, \dots, p - 1}, $$
then $ a_n = b_n $ for all $ n $.
\item If $ \alpha \in \ZZ_p $ then there exists $ \br{a_n} $ as in $ 1 $ such that $ \alpha = \sum_n a_np^n $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Lemma \ref{lem:2.20} gives convergence. Suppose that $ T $ is minimal such that $ a_T \ne b_T $, then by Lemma \ref{lem:2.20}, $ \abs{\sum_n \br{a_n - b_n}p^n}_p = p^{-T} $. In particular $ \sum_n \br{a_n - b_n}p^n \ne 0 $.
\item By construction, $ \QQ $ is dense in $ \QQ_p $. So there exists $ \beta \in \QQ $ such that $ \abs{\alpha - \beta}_p < 1 $. Since $ \abs{\alpha}_p \le 1 $, we have $ \abs{\beta}_p \le 1 $, so if $ \beta = r / s $ with $ \br{r, s} = 1 $, then $ p \nmid s $. So there exists $ \gamma \in \ZZ $ with $ \abs{\gamma - \beta}_p < 1 $, if and only if $ s\gamma - r \equiv 0 \mod p $, which has solutions because $ \br{s, p} = 1 $. There exists $ a_0 \in \cbr{0, \dots, p - 1} $ such that $ \abs{\gamma - a_0}_p < 1 $, so
$$ \abs{\alpha - a_0}_p \le \max\br{\abs{\alpha - \beta}_p, \abs{\beta - \gamma}_p, \abs{\gamma - a_0}_p} < 1. $$
Then $ \abs{\br{\alpha - a_0} / p}_p \le 1 $, that is $ \br{\alpha - a_0} / p \in \ZZ_p $. Repeating the argument, there exists $ a_1 \in \cbr{0, \dots, p - 1} $ such that $ \abs{\br{\alpha - a_0} / p - a_1}_p < 1 $, that is $ \br{\alpha - a_0 - a_1p} / p^2 \in \ZZ_p $. By induction, we find $ a_0, a_1, \dots $ such that $ \abs{\alpha - \br{a_0 + \dots + a_np^n}}_p \le p^{-\br{n + 1}} $. So $ \alpha = \sum_{n = 0}^\infty a_np^n $.
\end{enumerate}
\end{proof}

\begin{corollary}
Any element $ \alpha $ of $ \QQ_p $ can be uniquely written as
$$ \alpha = \sum_{n \ge -T} a_np^n, \qquad a_{-T} \ne 0, \qquad a_n \in \cbr{0, \dots, p - 1}. $$
\end{corollary}

\begin{proof}
If $ \abs{\alpha}_p = p^T $, then $ \abs{p^T\alpha}_p = 1 $, so $ p^T\alpha \in \ZZ_p $, and the claim follows from Proposition \ref{prop:2.21}.$ 2 $ applied to $ p^T\alpha $.
\end{proof}

\begin{corollary}
$ \ZZ $ is dense in $ \ZZ_p $.
\end{corollary}

\begin{proof}
If $ \alpha \in \ZZ_p $, write $ \alpha = \sum_n a_np^n $. Then
$$ \abs{\alpha - \br{a_0 + \dots + a_mp^m}}_p \le p^{-\br{m + 1}}, $$
and $ a_0 + \dots + a_mp^m \in \ZZ $.
\end{proof}

\pagebreak

For all $ m \ge 1 $, there is a surjective ring homomorphism
$$ \function{\ZZ_p}{\ZZ / p^m\ZZ}{\sum_{n = 0}^\infty a_np^n}{\sum_{n = 0}^{m - 1} a_np^n}. $$
In fact
$$ \ZZ_p / p^m\ZZ_p = \ZZ / p^m\ZZ, \qquad \ZZ_p = \varprojlim_m \ZZ / p^m\ZZ. $$

\begin{lemma}
\label{lem:2.24}
$$ \ZZ_p^\times = \cbr{x \in \ZZ_p \st \abs{x}_p = 1}. $$
\end{lemma}

\begin{proof}
If $ \abs{x}_p = 1 $ then $ x \ne 0 $, and so $ x^{-1} \in \QQ_p $, and $ \abs{x^{-1}}_p = 1 / \abs{x}_p = 1 $, so $ x^{-1} \in \ZZ_p $. Conversely if $ x \in \ZZ_p^\times $ then there exists $ y \in \ZZ_p $ such that $ xy = 1 $, so $ \abs{x}_p\abs{y}_p = 1 $. But $ \abs{x}_p, \abs{y}_p \le 1 $, so $ \abs{x}_p = \abs{y}_p = 1 $.
\end{proof}

Now $ \abr{p} \subset \ZZ_p $ is a maximal ideal, because $ \ZZ_p / \abr{p} = \ZZ / p\ZZ $ is a field. Since $ \ZZ_p^\times = \ZZ_p \setminus \abr{p} $ by Lemma \ref{lem:2.24}, $ \abr{p} $ is the unique maximal ideal of $ \ZZ_p $, that is $ \ZZ_p $ is a local ring. In fact it is a discrete valuation ring.

\begin{notation*}
A unit of $ \QQ_p $ is a unit in $ \ZZ_p $, that is an element of $ \abs{\cdot}_p = 1 $.
\end{notation*}

\begin{corollary}
Every element of $ \QQ_p $ other than zero is uniquely of the form $ p^nu $ for $ n \in \ZZ $ and $ u $ is a unit.
\end{corollary}

\begin{proof}
If $ \alpha \in \QQ_p $ and $ \alpha \ne 0 $, write $ \abs{\alpha}_p = p^{-n} $ for $ n \in \ZZ $, and set $ u = \alpha p^{-n} $.
\end{proof}

Hensel's lemma is Newton-Raphson in $ \QQ_p $. A reminder that if $ k $ is any field, and $ f\br{X} \in k\sbr{X} $, then we can define $ f'\br{X}, f''\br{X}, \dots $ formally by $ \tod{}{x}\br{X^n} = nX^{n - 1} $.

\begin{theorem}[Hensel's lemma]
Let $ k $ be a non-archimedean field with norm $ \abs{\cdot} $ and $ R = \cbr{x \in k \st \abs{x} \le 1} $. For example, $ k = \QQ_p $, $ \abs{\cdot} = \abs{\cdot}_p $, and $ R = \ZZ_p $. Suppose $ f \in R\sbr{X} $, and $ t_0 \in R $ such that $ \abs{f\br{t_0}} < \abs{f'\br{t_0}}^2 $. Then there exists a unique $ t \in R $ such that
$$ f\br{t} = 0, \qquad \abs{t - t_0} < \abs{f'\br{t_0}}. $$
Furthermore
$$ \abs{f'\br{t}} = \abs{f'\br{t_0}}, \qquad \abs{t - t_0} = \dfrac{\abs{f\br{t_0}}}{\abs{f'\br{t_0}}}. $$
\end{theorem}

\begin{proof}
Construct a Cauchy sequence $ t_0, t_1, \dots $ by
$$ t_{n + 1} = t_n - \dfrac{f\br{t_n}}{f'\br{t_n}}. $$
It turns out that $ \abs{f'\br{t_n}} = \abs{f'\br{t_0}} $, so
$$ \abs{\dfrac{f\br{t_n}}{f'\br{t_0}}} = \abs{\dfrac{f\br{t_n}}{f'\br{t_n}}} = \abs{t_{n + 1} - t_n} \to 0, $$
that is $ f\br{t_n} \to 0 $, that is $ f\br{t} = 0 $.
\end{proof}

\begin{lemma}
If $ f\br{X} \in R\sbr{X} $ has a simple root $ X = t \in R $, then for any $ t_0 \in k $ with $ \abs{t - t_0} < \abs{f'\br{t}} $, we have
$$ \abs{f'\br{t}} = \abs{f'\br{t_0}}, \qquad \abs{f\br{t_0}} < \abs{f'\br{t_0}}^2. $$
\end{lemma}

\begin{exercise}
The equation $ X^2 = 7 $ has a solution in $ \ZZ_3 $. Take $ f\br{X} = X^2 - 7 $. Then $ f'\br{X} = 2X $. So $ \abs{f'\br{X}}_3 = \abs{X}_3 $. So we need to find $ t_0 $ such that $ \abs{t_0^2 - 7}_3 < \abs{t_0}_3^2 $. For example, choose $ t_0 \in \ZZ $ such that $ 3 \nmid t_0 $ and $ t_0^2 \equiv 7 \mod 3 $, for example $ t_0 = 1 $. Hensel's lemma implies that there exists a unique $ t \in \ZZ_3 $ such that $ t^2 = 7 $ and $ \abs{t - 1}_3 < 1 $, that is $ t \equiv 1 \mod 3 $. In the same way, show that there exists a unique $ s \in \ZZ_3 $ such that $ s^2 = 7 $ and $ s \equiv 2 \mod 3 $. In fact $ s = -t $, since $ \br{-t}^2 = t^2 $ and $ X^2 - 7 = \br{X - t}\br{X + t} $.
\end{exercise}

\begin{corollary}
Let $ u \in \ZZ_p^\times $. If $ p > 2 $, then $ u $ is a square if and only if it is a square modulo $ p $. If $ p = 2 $, then $ u $ is a square if and only if it is a square modulo $ 8 $, if and only if $ u \equiv 1 \mod 8 $.
\end{corollary}

\begin{proof}
Exercise. \footnote{Exercise}
\end{proof}

\pagebreak

\section{Basic algebraic geometry}

\lecture{5}{Monday}{14/10/19}

An affine \textbf{algebraic curve} over $ k $ is an equation
$$ f\br{x, y} = 0, \qquad 0 \ne f \in k\sbr{x, y}. $$
The \textbf{degree} $ n = \deg f \in \NN_{> 0} $ of this curve is the total degree, so if $ f\br{x, y} = \sum_{i, j = 0}^n a_{ij}x^iy^j $, then
$$ \deg f = \max\cbr{i + j \st a_{ij} \ne 0}. $$
Algebraic curves of degree one are \textbf{lines}. Algebraic curves of degree two are \textbf{conics}. Two curves $ x = 0 $ and $ y = f\br{x} $ for $ f\br{x} \in k\sbr{x} $ have intersection points the zeroes of $ f\br{x} $, and a non-zero polynomial of degree $ n $ has $ n $ roots, but $ f\br{x} = x^2 + 1 $ has no real zeroes, so need to work over $ \CC $ or some algebraically closed field.

\begin{definition}
A field $ k $ is \textbf{algebraically closed} if any non-zero polynomial $ f\br{x} \in k\sbr{x} $ has a zero in $ k $.
\end{definition}

By induction on the degree,
$$ f\br{x} = a_n\prod_{j = 1}^n \br{x - \alpha_j}, \qquad a_n, \alpha_j \in k. $$
B\'ezout's theorem states that two algebraic curves of degree $ d_1 $ and $ d_2 $ respectively have $ d_1d_2 $ common points.
\begin{itemize}
\item We need to assume that $ k $ is algebraically closed. For example, the \textbf{fundamental theorem of algebra}, by Gauss, states that $ \CC $ is algebraically closed.
\item We need to count multiplicities. There is a definition given for multiplicity. For example, if $ \underline{0} = \br{0, 0} $ is the intersection point of two curves $ f\br{x, y} = 0 $ and $ g\br{x, y} = 0 $ for $ f, g \in \CC\sbr{x, y} $, so $ f\br{\underline{0}} = g\br{\underline{0}} = 0 $, then the \textbf{multiplicity} at $ \underline{0} $ is
$$ \dim_\CC \CC\sbr{\sbr{x, y}} / \abr{f, g} < \infty. $$
\item We need to enlarge the plane to contain points at infinity. For example, the \textbf{real projective plane}
$$ \PP^2\br{\RR} = \RR^2 \cup \cbr{\text{points at infinity}} $$
is the equivalence classes of affine lines through $ \RR^2 $ modulo parallelism, where if $ l_1, l_2 \in \RR^2 $, then $ l_1 $ is parallel to $ l_2 $ if and only if $ l_1 \cap l_2 = \emptyset $ or $ l_1 = l_2 $, which is an equivalence relation. There is an injection from points in $ \cbr{y = 1} $ to affine lines through $ \underline{0} $, and for any class of parallel affine lines on $ \cbr{y = 1} $ there exists a unique line going through $ \underline{0} $ and parallel to these lines, so
$$ \PP^2\br{\RR} = \cbr{\text{lines from} \ \cbr{y = 1}} \cup \cbr{\text{lines parallel to} \ \cbr{y = 1}}. $$
This collection of subsets are called \textbf{projective lines}, which are two-dimensional subspaces in $ \RR^3 $, and points are one-dimensional subspaces in $ \RR^3 $. The set of points at infinity is a projective line, and any affine line $ l \subset \RR^2 $ gives a projective line $ l^\# = l \cup \cbr{\text{parallelism class}} $. Thus any two different projective lines intersect in exactly one point, and this definition makes sense for any field.
\end{itemize}

The following is an equivalent description of $ \PP^2\br{k} $. Let $ k $ be any field. Then
$$ \PP^2\br{k} = k^3 \setminus \cbr{\underline{0}} / \sim $$
is the equivalence classes $ \br{x_0, x_1, x_2} $ such that $ x_i \in k $ are not all zero modulo $ \sim $, where $ \underline{x} \sim \underline{y} $ if and only if $ \underline{x} = \lambda \cdot \underline{y} $ for $ \lambda \in k \setminus \cbr{\underline{0}} = k^* $.

\begin{definition}
The \textbf{projective $ n $-space} is
$$ \PP^n\br{k} = k^{n + 1} \setminus \cbr{\underline{0}} / \sim. $$
\end{definition}

\begin{notation}
The \textbf{homogeneous coordinates} $ \sbr{x_0 : \dots : x_n} $ is an equivalence class of non-zero vectors in $ k^{n + 1} $ modulo $ \sim $, so
$$ \PP^n\br{k} = \cbr{\sbr{x_0 : \dots : x_n} \st x_i \in k \ \text{not all zero}}. $$
\end{notation}

\pagebreak

\begin{definition}
The \textbf{affine $ n $-space} is
$$ \AA^n\br{k} = k^n. $$
\end{definition}

\begin{lemma}
Let
$$ \function[\phi_i]{\AA^n\br{k}}{\PP^n\br{k}}{\br{x_0, \dots, x_{n - 1}}}{\sbr{x_0 : \dots : x_{i - 1} : 1 : x_{i + 1} : \dots : x_{n - 1}}}. $$
Then $ \phi_i $ is injective, and
$$ \PP^n\br{k} = \bigcup_{i = 0}^n \Im \phi_i. $$
\end{lemma}

\begin{proof}
Obvious.
\end{proof}

\begin{exercise}
There is an isomorphism
$$ \function{\PP^{n - 1}\br{k}}{\PP^n\br{k} \setminus \phi_n\br{\AA^n\br{k}}}{\sbr{x_0 : \dots : x_{n - 1}}}{\sbr{x_0 : \dots : x_{n - 1} : 0}}. $$
\end{exercise}

\begin{definition}
The \textbf{points at infinity} of $ \PP^n\br{k} $ are the ones not in $ \phi_n\br{\AA^n\br{k}} $. They are recognisable as the graph of $ X_n = 0 $.
\end{definition}

\lecture{6}{Tuesday}{15/10/19}

Let $ \lambda : k^{n + 1} \to k $ be a non-trivial linear function. The image of
$$ \Ker \lambda = \cbr{\alpha_0x_0 + \dots + \alpha_nx_n = 0 \st \br{x_0, \dots, x_n} \in k^{n + 1}, \ \text{not all} \ \alpha_i \in k \ \text{are zero}} \subset \PP^n\br{k} $$
with respect to the quotient map $ k^{n + 1} \setminus \cbr{\underline{0}} \twoheadrightarrow \PP^n\br{k} $ is a \textbf{linear hyperplane}. This can be generalised by taking homogeneous polynomials in general.

\begin{definition}
A polynomial $ F\br{X_0, \dots, X_n} \in k\sbr{X_0, \dots, X_n} $ is \textbf{homogeneous} of degree $ d \in \NN $ if
$$ F\br{X_0, \dots, X_n} = \sum \alpha_{i_0 \dots i_n}X_0^{i_0} \dots X_n^{i_n}, \qquad i_0 + \dots + i_n = d, $$
so you only have degree $ d $ terms.
\begin{itemize}
\item If $ f $ is a degree $ d $ polynomial in $ k\sbr{x_1, \dots, x_n} $, then here is how to \textbf{homogenise} it. Change $ x_i $ to $ X_i $ and then introduce a new variable $ X_0 $ and multiply each term with a suitable power of $ X_0 $ such that the resulting polynomial is homogeneous of the smallest possible degree.
\item If $ F $ is a degree $ d $ homogeneous polynomial in $ k\sbr{X_0, \dots, X_n} $, then here is how to \textbf{dehomogenise} it. Choose $ i $ with $ 0 \le i \le n $, set $ X_i = 1 $ and change all the other $ X_j $ to $ x_j $. If we chose $ i = 0 $ then this recovers the initial equation.
\end{itemize}
If $ f \in k\sbr{x_1, \dots, x_n} $ then the \textbf{points at infinity} of $ f = 0 $ are the zeroes of $ F $, the homogenisation of $ f $, which are in $ \PP^n\br{k} $ but not in $ \AA^n\br{k} $.
\end{definition}

If $ F \in k\sbr{X_0, \dots, X_n} $ is homogeneous of degree $ d $, then
$$ \Z\br{F} = \cbr{\sbr{x_0 : \dots : x_n} \in \PP^n\br{k} \st F\br{x_0, \dots, x_n} = 0} $$
does not depend on the representative. Homogenisation allows us to extend an algebraic subset in $ \AA^n\br{k} $ to $ \PP^n\br{k} $.

\begin{example*}
\hfill
\begin{itemize}
\item $ X^2 + YZ + Z^2 = 0 $ is homogeneous of degree two and gives rise to a conic in $ \PP^2\br{k} $.
\item $ x^2 + x^3 = y^2 $ and $ xy = 1 $ homogenises to $ X^2Z + X^3 = Y^2Z $ and $ XY = Z^2 $.
\item $ X^2 + Y^2 = Z^2 $ and $ YZ = X^2 $ dehomogenises to $ x^2 + y^2 = 1 $ and $ y = x^2 $.
\end{itemize}
\end{example*}

\pagebreak

\begin{theorem}[B\'ezout's theorem]
If $ F, G \in k\sbr{X_0, X_1, X_2} $ be homogeneous non-zero polynomials of degree $ m $ and $ n $ respectively without common factors, so $ \gcd\br{f, g} = 1 $ up to associates, then
$$ \abs{\cbr{F = 0} \cap \cbr{G = 0}} = m \cdot n, $$
counted with multiplicities, where $ m \cdot n $ is always a positive integer.
\end{theorem}

Let $ \overline{k} $ be the \textbf{algebraic closure} of $ k $, the smallest algebraically closed field containing $ k $.

\begin{example*}
\hfill
\begin{itemize}
\item $ \overline{\QQ} $ is a subfield of $ \CC $.
\item If $ k $ is algebraically closed, then $ k = \overline{k} $, so $ \overline{\CC} = \CC $, and $ \overline{\RR} = \CC $.
\item If $ K $ is a field and $ \CCC $ is a collection of subfields $ k \in \CCC $ such that $ k $ are algebraically closed, then $ \bigcap_{k \in \CCC} k \subseteq K $ is an algebraically closed subfield.
\end{itemize}
\end{example*}

\begin{corollary}
If $ F $ and $ G $ are two homogeneous polynomials of degree $ a $ and $ b $ in $ k\sbr{X, Y, Z} $, for $ k $ any field not necessarily algebraically closed, then either the graphs of $ F = 0 $ and $ G = 0 $ in $ \PP^2\br{k} $ have at most $ ab $ points in common, or $ F $ and $ G $ have a common factor.
\end{corollary}

\begin{proof}
Immediate from B\'ezout applied to $ \overline{k} $.
\end{proof}

\begin{definition}
Let $ k $ be a field of $ \ch k \nmid d $, and let $ f \in k\sbr{x_1, \dots, x_n} $ be a polynomial of degree $ d > 0 $. Let $ P \in \AA^n\br{k} $ be a point on $ f = 0 $, that is $ f\br{P} = 0 $. Then we say that $ P $ is a \textbf{smooth point} or \textbf{non-singular point} if one of the partial derivatives of $ f $ does not vanish at $ P $, that is if there exists some $ i $ with $ 1 \le i \le n $ such that $ \tpd{f}{x_i}\br{P} = 0 $. Note that the definition of a partial derivative is formal, not a limiting process. We say that $ P $ is a \textbf{singular point} if all the partial derivatives vanish at $ P $.
\end{definition}

\begin{definition}
Let $ k $ be a field of $ \ch k \nmid d > 0 $, and let $ F \in k\sbr{X_0, \dots, X_n} $ be a homogeneous polynomial of degree $ d $. Let $ P \in \PP^n\br{k} $. Then $ P $ is a \textbf{singular point} of $ F = 0 $ if any of the following conditions is true.
\begin{itemize}
\item $ \tpd{F}{X_i}\br{P} = 0 $ for $ i = 0, \dots, n $.
\item $ F\br{P} = 0 $ and $ \tpd{F}{X_i}\br{P} = 0 $ for $ i = 0, \dots, n $.
\item For some of $ \phi_i : \AA^n\br{k} \to \PP^n\br{k} $ such that $ P = \phi_i\br{p} $ for some $ p \in \AA^n\br{k} $, if $ f $ is a dehomogenisation of $ F $ then $ f\br{p} = 0 $ and $ \tpd{f}{x_i}\br{p} = 0 $ for all $ i $.
\end{itemize}
\end{definition}

\begin{definition}
If $ k $ is as above, then $ f = 0 $ or $ F = 0 $ is \textbf{non-singular} in $ \AA^n\br{k} $ or $ \PP^n\br{k} $ if it has no singular points over $ \overline{k} $.
\end{definition}

\begin{example*}
$ x^3 = y^2 $ is a singular curve.
\end{example*}

\lecture{7}{Thursday}{17/10/19}

Lecture 7 is a problem class.

\lecture{8}{Monday}{21/10/19}

We need to compute the multiplicity up to some precision. Let $ f \in k\sbr{x, y} $, and let $ P \in \AA^2\br{k} $ such that $ f\br{P} = 0 $. If $ P = \br{a_1, a_2} $ is non-singular, the \textbf{tangent line} of $ f = 0 $ at $ P $ is
$$ \dpd{f}{x}\br{P}\br{x - a_1} + \dpd{f}{y}\br{P}\br{y - a_2} = 0. $$
This is a non-zero equation, by definition, so not both $ \tpd{f}{x}\br{P} $ and $ \tpd{f}{y}\br{P} $ is zero. Let $ f, g \in k\sbr{x, y} $ be non-zero polynomials as above, where $ f\br{P} = g\br{P} = 0 $. We say that $ f = 0 $ and $ g = 0 $ \textbf{intersect transversely} at $ P $ if the tangent lines of $ f = 0 $ and $ g = 0 $ at $ P $ are different.

\begin{theorem}
If $ f\br{P} = g\br{P} = 0 $ then the multiplicity at $ P $ is one if and only if the intersection is transversal at $ P $.
\end{theorem}

\pagebreak

\section{Plane conics}

Let $ X^2 + Y^2 = Z^2 $. If $ \br{a, b, c} \in \ZZ^3 $ is a solution, then $ \br{\lambda a, \lambda b, \lambda c} $ is a solution for $ \lambda \in \ZZ $. A \textbf{primitive solution} has $ \gcd\br{a, b, c} = \pm 1 $. Any solution can be written as a rescaling of a primitive solution by an integer.

\begin{algorithm}[To find out if a plane conic is singular]
Say $ f \in k\sbr{x, y} $ is degree two. Then $ \tpd{f}{x} $ and $ \tpd{f}{y} $ are both linear so will meet in at least one point, possibly at infinity. Just check whether this point is on $ f = 0 $.
\end{algorithm}

By diagonalisation of quadratic forms, if $ \ch k \ne 2 $, then for $ F \in k\sbr{X_0, X_1, X_2} $ of degree two homogeneous, after rescaling by a non-zero scalar, and a permutation of variables, we can assume that
$$ F\br{X_0, X_1, X_2} = \alpha_0X_0^2 + \alpha_1X_1^2 + \alpha_2X_2^2. $$

\begin{theorem}
The following are equivalent.
\begin{enumerate}
\item $ F = 0 $ is singular.
\item $ \alpha_0 \cdot \alpha_1 \cdot \alpha_2 = 0 $.
\item $ F $ is the product of two linear polynomials over the algebraic closure.
\end{enumerate}
\end{theorem}

\begin{proof}
$ F = 0 $ is non-singular if and only if the equations $ 2\alpha_iX_i = \tpd{F}{X_i} = 0 $ for all $ i $ has no non-zero simultaneous zeroes in $ k^{n + 1} $, if and only if not all $ \alpha_i $ are zero, so $ 1 $ and $ 2 $ are equivalent. Let us assume $ 2 $. After permuting variables
$$ F = \alpha_0X_0^2 + \alpha_1X_1^2 = \br{\sqrt{\alpha_0}X_0 + i\sqrt{\alpha_1}X_1}\br{\sqrt{\alpha_0}X_0 - i\sqrt{\alpha_1}X_1}, $$
so $ 2 $ implies $ 3 $. Converse $ 3 $ implies $ 2 $ is an exercise. \footnote{Exercise}
\end{proof}

\begin{algorithm}[To find all $ k $-points of a singular plane conic]
Factor the conic into linear factors, possibly over an extension of $ k $, and then find all the $ k $-points on the lines.
\end{algorithm}

\lecture{9}{Tuesday}{22/10/19}

\begin{algorithm}[To find all $ k $-points on a non-singular plane conic from one point]
Let $ k $ be any field of $ \ch k \ne 2 $, and let $ C \ne \emptyset $ be a conic $ F = 0 $ over $ k $ for a degree two homogeneous polynomial $ F \in k\sbr{X, Y, Z} $ such that $ F = 0 $ is non-singular. If $ O \in C $, then we can construct a bijection between points over $ k $ in $ C $ and points on a projective line over $ k $ not containing $ O $.
\end{algorithm}

\begin{proof}
Let $ \pi\br{P} $ be the projection of $ O $ through $ P $ onto a line $ l $ not containing $ O $. Claim that $ P \mapsto \pi\br{P} $ is a well-defined map. Any line can intersect $ C $ only at most two points, and it intersects $ C $ in exactly one point if and only if it is a tangent.
\begin{itemize}
\item If $ P \ne O $, then there is a unique line $ \overrightarrow{OP} $ between $ O $ and $ P $. Then $ \overrightarrow{OP} $ and $ l $ are different as $ l $ does not contain $ O $, but $ \overrightarrow{OP} $ does, so $ \overrightarrow{OP} \cap l $ is one point $ \pi\br{P} $, so $ \pi\br{P} $ is well-defined in this case.
\item The tangent line of $ C $ at $ O $ intersects $ C $ at $ O $ with multiplicity at least two, so it does not intersect $ C $ in any other point, but it still has a unique intersection point with $ l $, so I take the latter to be $ \pi\br{O} $.
\end{itemize}
Claim that $ P \mapsto \pi\br{P} $ is a bijection.
\begin{itemize}
\item The map is injective, since if $ \pi\br{P} = \pi\br{P'} $, then $ \overrightarrow{OP} = \overrightarrow{OP'} $, so $ P, P', O \in \overrightarrow{OP} \cap C $, so $ P = P' $.
\item The map is surjective. If $ O \ne Q \in l $, then there is another intersection point in $ \overrightarrow{OQ} \cap C $ over the algebraic closure. The bad thing is that the line intersects $ C $ in two points over the algebraic closure, neither of which is a rational point. Claim that if $ 0 \ne h \in k\sbr{x} $ has degree two, and it has a root over $ k $, then its other root is also defined over $ k $. Let $ h = ax^2 + bx + c $. There exists $ \alpha \in k $ such that $ h\br{\alpha} = 0 $, so I can factor out $ x - \alpha $, so $ h = \br{x - \alpha}g $ for $ g \in k\sbr{x} $. Then $ \deg g = 1 $, so $ g = a\br{x - \beta} $ for $ \beta \in k $, so $ \beta $ is the other root. Thus the other intersection point is another point $ P \in C $.
\end{itemize}
\end{proof}

\begin{corollary}
If $ k $ is infinite, then either $ C $ has no points, or it has infinitely many.
\end{corollary}

\pagebreak

\section{The Hasse principle for smooth plane conics over \texorpdfstring{$ \QQ $}{Q}}

\lecture{10}{Thursday}{24/10/19}

Let $ C $ be a conic $ aX^2 + bY^2 + cZ^2 = 0 $ over $ \RR $. We rescale each of $ a, b, c $ by a non-zero square. Over $ \RR $ we can assume $ \cbr{a, b, c} = \cbr{1, -1} $. There are two cases.
\begin{itemize}
\item If $ X^2 + Y^2 + Z^2 = 0 $, then $ C\br{\RR} = \emptyset $.
\item If $ X^2 + Y^2 - Z^2 = 0 $, then $ C\br{\RR} \ne \emptyset $.
\end{itemize}
Let $ C $ be a conic $ aX^2 + bY^2 + cZ^2 = 0 $ over $ \QQ_p $ such that $ p $ is an odd prime. After rescaling by a square I can assume that $ a, b, c \in \ZZ_p $. Then $ \abs{a}_p, \abs{b}_p, \abs{c}_p \le 1 $. By rescaling by a non-zero even power of $ p $, I can assume the following two cases.
\begin{itemize}
\item If $ \abs{a}_p, \abs{b}_p, \abs{c}_p = 1 $, then $ C $ is non-singular. As $ a, b, c \in \ZZ_p $, I can reduce the equation modulo $ p $. Pick $ x \ne 0 $, and let
$$ A = \cbr{ax^2 + by^2 \st y \in \FF_p}. $$
Assume $ A \subseteq \FF_p^* $, otherwise for some $ y $, $ ax^2 + by^2 + c0^2 = 0 $. If $ ax^2 + by^2 = ax^2 + by'^2 $, then $ y^2 = y'^2 $, so $ y = y' = 0 $ or $ y = -y' \ne 0 $, so $ \abs{A} = \br{p + 1} / 2 $. Let
$$ B = \cbr{-cz^2 \st z \in \FF_p}. $$
Similarly $ \abs{B} = \br{p + 1} / 2 $. If the equation has no solutions, then $ A \cap B = \emptyset $, so
$$ p - 1 = \abs{\FF_p^*} \ge \abs{A \cup B} = \abs{A} + \abs{B} = \dfrac{p + 1}{2} + \dfrac{p + 1}{2} = p + 1, $$
a contradiction. Then $ C $ has a point over $ \FF_p $, so it has a non-zero solution by Hensel's lemma. Thus $ C $ has a point over $ \QQ_p $.
\item If $ \abs{c}_p = 1 / p $ and $ \abs{a}_p, \abs{b}_p = 1 $, then $ C $ is singular, and we could still use Hensel's lemma.
\end{itemize}
Let $ C $ be a conic $ aX^2 + bY^2 + cZ^2 = 0 $ over $ \QQ $. I can assume that
\begin{itemize}
\item $ a, b, c \in \ZZ $, by rescaling,
\item $ a, b, c $ are relatively prime, by rescaling,
\item $ a, b, c $ are square-free, since we can rescale individual variables by squares, and
\item $ a, b, c $ are pairwise relatively prime, since if $ p $ is a prime number such that $ p \mid a $ and $ p \mid b $, then $ pa $ and $ pb $ are divisible by $ p^2 $, so I absorb the $ p^2 $ into $ X $ and $ Y $.
\end{itemize}
Now just by looking at the signs you can tell whether $ C $ has a solution or not over the reals, and just by looking at the valuations you can tell whether $ C $ has a solution or not over the individual $ p $-adic fields, but what can we say about the solutions of $ C $ over the rationals?

\begin{lemma}
\label{lem:5.1}
Let $ U \subseteq \RR^n $ be a measurable set, for example open, and assume that it has measure $ \mu\br{U} > m \in \NN_{> 0} $. Then there exist $ c_0, \dots, c_m \in U $ such that $ c_i - c_0 \in \ZZ^n \subset \RR^n $ for all $ i = 1, \dots, m $.
\end{lemma}

\begin{proof}
Let $ C = \intco{0, 1}^n \subseteq \RR^n $. Then $ C $ is measurable and $ \mu\br{C} = 1 $, and $ C + \ZZ^n = \RR^n $. For any set $ X \subseteq \RR^n $ let
$$ \chi_X\br{\underline{t}} =
\begin{cases}
1 & \underline{t} \in X \\
0 & \underline{t} \notin X
\end{cases}
$$
be the characteristic function of $ X $. Then
$$ m < \mu\br{U} = \intd{\RR^n}{}{\chi_U\br{\underline{t}}}{\underline{t}} = \sum_{\underline{x} \in \ZZ^n} \intd{\RR^n}{}{\chi_{\br{C + \underline{x}} \cap U}\br{\underline{t}}}{\underline{t}} = \intd{\RR^n}{}{\sum_{\underline{x} \in \ZZ^n} \chi_{\br{C + \underline{x}} \cap U}\br{\underline{t}}}{\underline{t}} = \intd{C}{}{\sum_{\underline{x} \in \ZZ^n} \chi_{C - \underline{x}}\br{\underline{t}}}{\underline{t}}. $$
The function $ \sum_{\underline{x} \in \ZZ^n} \chi_{C - \underline{x}}\br{\underline{t}} $ is a counting function
$$ \underline{x} \in C \mapsto \abs{\cbr{\underline{y} \in U \st \underline{x} - \underline{y} \in \ZZ^n}}, $$
which is an integer-valued measurable function, and if $ \underline{x} < m $ for all points, then its integral over $ C $ is less than $ m $, a contradiction. Thus there exists $ \underline{x} \in C $ such that $ \abs{\underline{x} + \ZZ^n \cap U} > m $.
\end{proof}

\pagebreak

\begin{definition}
\hfill
\begin{itemize}
\item $ U \subseteq \RR^n $ is \textbf{symmetric} if for all $ \underline{x} \in U $, $ -\underline{x} \in U $.
\item $ U \subseteq \RR^n $ is \textbf{convex} if for all $ \underline{x}, \underline{y} \in U $, there exists $ t \in \sbr{0, 1} $ such that $ t\underline{x} + \br{1 - t}\underline{y} \in U $.
\end{itemize}
\end{definition}

\begin{corollary}[Minkowski's geometry of numbers]
\label{cor:5.3}
Let $ \Lambda \subseteq \RR^n $ be a subgroup of finite index $ m $. Let $ U \subseteq \RR^n $ be an open, convex, symmetric set of $ \mu\br{U} > 2^n \cdot m $. Then $ \Lambda \cap U \ne \emptyset $.
\end{corollary}

\begin{proof}
Let
$$ V = \dfrac{1}{2}U = \cbr{\tfrac{1}{2}\underline{x} \st \underline{x} \in U}, $$
so $ \mu\br{V} = 2^{-n} \cdot \mu\br{U} > m $. So by the Lemma \ref{lem:5.1} there exist $ c_o, \dots, c_m \in V $ such that $ c_i - c_0 \in \ZZ^n $ for all $ i = 0, \dots, m $. By the pigeonhole principle, as
$$ \abs{\cbr{c_i - c_0 \st i = 0, \dots, m}} = m + 1 > \sbr{\ZZ^n : \Lambda}, $$
there exist $ i \ne j $ such that $ c_i - c_0 \equiv c_j - c_0 \mod \Lambda $, so $ c_i - c_j = \br{c_i - c_0} - \br{c_j - c_0} \in \Lambda $. Then $ 2c_i \in U $, and $ -2c_i \in -U = U $ by symmetry of $ U $, so $ \tfrac{1}{2}\br{2c_i} + \tfrac{1}{2}\br{-2c_j} \in U $, as $ U $ is convex.
\end{proof}

\begin{theorem}
If $ n \in \ZZ_{> 0} $ such that there exists $ t $ with $ t^2 \equiv 1 \mod n $, then $ n $ is a sum of two squares.
\end{theorem}

\begin{proof}
Define
$$ \Gamma = \cbr{\br{x, y} \st y \equiv tx \mod n} \subseteq \ZZ^2. $$
This has index $ n $, because it is the kernel of
$$ \function{\ZZ^2}{\ZZ / n\ZZ}{\br{x, y}}{y - tx}. $$
Let
$$ V = \cbr{\br{x, y} \in \RR^2 \st x^2 + y^2 < 2n}. $$
Then
$$ \mu\br{V} = 2n \cdot \pi > 4n = 2^2 \cdot n = 2^2 \cdot \sbr{\ZZ^2 : \Lambda}. $$
Corollary \ref{cor:5.3} implies that there exists $ \br{x, y} \in V \cap \Lambda $ such that $ \br{x, y} \ne \br{0, 0} $. Then $ \br{x, y} \in V $ implies that $ x^2 + y^2 < 2n $, and $ \br{x, y} \in \Lambda $ implies that $ y \equiv tx \mod n $, so
$$ x^2 + y^2 \equiv x^2 + \br{tx}^2 \equiv x^2\br{t^2 + 1} \equiv 0 \mod n. $$
So $ x^2 + y^2 = n $.
\end{proof}

\lecture{11}{Monday}{28/10/19}

\begin{theorem}[Hasse-Minkowski]
Let $ C $ be
$$ f = aX^2 + bY^2 + cZ^2 = 0, \qquad a, b, c \in \ZZ, \qquad abc \ne 0, \qquad \br{a, b} = \br{b, c} = \br{c, a} = 1, $$
where $ a, b, c $ are square-free. Let $ \Sigma = \cbr{p \mid 2abc} $. Then the following are equivalent.
\begin{enumerate}
\item $ C $ has infinitely many solutions in $ \PP^2\br{\QQ} $.
\item $ C $ has a solution in $ \PP^2\br{\QQ} $.
\item $ C $ has a solution in $ \PP^2\br{\QQ_p} $ for all $ p $, and in $ \PP^2\br{\RR} $.
\item $ C $ has a solution in $ \PP^2\br{\QQ_p} $ for all $ p \in \Sigma $.
\end{enumerate}
\end{theorem}

The problem of solving conics over $ \QQ $ is algorithmically decidable, so there is a computer program which solves this problem.

\pagebreak

\begin{proof}
$ 1 $ implies $ 2 $ implies $ 3 $ implies $ 4 $, and we proved $ 2 $ implies $ 1 $, so $ 4 $ implies $ 2 $ is enough. Assume $ 4 $. Claim that if $ p \mid a $, then there is a solution to
$$ b + cz^2 \equiv 0 \mod p. $$
By $ 4 $, there exists $ \br{x, y, z} \in \PP^2\br{\QQ_p} $ with $ ax^2 + by^2 + cz^2 = 0 $. Without loss of generality $ x, y, z \in \ZZ_p $, not all divisible by $ p $. If $ \abs{y}_p < 1 $ then $ cz^2 = -\br{ax^2 + by^2} \equiv 0 \mod p $, so $ \abs{z}_p < 1 $, then $ \abs{ax^2}_p \le 1 / p^2 $, so $ \abs{x}_p < 1 $, a contradiction. So $ \abs{y}_p = 1 $, so $ a\br{x / y}^2 + b + c\br{z / y}^2 = 0 $, with $ x / y, z / y \in \ZZ_p $. Then
$$ b + c\br{z / y}^2 \equiv 0 \mod p. $$
\begin{itemize}
\item Now assume that $ p $ is odd and $ p \mid a $. Then let $ \alpha \in \ZZ / p\ZZ $ be a solution to $ b + c\alpha^2 \equiv 0 \mod p $, and impose the condition
$$ \alpha s + t \equiv 0 \mod p. $$
Then $ ar^2 + bs^2 + ct^2 \equiv bs^2 + ct^2 \equiv bs^2 + c\br{\alpha s}^2 \equiv s^2\br{b + c\alpha^2} \equiv 0 \mod p $. If $ p $ is odd and $ p \mid b $ or $ p \mid c $, impose the analogous conditions.
\item Now assume that $ p = 2 $.
\begin{itemize}
\item Let $ 2 \mid a $, or by symmetry $ 2 \mid b $ or $ 2 \mid c $. We will write a condition to ensure that $ ar^2 + bs^2 + ct^2 \equiv 0 \mod 8 $. We saw in the proof of the claim that there exist $ x, y, z \in \ZZ_2 $ with $ \abs{x}_2 \le 1 $ and $ \abs{y}_2 = \abs{z}_2 = 1 $, and $ ax^2 + by^2 + cz^2 = 0 $. Then $ ax^2 + by^2 + cz^2 \equiv ax^2 + b + c \mod 8 $, that is $ ax^2 + b + c \equiv 0 \mod 8 $.
\begin{itemize}
\item If $ \abs{x}_2 = 1 $, then $ a + b + c \equiv 0 \mod 8 $. Impose
$$ s \equiv t \mod 4, \qquad r \equiv s \mod 2. $$
Then either $ r, s, t $ all odd, and $ ar^2 + bs^2 + ct^2 \equiv a + b + c \equiv 0 \mod 8 $, or $ r, s, t $ all even, and $ ar^2 + bs^2 + ct^2 \equiv bs^2 + ct^2 \equiv 4\br{b + c} \equiv -4a \equiv 0 \mod 8 $.
\item If $ \abs{x}_2 < 1 $, then $ ax^2 + b + c \equiv b + c \mod 8 $, that is $ b + c \equiv 0 \mod 8 $. Impose
$$ s \equiv t \mod 4, \qquad r \equiv 0 \mod 2. $$
Then $ ar^2 + bs^2 + ct^2 \equiv bs^2 + ct^2 \equiv bs^2 + cs^2 \equiv \br{b + c}s^2 \equiv 0 \mod 8 $.
\end{itemize}
\item Let $ 2 \nmid abc $. Let $ \br{x, y, z} \in \PP^2\br{\QQ_2} $ with $ ax^2 + by^2 + cz^2 = 0 $. Assume $ \max\br{\abs{x}_2, \abs{y}_2, \abs{z}_2} = 1 $. Then $ ax^2 + by^2 + cz^2 \equiv 0 \mod 2 $, that is $ x^2 + y^2 + z^2 \equiv 0 \mod 2 $. Then exactly one of $ x, y, z $ is even, without loss of generality $ \abs{x}_2 < 1 $ and $ \abs{y}_2 = \abs{z}_2 = 1 $. Then $ 0 = ax^2 + by^2 + cz^2 \equiv by^2 + cz^2 \equiv b + c \mod 4 $. Impose conditions
$$ r \equiv 0 \mod 2, \qquad s \equiv t \mod 2. $$
Then $ ar^2 + bs^2 + ct^2 \equiv bs^2 + ct^2 \equiv \br{b + c}s^2 \equiv 0 \mod 4 $.
\end{itemize}
\end{itemize}
Let $ \Lambda \subseteq \ZZ^3 $ be the subgroup defined by all of these congruence conditions for $ p \in \Sigma $. Then
$$ \sbr{\ZZ^3 : \Lambda} = \abs{4abc} = 4\prod_{p \mid abc} p, $$
using the Chinese remainder theorem. If $ \br{r, s, t} \in \Lambda $ then $ ar^2 + bs^2 + ct^2 \equiv 0 \mod 4abc $. Let
$$ V = \cbr{\abs{a}X^2 + \abs{b}Y^2 + \abs{c}Z^2 < 4\abs{abc}}. $$
If $ \br{r, s, t} \in \Lambda \cap V $ then $ \abs{ar^2 + bs^2 + ct^2} < 4\abs{abc} $, so $ ar^2 + bs^2 + ct^2 = 0 $. By Corollary \ref{cor:5.3}, we just need to check that $ \mu\br{V} > 2^3 \cdot \abs{4abc} $, and
$$ \mu\br{V} = \dfrac{\tfrac{4}{3}\pi\sqrt{\abs{4abc}}^3}{\sqrt{\abs{abc}}} = \dfrac{\pi}{3} \cdot 2^3 \cdot \abs{4abc} > 2^3 \cdot \abs{4abc}. $$
\end{proof}

\begin{remark}
Let $ X \subseteq \PP^n\br{\QQ} $ be a projective algebraic variety, such as hypersurfaces or plane curves. The \textbf{local-global principle} holds for $ X $ if $ X\br{\QQ} \ne \emptyset $ if and only if $ X\br{\QQ_p} \ne \emptyset $ for all $ p $ prime number and $ X\br{\RR} \ne \emptyset $. Hasse-Minkowski implies that conics satisfy the local-global principle, but $ 3X^3 + 4Y^3 + 5Z^3 = 0 $ does not.
\end{remark}

\pagebreak

\section{Plane cubics}

\lecture{12}{Tuesday}{29/10/19}

\begin{definition}
A \textbf{plane cubic} is a cubic equation in two variables over a field, such as
\begin{itemize}
\item singular cubics over general fields, or
\item non-singular cubics, particularly over $ \QQ $, and $ \QQ_p $ and $ \FF_p $.
\end{itemize}
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ 3x^3 + 4y^3 = 5 $ has points over $ \QQ_p $ for all $ p $, and it also has points over $ \RR $, but it has no points over $ \QQ $.
\item $ x^3 + y^3 = 0 $ has lots of points over $ \QQ $, but it is singular, in fact $ x^3 + y^3 = \br{x + y}\br{x^2 - xy + y^2} $.
\item $ x^3 + y^2 = 0 $ is also singular, and does not factor, even over $ \CC $.
\item $ x^3 + y^3 = 1 $ has exactly two points over $ \QQ $, namely $ \br{1, 0} $ and $ \br{0, 1} $. This is a special case of Fermat's last theorem, $ a^3 + b^3 = c^3 $, where $ a, b, c \in \ZZ $ implies that $ abc = 0 $. This is a non-singular cubic with finitely many points over $ \QQ $, but not empty.
\item $ x^3 + y^3 = 9 $ has at least two points over $ \QQ $, $ \br{2, 1} $ and $ \br{1, 2} $.
\end{itemize}
\end{example*}

\begin{lemma}
There are non-singular plane cubics over $ \QQ $ with infinitely many points, such as $ x^3 + y^3 = 9 $.
\end{lemma}

The \textbf{height} of $ \sbr{x : y : z} \in \PP^2\br{\QQ} $ is $ \abs{z} $ provided that $ x, y, z \in \ZZ $ are coprime.

\begin{example*}
\hfill
\begin{itemize}
\item Height of $ \sbr{-\tfrac{17}{7} : \tfrac{20}{7} : 1} $ is $ 7 $.
\item Height of $ \sbr{1 : 2 : 1} $ is $ 1 $.
\end{itemize}
\end{example*}

\begin{proof}
Non-singular, since $ 3x^2 = 3y^2 = 0 $ implies that $ \br{x, y} = \br{0, 0} $, a contradiction. Draw tangent lines. For example, take the tangent line $ \br{x - 1} + 4\br{y - 2} = 0 $ at $ \br{1, 2} $, so $ 4y + x = 9 $. Then $ y^3 + \br{9 - 4y}^2 = 9 $ is $ -9\br{y - 2}^2\br{7y - 20} = 0 $, so $ \br{x, y} = \br{-17 / 7, 20 / 7} $. If $ \sbr{r : s : t} $ is a point on $ X^3 + Y^3 = 9Z^3 $, then the third point of intersection of the tangent line at $ \sbr{r : s : t} $ with this curve is
$$ \sbr{R : S : T} = \sbr{r\br{r^3 + 2s^3} : -s\br{2r^3 + s^3} : t\br{r^3 - s^3}}. $$
Claim that the height of $ \sbr{R : S : T} $ is greater than the height of $ \sbr{r : s : t} $. Assume that $ r, s, t \in \ZZ $ are coprime, and $ t > 0 $, so the height of $ \sbr{r : s : t} $ is $ t $. Then $ r^3 + s^3 = 9t^3 $ implies that $ \br{r, s} = \br{s, t} = \br{t, r} = 1 $, by considering any common prime factor, and using that $ 9 $ is not divisible by any cube. Let $ d $ be the GCD of $ R, S, T $. If $ p $ is a prime dividing both $ d $ and $ r $, then $ p \mid S $, so $ p \mid s^4 $, and $ p \mid s $. But $ \br{r, s} = 1 $, so this would be a contradiction, so $ \br{d, r} = 1 $. Since $ d \mid R $, we have $ d \mid \br{r^3 + 2s^3} $. Similarly, $ \br{d, s} = 1 $ and $ d \mid -S $, so $ d \mid \br{2r^3 + s^3} $. So $ d \mid 3\br{r^3, s^3} $, that is $ d \mid 3 $. So $ d \le 3 $, and the height of $ \sbr{R : S : T} $ is at least $ \abs{T / 3} $. So we just have to prove that $ \abs{r^3 - s^3} > 3 $. If not, then $ r, s = 0, \pm 1 $, which contradicts $ r^3 + s^3 = 9t^3 $ unless $ \sbr{r : s : t} = \sbr{1 : -1 : 0} $. The only way that we could reach this point is by starting at a point of the form $ \sbr{R : R : T} $, but then $ 2R^3 = 9T^3 $, which has no solutions.
\end{proof}

\begin{algorithm}
Suppose that $ C $ is a singular plane cubic over a field $ k $, and that there is a singular point $ P $ with coordinates in $ k $. Then there are infinitely many points of $ C $ over $ k $, provided $ k $ is infinite, and we can find them all by drawing lines through $ P $ with rational slope.
\end{algorithm}

\begin{proof}
Use B\'ezout exactly as for conics.
\end{proof}

\begin{remark}
If $ C $ is singular then provided that either $ k $ has characteristic zero, or $ k $ is a finite field, then any singular point has coordinates in $ k $.
\end{remark}

\begin{proof}
By B\'ezout, at most one singular point, and then use Galois theory.
\end{proof}

\begin{example}
\label{eg:6.5}
The \textbf{cusp} $ y^2 = x^3 $ is singular at $ \br{0, 0} $. Then $ y = tx $ gives $ x = t^2 $ and $ y = t^3 $.
\end{example}

\begin{example}
The \textbf{node} $ y^2 = x^2\br{x + 1} $. Then $ y = tx $ gives $ x = t^2 - 1 $ and $ y = t^3 - t $.
\end{example}

\lecture{13}{Thursday}{31/10/19}

Lecture 13 is a problem class.

\pagebreak

\lecture{14}{Monday}{04/11/19}

A cubic is \textbf{irreducible} if it does not have a linear factor.

\begin{example*}
Any non-singular cubic will be irreducible.
\end{example*}

\begin{theorem}
\label{thm:6.7}
Let $ f $ be an irreducible cubic over a field $ k $. Assume that $ f = 0 $ has at least one point over $ k $. Fix such a point $ \OOO $. Let $ G $ be the set of non-singular points of $ f = 0 $ with coordinates in $ k $. We can give $ G $ the structure of an abelian group with identity $ \OOO $.
\end{theorem}

Say that $ n $ points are in \textbf{general position} if no four of them lie on a line, and no seven of them lie on a conic.

\begin{lemma}
\label{lem:6.8}
Given eight points in general position, there exists a ninth point such that any cubic passing through the first eight points also passes through the ninth.
\end{lemma}

\begin{proof}
Let $ g $ be a cubic, so
$$ g = a_1x^3 + a_2x^2 + a_3x + a_4 + a_5y^3 + a_6y^2 + a_7y + a_8x^2y + a_9xy^2 + a_{10}xy. $$
The condition that my given eight points are contained in $ g = 0 $ gives me eight linear equations in $ a_1, \dots, a_{10} $. The condition of being in general position tells us that these equations are independent, so we have a two-dimensional space of solutions. So there exist cubics $ f_1 $ and $ f_2 $ such that every cubic containing the eight points is of the form $ \lambda_1f_1 + \lambda_2f_2 $ for $ \lambda_1, \lambda_2 \in k $. By B\'ezout, $ \cbr{f_1 = 0} \cap \cbr{f_2 = 0} $ has nine points, and the ninth point of intersection is the point we need.
\end{proof}

\begin{proof}[Proof of Theorem \ref{thm:6.7}]
$ P + Q $ is the third point of intersection of the line $ \overrightarrow{\OOO R} $, where $ R $ is the third point of intersection of the line through $ \overrightarrow{PQ} $. If $ P = Q $ take the tangent at $ P $. To see that $ P + Q \in G $, just note that given any two points in $ G $, the third point of intersection has coordinates in $ k $, such as by explicitly solving equations, and must be non-singular, else would have at least $ 2 + 1 + 1 = 4 $ points of intersection with multiplicity. Then $ P + Q = Q + P $ and $ P + \OOO = P $ by definition. Want an inverse $ -P $ such that $ P + \br{-P} = \OOO $. Let $ Q $ be the third point of intersection of the tangent line at $ \OOO $. Then $ -P $ is defined to be the third point of intersection of $ \overrightarrow{PQ} $ with $ f = 0 $. It remains to check that $ \br{P + Q} + R = P + \br{Q + R} $. Unfortunately this is not obvious. We follow Cassels' book, which almost proves it. Let
$$
\begin{tikzpicture}[scale=1.5]
\fill (0, 0) circle (0.05) node[below left]{$ \OOO $};
\fill (-1, 0) circle (0.05) node[below left]{$ P + Q $};
\fill (-2, 0) circle (0.05) node[below left]{$ T $};
\fill (0, 1) circle (0.05) node[below left]{$ V $};
\fill (-1, 1) circle (0.05) node[below left]{$ R $};
\fill (-2, 1) circle (0.05) node[below left]{$ Q $};
\fill (0, 2) circle (0.05) node[below left]{$ Q + R $};
\fill (-1, 2) circle (0.05) node[below left]{$ W_1 $} node[above right]{$ W_2 $};
\fill (-2, 2) circle (0.05) node[below left]{$ P $};
\draw (0.5, 0) to (-2.5, 0);
\draw (0.5, 1) to (-2.5, 1);
\draw (0.5, 2) to (-2.5, 2);
\draw (0, -0.5) to (0, 2.5);
\draw (-1, -0.5) to (-1, 2.5);
\draw (-2, -0.5) to (-2, 2.5);
\end{tikzpicture}.
$$
Associativity is the statement that $ W_1 = W_2 $. Apply Lemma \ref{lem:6.8} to $ \OOO, P, Q, R, T, V, P + Q, Q + R $. Consider three cubics
\begin{itemize}
\item $ f = 0 $,
\item the three vertical lines, and
\item the three horizontal lines.
\end{itemize}
There exists a unique ninth point $ W $ on all of these cubics. By B\'ezout, the ninth point of intersection of the first two cubics is $ W_1 $, so $ W = W_1 $. Similarly, $ W = W_2 $. So $ W_1 = W_2 $, and $ P + \br{Q + R} = \br{P + Q} + R $.
\end{proof}

\begin{remark}
This requires $ \OOO, P, Q, R, T, V, P + Q, Q + R $ are in general position. This is an open condition. The equation $ P + \br{Q + R} = \br{P + Q} + R $ is a closed condition. To make this a complete proof, work in the Zariski topology.
\end{remark}

\pagebreak

\lecture{15}{Tuesday}{05/11/19}

\begin{definition}
An \textbf{elliptic curve} over a field $ k $ is a non-singular plane cubic together with a fixed point $ \OOO $ with coordinates in $ k $.
\end{definition}

\begin{definition}
A \textbf{point of inflexion} is a point $ P $ such that the tangent line to the curve at $ P $ only meets the curve at $ P $. Since we are considering cubics, these are points where the tangent line meets with multiplicity three.
\end{definition}

\begin{lemma}
If $ \OOO $ is a point of inflexion, then $ P + Q + R = \OOO $ if and only if $ P, Q, R $ are collinear.
\end{lemma}

\begin{proof}
$ P + Q + R = \OOO $ if and only if $ R = -\br{P + Q} $, if and only if $ R $ is the third point of intersection of the line through $ P $ and $ Q $.
\end{proof}

Consider cubic curves of the form $ y^2 = f\br{x} $, where $ f\br{x} $ is a monic cubic. In homogeneous coordinates,
$$ Y^2Z - \br{X^3 + \alpha X^2Z + \beta XZ^2 + \gamma Z^3} = 0. $$

\begin{lemma}
\hfill
\begin{enumerate}
\item This has a unique point at infinity, which is non-singular.
\item The point at infinity is a point of inflexion.
\item This curve is always irreducible, and if $ \ch k \ne 2 $, then it is non-singular if and only if $ f\br{x} $ has distinct roots.
\end{enumerate}
\end{lemma}

\begin{proof}
\hfill
\begin{enumerate}
\item $ Z = 0 $ implies that $ X^3 = 0 $, so $ X = 0 $, so $ \sbr{0 : 1 : 0} $ is the unique point at infinity, and $ \tpd{}{Z} = Y^2 = 1^2 = 1 \ne 0 $.
\item $ \tpd{}{X} = \tpd{}{Y} = 0 $ at $ \sbr{0 : 1 : 0} $, so the tangent line is just $ \cbr{Z = 0} $. So the only point of the curve on this is $ \sbr{0 : 1 : 0} $, by $ 1 $.
\item Any singular point is a point of $ y^2 = f\br{x} $, by $ 1 $. Then $ \tpd{}{y} = 2y = 0 $ and $ \tpd{}{x} = f'\br{x} = 0 $, and $ \ch k \ne 2 $ implies that $ y = 0 $ and $ f'\br{x} = 0 $, so $ f\br{x} = 0 $. Thus $ f\br{x} = f'\br{x} = 0 $ has a solution if and only if $ f\br{x} $ has a repeated root, since $ f\br{x} = \br{x - \alpha}g\br{x} $.
\end{enumerate}
\end{proof}

If $ \ch k \ne 2 $, can always make any elliptic curve into a curve of this form. In general, need $ y^2 + \alpha y + \beta xy = f\br{x} $. If $ \ch k \ne 2, 3 $ then we can complete the cube in $ f\br{x} $, and write
$$ y^2 = x^3 + ax + b, $$
since $ x^3 + cx^2 + \dots = \br{x + \tfrac{1}{3}c}^3 + \dots $. Let $ \ch k \ne 2 $. If $ P = \br{x_0, y_0} $, what is $ -P $? The line through $ P $ and $ \OOO $ is $ x = x_0 $, \footnote{Exercise} so
$$ -P = \br{x_0, -y_0}. $$
Then $ 2P = \OOO $ if and only if $ P = -P $, if and only if $ y_0 = -y_0 $, if and only if $ y_0 = 0 $. So $ 2P = \OOO $ if and only if $ P = \br{x_0, 0} $ with $ x_0 $ a root of $ f\br{x} $. The \textbf{discriminant} of $ x^3 + ax + b $ is
$$ 4a^3 + 27b^2. $$
If $ x^3 + ax + b = \br{x - \alpha}\br{x - \beta}\br{x - \gamma} $, the discriminant is $ \br{\alpha - \beta}^2\br{\beta - \gamma}^2\br{\gamma - \alpha}^2 $. In particular, $ y^2 = x^3 + ax + b $ is an elliptic curve if and only if $ 4a^3 + 27b^2 \ne 0 $. Write $ \Delta = 4a^3 + 27b^2 $. What changes of variable can we make that turn $ y^2 = x^3 + ax + b $ into another equation $ y^2 = x^3 + a'x + b' $? If $ y' = u^3y $ and $ x' = u^2x $ for $ u \ne 0 $, then $ u^6y^2 = u^6x^3 + au^6x + bu^6 $, so $ y'^2 = x'^3 + au^6x + bu^6 $. This takes $ \br{a, b} \leftrightarrow \br{u^4a, u^6b} $ and $ \Delta \leftrightarrow u^{12}\Delta $.

\begin{definition}
The \textbf{$ j $-invariant} of $ y^2 = x^3 + ax + b $ is
$$ -\dfrac{1728\br{4a}^3}{\Delta}. $$
\end{definition}

This is invariant under $ \br{x, y} \leftrightarrow \br{u^2x, u^3y} $.

\pagebreak

\begin{proposition}
If $ k $ is algebraically closed, then two elliptic curves are isomorphic if and only if they have the same $ j $-invariant.
\end{proposition}

\begin{proof}
Assume $ \ch k \ne 2, 3 $. Suppose that we have two elliptic curves $ y^2 = x^3 + ax + b $ and $ y^2 = x^3 + a'x + b' $. These have the same $ j $-invariants if and only if $ a^3 / \br{4a^3 + 27b^2} = a'^3 / \br{4a'^3 + 27b'^2} $, if and only if $ b^2 / a^3 = b'^2 / a'^3 $. If the two curves are isomorphic, then the $ j $-invariants are equal, as $ \br{x, y} \leftrightarrow \br{u^2x, u^3y} $ does not change the $ j $-invariant. Conversely, assume $ b^2 / a^3 = b'^2 / a'^3 $, that is $ \br{a' / a}^3 = \br{b' / b}^2 $. Since $ k $ is algebraically closed, there exists $ u $ such that $ u^4 = a' / a $ and $ u^6 = b' / b $. Then the transformation $ \br{x, y} \leftrightarrow \br{u^2x, u^3y} $ takes $ y^2 = x^3 + ax + b \leftrightarrow y^2 = x^3 + a'x + b' $. Implicitly assumed that $ a, b, a', b' \ne 0 $. More correctly, the equation is $ b^2a'^3 = b'^2a^3 $. If $ a = 0 $ then $ b \ne 0 $, as the curve is non-singular, so $ a' = 0 $, so $ b' \ne 0 $, so just choose $ u^6 = b' / b $. Similarly if $ b = 0 $ then $ a \ne 0 $, so $ b' = 0 $ and $ a' \ne 0 $, and choose $ u^4 = a' / a $.
\end{proof}

\lecture{16}{Thursday}{07/11/19}

\begin{example}
Let $ \ch k \ne 2, 3 $, and let $ y^2 = x^3 $ with $ \OOO = \sbr{0 : 1 : 0} $. The non-singular points are all points not equal to $ \br{0, 0} $. Intersect $ y^2 = x^3 $ with a line $ ax + by = 1 $. Then $ x^3 = y^2 = y^2\br{ax + by} $, so $ \br{x / y}^3 = a\br{x / y} + b $. Write $ u = x / y $, so $ u^3 - au - b = 0 $. If the roots of this cubic are $ u_1, u_2, u_3 $, then $ u_1 + u_2 + u_3 = 0 $. Conversely if $ u_1 + u_2 + u_3 = 0 $, then $ u_1, u_2, u_3 $ are the roots of $ u^3 - au - b = 0 $, so $ a = -\br{u_1u_2 + u_2u_3 + u_3u_1} $ and $ b = u_1u_2u_3 $. That is, $ \br{x_1, y_1} + \br{x_2, y_2} + \br{x_3, y_3} = 0 $ if and only if $ x_1 / y_1 + x_2 / y_2 + x_3 / y_3 = 0 $. We get an isomorphism to the group $ \br{k, +} $ by $ \br{x, y} \mapsto x / y $.
\end{example}

\begin{example}
Let $ y^2 = x^2\br{x + 1} $, and let $ u = y + x $ and $ v = y - x $. Then $ x^3 = y^2 - x^2 = \br{y + x}\br{y - x} $ and $ x = \tfrac{1}{2}\br{u - v} $, so $ \br{u - v}^3 = 8uv $. Now take a line $ au + bv = 1 $. Then $ \br{u - v}^3 = 8uv = 8uv\br{au + bv} $. Set $ t = u / v $, so that $ \br{t - 1}^3 = 8t\br{at + b} $. The roots of this cubic are $ t_1, t_2, t_3 $ with $ t_1t_2t_3 = 1 $. So we have an isomorphism to the group $ \br{k^\times, \times} $, given by $ \br{x, y} \mapsto \br{y + x} / \br{y - x} $.
\end{example}

\begin{example}
Let $ y^2 = x^3 + 1 $, and let $ k = \FF_5 = \ZZ / 5\ZZ $. The discriminant is $ \Delta = 27 \ne 0 $ in $ \FF_5 $. The squares modulo five are $ 0, 1, 4 $, and
$$
\begin{array}{c|c|c|c|c|c}
x & 0 & 1 & 2 & 3 & 4 \\
\hline
y & \pm 1 & \times & \pm 2 & \times & 0
\end{array}.
$$
Also the point $ \OOO $ at infinity. So six points, so $ \ZZ / 2\ZZ \times \ZZ / 3\ZZ \cong \ZZ / 6\ZZ $.
\begin{itemize}
\item $ 2P = \OOO $ if and only if $ y = 0 $. So $ \br{4, 0} $ has order two.
\item Claim that $ \br{0, 1} $ is a point of order three. Then $ 3P = \OOO $ so we just need a line which only meets the curve at this point. Check that $ Y = Z $ in projective coordinates only goes through this point. \footnote{Exercise}
\item So $ \br{0, 1} $ has order three and $ \br{4, 0} $ has order two. Then $ y = x + 1 $ passes through $ \br{0, 1} $ and $ \br{4, 0} = \br{-1, 0} $. The third point of intersection is $ \br{2, -2} = -\br{\br{0, 1} + \br{4, 0}} $, so $ \br{0, 1} + \br{4, 0} = -\br{2, -2} = \br{2, 2} $.
\end{itemize}
\end{example}

\begin{exercise}
Compute $ n\br{2, -2} $ for $ n = 0, \dots, 5 $.
\end{exercise}

\begin{notation}
Write $ E $ for an elliptic curve, and $ E\br{k} $ for all its points over a field $ k $.
\end{notation}

\begin{example*}
We just computed $ E\br{\FF_5} $ for $ E = \cbr{y = x^3 + 1} $.
\end{example*}

The main goal of the course is to take an elliptic curve $ E $ over $ \QQ $, and see what we can say about $ E\br{\QQ} $. The main theorem is the Mordell-Weil theorem, that $ E\br{\QQ} $ is a finitely generated abelian group. That is, there exists $ \ZZ^N \twoheadrightarrow E\br{\QQ} $, that is there exist $ g_1, \dots, g_N \in E\br{\QQ} $ such that every element is of the form $ \sum_{i = 1}^N a_ig_i $ for $ a_i \in \ZZ $. The group $ \br{\QQ, +} $ is not finitely generated. The structure theorem for finitely generated abelian groups is that any finitely generated abelian group is of the form $ H \times T $, where $ H \cong \ZZ^r $ for some $ r \ge 0 $, and $ T $ is finite. Both $ r $ and $ T $ are uniquely determined. Call $ r $ the \textbf{rank} of the group, and $ T $ the \textbf{torsion subgroup}, that is the subgroup of elements of finite order.

\begin{remark}
Page 190 of Silverman shows that if $ E\br{L} / 2E\br{L} $ is finite for $ L $ a finite Galois extension of $ \QQ $ then $ E\br{\QQ} / 2E\br{\QQ} $ is finite. It is just a tiny bit of Galois cohomology using finiteness of $ 2 $-torsion. It is fairly straightforward to generalise the arguments we give for the finiteness of $ E\br{\QQ} / 2E\br{\QQ} $ to number fields, so by choosing $ L $ large enough, we could remove the assumption on $ E $.
\end{remark}

\pagebreak

\section{The torsion subgroup of \texorpdfstring{$ E\br{\QQ} $}{E(Q)}}

\lecture{17}{Monday}{11/11/19}

Let $ E $ be an elliptic curve over $ \QQ $. The torsion subgroup of $ E\br{\QQ} $ is
$$ T = \cbr{P \in E\br{\QQ} \st \exists n \ge 1, \ nP = \OOO}. $$
We will see that this is a finite abelian group, and we will see how to compute it. Write $ E $ as $ y^2 = x^3 + ax + b $ for $ a, b \in \QQ $. Making a change of variables $ \br{x, y} \mapsto \br{u^2x, u^3y} $ for some $ u \in \QQ^\times $, we can send $ \br{a, b} \mapsto \br{u^4a, u^6b} $, and we can assume $ a, b \in \ZZ $.

\begin{theorem}[Lutz-Nagell]
\label{thm:7.1}
Let $ y^2 = x^3 + ax + b $ be an elliptic curve with $ a, b \in \ZZ $. Then the torsion subgroup of $ E\br{\QQ} $ is finite. If $ \br{x, y} $ is in this torsion subgroup, then $ x, y \in \ZZ $. Furthermore either $ y = 0 $ or $ y^2 \mid \br{4a^3 + 27b^2} $.
\end{theorem}

To do this we need a formula for $ x_d $ and $ y_d $ in terms of $ x $ and $ y $. Write $ P = \br{x_0, y_0} $ and $ 2P = \br{x_d, y_d} $. Then $ -2P = \br{x_d, -y_d} $ is the third point of intersection of the tangent line at $ P $. Let this tangent line be $ y = mx + c $. Differentiating $ y^2 = x^3 + ax + b $, $ m = \br{3x_0^2 + a} / 2y_0 $. We have to solve $ \br{mx + c}^2 = x^3 + ax + b $. This will have roots $ x_0, x_0, x_d $. The sum of the roots of this cubic is $ m^2 $. So
$$ x_d = m^2 - 2x_0 = \dfrac{\br{3x_0 + a}^2 - 2x_0\br{2y_0}^2}{\br{2y_0}^2}. $$
Then $ y_0^2 = x_0^3 + ax_0 + b $, so the \textbf{doubling formula} is as follows.

\begin{algorithm}[Doubling formula]
$$ x_d = \dfrac{x_0^4 - 2ax^2 - 8bx_0 + a^2}{4\br{x_0^3 + ax_0 + b}}, \qquad -y_d = mx_d + c. $$
\end{algorithm}

Similarly, if $ P = \br{x_1, y_1} $, $ Q = \br{x_2, y_2} $, and $ P + Q = \br{x_3, y_3} $, then the \textbf{addition formula} is as follows.

\begin{algorithm}[Addition formula]
$$ x_3 = \dfrac{-2y_1y_2 + \br{x_1 + x_2}\br{x_1x_2 + a} + 2b}{\br{x_1 - x_2}^2}, \qquad -y_3 = mx_3 + c. $$
\end{algorithm}

\begin{proof}[Proof of Theorem \ref{thm:7.1}]
If $ \br{x, y} \in E\br{\QQ} $ is a torsion point, then by Corollary \ref{cor:8.12}, $ x, y \in \ZZ_p $ for all $ p $. So $ x, y \in \ZZ $. If $ \br{x, y} $ is a torsion point, then $ 2\br{x, y} $ is also a torsion point, since $ nP = \OOO $ implies that $ n\br{2P} = 2\br{nP} = 2\OOO = \OOO $. Then if $ 2\br{x, y} = \br{x_d, y_d} $, then $ x_d, y_d \in \ZZ $. We will show that this implies that $ y = 0 $ or $ y^2 \mid \br{4a^3 + 27b^2} $. Suppose that $ \br{x, y} $ is a torsion point and that $ y \ne 0 $. Then we have that $ y^2 \mid \br{3x^2 + a}^2 $ and $ y^2 = x^3 + ax + b $, and
$$ \br{3x^2 + a}^2\br{3x^2 + 4a} - \br{x^3 + ax + b}\br{27x^3 + 27ax - 27b} = 4a^3 + 27b^2. $$
So $ y^2 \mid \br{4a^3 + 27b^2} $, as required.
\end{proof}

\begin{example}
If $ y^2 = x^3 + 1 $, then $ 4a^3 + 27b^2 = 27 $, so $ y = 0, \pm 1, \pm 3 $, so
$$ T \subseteq \cbr{\br{-1, 0}, \br{0, \pm 1}, \br{2, \pm 3}, \OOO}. $$
Then $ \br{0, 1} $ is a point of order three, by considering the line $ y = 1 $. That is, $ 2\br{0, 1} = \br{0, -1} = -\br{0, 1} $. Then we have a point of order three, and a point of order two, namely $ \br{-1, 0} $, so the group of torsion points has order at least six, so it is exactly of order six.
\end{example}

\begin{example}
If $ y^2 = x^3 + 17 $, then $ 4a^3 + 27b^2 = 27\br{17}^2 $, so $ y = 0, \pm 1, \pm 3, \pm 17, \pm 51 $. If $ 17 \mid y $ then $ 17 \mid x^3 = y^2 - 17 $ then $ 17^2 \mid y^2 - x^3 = 17 $, a contradiction, etc. Then $ y = \pm 3 $, so $ x^3 = 9 - 17 = -8 $. So
$$ T \subseteq \cbr{\br{-2, \pm 3}, \OOO}. $$
Using the doubling formula for $ x_0 = -2 $, $ x_d = 8 $. We already saw that any torsion point has $ x = -2 $, so this cannot be a torsion point after all. So the torsion subgroup is just $ \cbr{\OOO} $.
\end{example}

\begin{remark*}
This proves that there are infinitely many elements of $ E\br{\QQ} $, that is infinitely many $ x, y \in \QQ $ such that $ y^2 = x^3 + 17 $. Indeed the points $ n\br{-2, 3} $ are all distinct for $ n \in \ZZ $.
\end{remark*}

\pagebreak

\section{The torsion points in \texorpdfstring{$ E\br{\QQ_p} $}{E(Qp)}}

\lecture{18}{Tuesday}{12/11/19}

The next aim is to study elliptic curves over $ \QQ_p $ in order to show that torsion points have coordinates in $ \ZZ_p $.

\begin{definition}
Write $ \sbr{a_1 : \dots : a_{n + 1}} $ for some point, where all $ a_i \in \ZZ_p $, and at least one $ a_i \in \ZZ_p^\times $. There is a map
$$ \function{\PP^n\br{\QQ_p}}{\PP^n\br{\FF_p}}{\sbr{a_1 : \dots : a_{n + 1}}}{\sbr{\overline{a_1} : \dots : \overline{a_{n + 1}}}}, \qquad \overline{a_i} = a_i \mod p, $$
for all $ n $.
\end{definition}

Can also reduce lines in $ \PP^2\br{\QQ_p} $ modulo $ p $. Write any line as $ aX + bY + cZ = 0 $. Rescale so that $ a, b, c \in \ZZ_p $, and at least one is in $ \ZZ_p^\times $. Then $ \overline{a}X + \overline{b}Y + \overline{c}Z = 0 $ is a well-defined line in $ \PP^2\br{\FF_p} $. Let $ y^2 = g\br{x} $, where $ g $ is a monic cubic with distinct roots. Rescaling $ x $ and $ y $ if necessary, assume $ g\br{x} \in \ZZ_p\sbr{x} $. The \textbf{reduction} modulo $ p $ of the elliptic curve is then $ y^2 = \overline{g}\br{x} $, where $ \overline{g}\br{x} = g\br{x} \mod p $. This is an irreducible cubic, but it could be singular, if $ p = 2 $ or if $ p \mid \Delta $.

\begin{example}
Let $ p = 3 $ and $ E = \cbr{y^2 = x^3 - 18} $. This is $ y^2 = x^3 \mod 3 $, which has a singular point $ \br{0, 0} $. For example, $ \br{3, 3} \in E\br{\QQ_3} $ is $ \sbr{3 : 3 : 1} \mapsto \sbr{0 : 0 : 1} \mod 3 $, that is to the singular point. There is a point $ \br{x, y} $ on $ E\br{\QQ_3} $ with $ x = \tfrac{1}{9} $, since $ \br{\tfrac{1}{9}}^3 - 18 = \tfrac{1}{27^2}\br{1 - 18 \cdot 27^2} $ is a square, by Hensel's lemma for $ y^2 - \br{1 - 18 \cdot 27^2} $. Then $ y = \tfrac{1}{27}u $ for some $ u \in \ZZ_3^\times $. So $ \sbr{x : y : 1} = \sbr{27x : 27y : 27} = \sbr{3 : u : 27} \mapsto \sbr{0 : \overline{u} : 0} = \sbr{0 : 1 : 0} = \OOO \mod 3 $.
\end{example}

\begin{lemma}
\hfill
\begin{enumerate}
\item If $ \br{x_0, y_0} \in E\br{\QQ_p} $ then either $ x_0, y_0 \in \ZZ_p $ or there exists $ n \ge 1 $ such that $ \abs{x_0}_p = p^{2n} $ and $ \abs{y_0}_p = p^{3n} $.
\item If $ g\br{x} = x^3 \mod p $, and $ \br{x_0, y_0} \in E\br{\QQ_p} $ with $ \abs{x_0}_p, \abs{y_0}_p \le 1 $, then either $ \abs{x_0}_p = \abs{y_0}_p = 1 $ or $ \abs{x_0}_p, \abs{y_0}_p < 1 $.
\end{enumerate}
\end{lemma}

\begin{proof}
\hfill
\begin{enumerate}
\item Write $ g\br{x} = x^3 + \alpha x^2 + \beta x + \gamma $ for $ \alpha, \beta, \gamma \in \ZZ_p $. If $ \abs{x_0}_p > 1 $, then $ \abs{x_0^3}_p > \abs{\alpha x_0^2}_p, \abs{\beta x_0}_p, \abs{\gamma}_p $. So $ \abs{x_0^3 + \alpha x_0^2 + \beta x_0 + \gamma}_p = \abs{x_0}_p^3 $. Then $ \abs{y_0}_p^2 = \abs{x_0}_p^3 $. If $ \abs{x_0}_p \le 1 $, then $ \abs{y_0}_p^2 = \abs{x_0^3 + \alpha x_0^2 + \beta x_0 + \gamma}_p \le 1 $.
\item By assumption, $ p \mid \alpha, \beta, \gamma $. So
$$ p \mid x_0 \qquad \iff \qquad p \mid \br{x_0^3 + \alpha x_0^2 + \beta x_0 + \gamma} \qquad \iff \qquad p \mid y_0^2 \qquad \iff \qquad p \mid y_0. $$
That is, $ \abs{x_0}_p < 1 $ if and only if $ \abs{y_0}_p < 1 $.
\end{enumerate}
\end{proof}

\begin{definition}
Write $ \overline{E} $ for the cubic $ y^2 = \overline{g}\br{x} $ in $ \PP^2\br{\FF_p} $. Let $ E\br{\QQ_p}^{\br{0}} $ be the points $ P $ whose image in $ \overline{E}\br{\FF_p} $ is non-singular. Let $ E\br{\QQ_p}^{\br{1}} $ be the points $ P $ whose image $ \overline{P} $ is $ \OOO \in \overline{E}\br{\FF_p} $. That is, $ E\br{\QQ_p}^{\br{1}} $ is the points $ \br{x, y} $ with $ \abs{x}_p, \abs{y}_p > 1 $.
\end{definition}

\begin{lemma}
\label{lem:8.5}
\hfill
\begin{enumerate}
\item $ E\br{\QQ_p}^{\br{0}} $ is a subgroup of $ E\br{\QQ_p} $.
\item Reduction modulo $ p $ is a group homomorphism from $ E\br{\QQ_p}^{\br{0}} $ to the group of non-singular points $ \overline{E}\br{\FF_p} $. The kernel of this homomorphism is $ E\br{\QQ_p}^{\br{1}} $.
\end{enumerate}
\end{lemma}

\begin{proof}
The group law is $ P + Q + R = \OOO $ if and only if $ P, Q, R $ are collinear.
\begin{enumerate}
\item Need to show that if $ P, Q, R $ are collinear, and $ P, Q \in E\br{\QQ_p}^{\br{0}} $, then $ R \in E\br{\QQ_p}^{\br{0}} $. That is, need that if $ \overline{P} $ and $ \overline{Q} $ are non-singular, then so is $ \overline{R} $. This follows from B\'ezout.
\item The map is a group homomorphism because $ P + Q + R = \OOO $ implies that $ P, Q, R $ are collinear, so $ \overline{P}, \overline{Q}, \overline{R} $ are collinear, which implies that $ \overline{P} + \overline{Q} + \overline{R} = \OOO $. The kernel is $ E\br{\QQ_p}^{\br{1}} $ by definition.
\end{enumerate}
\end{proof}

\begin{remark}
The homomorphism $ E\br{\QQ_p}^{\br{0}} $ to the non-singular points in $ \overline{E}\br{\FF_p} $ is surjective.
\end{remark}

\pagebreak

Let $ E\br{\QQ_p}^{\br{n}} $, for $ n \ge 1 $, be the $ \br{x, y} \in E\br{\QQ_p} $ with $ \abs{x}_p \ge p^{2n} $. Say $ \br{x, y} $ has \textbf{level} $ n $ if $ \abs{x}_p = p^{2n} $, so $ \abs{y}_p = p^{3n} $.

\begin{corollary}
$ E\br{\QQ_p}^{\br{n}} $ is a subgroup of $ E\br{\QQ_p} $ for all $ n $.
\end{corollary}

\begin{proof}
Let $ E_n $ be the elliptic curve obtained by the change of variables $ \br{x, y} \mapsto \br{p^{2n}x, p^{3n}y} $. Then we have $ E\br{\QQ_p}^{\br{n + 1}} \xrightarrow{\sim} E_n\br{\QQ_p}^{\br{1}} $, which is a group by Lemma \ref{lem:8.5}.
\end{proof}

\begin{corollary}
For each $ n \ge 1 $ there is a natural injection
$$ E\br{\QQ_p}^{\br{n}} / E\br{\QQ_p}^{\br{n + 1}} \hookrightarrow \ZZ / p\ZZ. $$
\end{corollary}

\begin{proof}
The map $ E \to E_n $ takes $ E\br{\QQ_p}^{\br{n}} $ to a subgroup of $ E_n\br{\QQ_p}^{\br{0}} $, and $ E\br{\QQ_p}^{\br{n + 1}} $ to $ E_n\br{\QQ_p}^{\br{1}} $. The curve $ E_n $ reduces to $ y^3 = x^3 $ modulo $ p $. So it suffices to show that if $ E' $ is an elliptic curve with reduction $ y^2 = x^3 $, then we have an injection $ E'\br{\QQ_p}^{\br{0}} / E'\br{\QQ_p}^{\br{1}} \hookrightarrow \ZZ / p\ZZ $. But reduction modulo $ p $ is a homomorphism $ E'\br{\QQ_p}^{\br{0}} / E'\br{\QQ_p}^{\br{1}} $ to the non-singular points in $ y^2 = x^3 \mod p $. By Example \ref{eg:6.5}, the right hand side is isomorphic to $ \ZZ / p\ZZ $ via $ \br{x, y} \mapsto x / y $.
\end{proof}

\lecture{19}{Thursday}{14/11/19}

\begin{remark}
The aim is that $ E\br{\QQ_p}^{\br{1}} $ has no non-trivial torsion points, that is if $ P \in E\br{\QQ_p}^{\br{1}} $ and $ mP = \OOO $ for $ m \ge 1 $, then $ P = \OOO $. The idea is if $ P $ has level $ n $, then $ P = \sbr{x : y : 1} = \sbr{p^{3n}x : p^{3n}y : p^{3n}} $ is close to $ \sbr{0 : 1 : 0} $. We are looking at points which are close to $ \OOO $, and the group law is simpler here. Near the identity in a Lie group, the group law becomes simpler. For example, in $ \GL_2\br{\CC} $,
$$ \br{1 + \epsilon X}\br{1 + \epsilon Y} = 1 + \epsilon\br{X + Y} + \O\br{\epsilon^2}. $$
\end{remark}

Define
$$
\begin{array}{ccrcl}
\u & : & E\br{\QQ_p}^{\br{1}} & \longrightarrow & p\ZZ_p \\
& & \OOO & \longmapsto & 0 \\
& & \br{x, y} & \longmapsto & \dfrac{x}{y}
\end{array}.
$$
If $ \br{x, y} \in E\br{\QQ_p}^{\br{n}} $ then $ \abs{\u\br{x, y}}_p \le p^{-n} $, with equality if $ \br{x, y} $ has level $ n $. Also $ -\u\br{P} = \u\br{-P} $ because $ -\br{x, y} = \br{x, -y} $.

\begin{lemma}
\label{lem:8.10}
If $ P, Q \in E\br{\QQ_p}^{\br{1}} $, then
$$ \abs{\u\br{P + Q} - \u\br{P} - \u\br{Q}}_p \le \max\br{\abs{\u\br{P}}_p^5, \abs{\u\br{Q}}_p^5}. $$
\end{lemma}

\begin{proof}
If $ P, Q, P + Q $ equal $ \OOO $, then the left hand side is equal to zero and we are done. So assume that none of them is equal to zero. Recall that we set $ E_n = \cbr{y^2 = x^3 + p^{4n}a + p^{6n}b} $. Without loss of generality assume that the level of $ Q $ is at least the level of $ P $, and take $ n $ as the level of $ P $. Then the right hand side is $ p^{-5n} $. Let $ R = -\br{P + Q} $, so $ P, Q, R $ are collinear, and let $ P_n, Q_n, R_n $ be the corresponding points on $ E_n $. Since $ P $ has level $ n $, $ P_n \in E_n\br{\QQ_p}^{\br{0}} $ but $ P_n \notin E_n\br{\QQ_p}^{\br{1}} $ and $ Q_n \in E_n\br{\QQ_p}^{\br{0}} $, so $ R_n \in E_n\br{\QQ_p}^{\br{0}} $. Let the line through $ P_n, Q_n, R_n $ be $ lx + my = 1 $. Since this line, when reduced modulo $ p $, does not pass through $ \br{0, 0} $, we have $ l, m \in \ZZ_p $. Then
$$ y^2\br{lx + my} = x^3 + p^{4n}ax\br{lx + my}^2 + p^{6n}b\br{lx + my}^3. $$
Write $ t = x / y $. So
$$ lt + m = t^3 + p^{4n}at\br{lt + m}^2 + p^{6n}b\br{lt + m}^3. $$
This equation is a cubic in $ t $, say $ c_0t^3 + c_1t^2 + c_2t + c_3 = 0 $. The sum of the roots of this cubic is $ -c_1 / c_0 $. So
$$ c_0 = 1 + p^{4n}al^2 + p^{6n}bl^3 \in \ZZ_p^\times, \qquad c_1 = 2p^{4n}alm + 3p^{6n}bl^2m \in p^{4n}\ZZ_p^\times. $$
So $ \abs{c_1 / c_0}_p \le p^{-4n} $. But
$$ \abs{\u\br{P + Q} - \u\br{P} - \u\br{Q}}_p = \abs{\u\br{P} + \u\br{Q} + \u\br{R}}_p = p^{-n}\abs{\dfrac{c_1}{c_0}}_p \le p^{-5n} = \max\br{\abs{\u\br{P}}_p^5, \abs{\u\br{Q}}_p^5}. $$
\end{proof}

\pagebreak

A reminder that if $ \abs{x}_p \ne \abs{y}_p $ then $ \abs{x + y}_p = \max\br{\abs{x}_p, \abs{y}_p} $. Writing $ x = \br{x + y} + \br{-y} $, deduce that if $ \abs{x + y}_p < \abs{x}_p $, then $ \abs{x}_p = \abs{y}_p $.

\begin{corollary}
\label{cor:8.11}
\hfill
\begin{enumerate}
\item For all $ n \ge 1 $, $ \abs{\u\br{nP} - n\u\br{P}}_p \le \abs{\u\br{P}}_p^5 $ and $ \abs{\u\br{nP}}_p \le \abs{\u\br{P}}_p $.
\item If $ p \nmid n $, then $ \abs{\u\br{nP}}_p = \abs{\u\br{P}}_p $.
\item $ \abs{\u\br{pP}}_p = \abs{p}_p\abs{\u\br{P}}_p $.
\item For all $ n \ge 1 $, $ \abs{\u\br{nP}}_p = \abs{n}_p\abs{\u\br{P}}_p $.
\end{enumerate}
\end{corollary}

\begin{corollary}
\label{cor:8.12}
If $ \br{x, y} \in E\br{\QQ_p} $ is a torsion point, then $ x, y \in \ZZ_p $.
\end{corollary}

\begin{proof}
Assume $ nP = \OOO $ and $ P = \br{x, y} $ for $ n \ge 1 $. If $ P \in E\br{\QQ_p}^{\br{1}} $, then we have $ \abs{n}_p\abs{\u\br{P}}_p = \abs{\u\br{nP}}_p = \abs{\u\br{\OOO}}_p = 0 $. So $ \abs{\u\br{P}}_p = 0 $, so $ \u\br{P} = 0 $, so $ P = \OOO $. So $ P \notin E\br{\QQ_p}^{\br{1}} $, so $ x, y \in \ZZ_p $.
\end{proof}

\begin{corollary}
If $ E\br{\QQ} $ is an elliptic curve of the form $ y^2 = x^3 + ax + b $ for $ a, b \in \ZZ $, and $ p \nmid 2\Delta $, then the subgroup of $ E\br{\QQ} $ of torsion points injects into $ \overline{E}\br{\FF_p} $.
\end{corollary}

\begin{proof}
$ p \nmid 2\Delta $ implies that $ E\br{\QQ_p}^{\br{0}} = E\br{\QQ_p} $. By Corollary \ref{cor:8.12}, the torsion subgroup of $ E\br{\QQ} $ has trivial intersection with $ E\br{\QQ_p}^{\br{1}} = \Ker \br{E\br{\QQ_p} \to \overline{E}\br{\FF_p}} $.
\end{proof}

\begin{proof}[Proof of Corollary \ref{cor:8.11}]
\hfill
\begin{enumerate}
\item Induction on $ n $, where $ n = 1 $ is obvious. If the first statement $ \abs{\u\br{nP} - n\u\br{P}}_p \le \abs{\u\br{P}}_p^5 $ holds, then $ \abs{\u\br{nP}}_p \le \abs{\u\br{P}}_p $, otherwise $ \abs{\u\br{nP}}_p > \abs{\u\br{P}}_p $, and then $ \abs{\u\br{P}}_p^5 \ge \abs{\u\br{nP} - n\u\br{P}}_p = \abs{\u\br{nP}}_p > \abs{\u\br{P}}_p $ but $ \abs{\u\br{P}}_p \le 1 / p $, a contradiction. So we just need to assume both statements for $ n $, and deduce the first statement for $ n + 1 $.
\begin{align*}
\abs{\u\br{\br{n + 1}P} - \br{n + 1}\u\br{P}}_p
& \le \max\br{\abs{\u\br{\br{n + 1}P} - \u\br{nP} - \u\br{P}}_p, \abs{\u\br{nP} - n\u\br{P}}_p} \\
& \le \max\br{\abs{\u\br{nP}}_p^5, \abs{\u\br{P}}_p^5}
= \abs{\u\br{P}}_p^5,
\end{align*}
by Lemma \ref{lem:8.10} and induction.
\item We have $ \abs{n\u\br{P}}_p = \abs{\u\br{P}}_p $ and $ \abs{\u\br{nP} - n\u\br{P}}_p \le \abs{\u\br{P}}_p^5 < \abs{n\u\br{P}}_p $.
\item Same as $ 2 $, because $ \abs{\u\br{P}}_p^5 < \abs{p}_p\abs{\u\br{P}}_p $.
\item Induction on $ n $. If $ \br{n, p} = 1 $, then $ 2 $. Otherwise $ \abs{\u\br{nP}}_p = \abs{p}_p\abs{\u\br{\br{n / p}P}}_p $ by $ 3 $, and $ \abs{\u\br{\br{n / p}P}}_p = \abs{n / p}_p\abs{\u\br{P}}_p $ by induction.
\end{enumerate}
\end{proof}

\begin{remark}
Just having coefficients in $ \ZZ_p $ is not enough in general, and need to actually be in the special form above. For example $ y^2 + xy = x^3 + 4x + 1 $ is an elliptic curve over $ \QQ_2 $ and $ \br{-\tfrac{1}{4}, \tfrac{1}{8}} $ is a point of order two on this curve even though it has non-integral coefficients. More generally, for an elliptic curve over a finite extension of $ \QQ_p $ there can be torsion if there are elements $ u $ in the maximal ideal with $ \abs{u}^5 > \abs{p} $. The argument shows that there is never any $ n $-torsion in $ E\br{\QQ_p}^{\br{1}} $ if $ p \nmid n $ but there can be $ p $-torsion if one works over a general complete field of characteristic zero such that $ \abs{p} < 1 $.
\end{remark}

\begin{example}
Let $ y^2 = x^3 + 105^{10^{10}}x + 3 $. Neither $ 5 \mid \Delta $ nor $ 7 \mid \Delta $, where $ \Delta = 4\br{105^{10^{10}}}^3 + 27\br{3}^2 $. Modulo five and seven, $ y^2 = x^3 + 3 $. The squares modulo five are $ 0, 1, 4 $ and modulo seven are $ 0, 1, 2, 4 $. Then
$$
\begin{array}{c|c|c|c|c|c}
x & 0 & 1 & 2 & 3 & 4 \\
% \hline
% x^3 + 3 & 3 & 4 & 1 & 0 & 2 \\
\hline
\#y & 0 & 2 & 2 & 1 & 0
\end{array}
\mod 5, \qquad
\begin{array}{c|c|c|c|c|c|c|c}
x & 0 & 1 & 2 & 3 & 4 & 5 & 6 \\
% \hline
% x^3 + 3 & 3 & 4 & 4 & 2 & 4 & 2 & 2 \\
\hline
\#y & 0 & 2 & 2 & 2 & 2 & 2 & 2
\end{array}
\mod 7,
$$
so $ \#E\br{\FF_5} = 5 + 1 = 6 $ and $ \#E\br{\FF_7} = 12 + 1 = 13 $. So $ E\br{\FF_5} \cong \ZZ / 6\ZZ \cong \ZZ / 2\ZZ \times \ZZ / 3\ZZ $ and $ E\br{\FF_7} \cong \ZZ / 13\ZZ $, so the torsion subgroup is just $ \cbr{0} $.
\end{example}

\lecture{20}{Monday}{18/11/19}

Lecture 20 is a problem class.

\pagebreak

\section{The Mordell-Weil theorem for \texorpdfstring{$ E\br{\QQ} $}{E(Q)}}

\lecture{21}{Tuesday}{19/11/19}

The Mordell-Weil theorem is that if $ E\br{\QQ} $ is an elliptic curve, then $ E\br{\QQ} $ is a finitely generated abelian group. The weak Mordell-Weil theorem is that $ E\br{\QQ} / 2E\br{\QQ} $ is a finite group. Assume that $ E $ can be written as
$$ y^2 = \br{x - e_1}\br{x - e_2}\br{x - e_3}, \qquad e_1, e_2, e_3 \in \QQ, $$
if and only if the $ 2 $-torsion subgroup of $ E\br{\QQ} $ has order four, and these are the points $ \OOO, \br{e_1, 0}, \br{e_2, 0}, \br{e_3, 0} $.

\begin{example}
Let $ y^2 = x^3 - x = x\br{x - 1}\br{x + 1} $.
\begin{itemize}
\item Assume $ y \ne 0 $. Write
$$ x - 1 = au^2, \qquad x = bv^2, \qquad x + 1 = cw^2, \qquad u, v, w \in \QQ, $$
for $ a, b, c \in \ZZ $ square-free. For example, $ \tfrac{10}{9} = 10\br{\tfrac{1}{3}}^2 $, $ 27 = 3\br{3}^2 $, and $ -5 = -5\br{1}^2 $. Since $ y^2 = abc\br{uvw}^2 $, $ abc $ is a square. If $ p \mid abc $, then $ p $ divides at least two of $ a, b, c $.
\item Claim that $ a, b, c \in \cbr{\pm 1, \pm 2} $. Need to show that if $ p > 2 $ is prime, then $ p \nmid abc $. If $ \abs{x}_p > 1 $, then $ \abs{x}_p = \abs{x \pm 1}_p $. Then $ \abs{y}_p^2 = \abs{x}_p\abs{x - 1}_p\abs{x + 1}_p = \abs{x}_p^3 $, so $ \abs{x}_p = \abs{x \pm 1}_p = p^{2n} $ for some $ n \ge 1 $. Since $ \abs{a}_p = \abs{x / u^2}_p = \abs{x}_p / \abs{u}_p^2 = \br{p^n / \abs{u}_p}^2 $ for example, $ \abs{a}_p = \abs{b}_p = \abs{c}_p = 1 $, a contradiction. So $ \abs{x}_p \le 1 $. Then $ \abs{x \pm 1}_p \le 1 $, and if $ p \mid abc $, then $ p $ divides at least two of $ x, x - 1, x + 1 $, and the difference of these two is either one or two. So $ p \mid 2 $.
\item Since $ abc $ is a square, $ c $ is determined by $ a $ and $ b $. For example, if $ a = -1 $ and $ b = -2 $, then $ c = 2 $. So there are at most sixteen possibilities for $ \br{a, b, c} $. Since the product of $ x + 1 > x > x - 1 $ is a square, either all three are positive, or $ x + 1 > 0 > x > x - 1 $. This leaves eight possibilities,
$$ \br{a, b, c} \in \cbr{\br{1, 1, 1}, \br{1, 2, 2}, \br{2, 1, 2}, \br{2, 2, 1}, \br{-1, -1, 1}, \br{-1, -2, 2}, \br{-2, -1, 2}, \br{-2, -2, 1}}. $$
\item Assume $ y = 0 $. Then $ \br{0, 0} $ and $ \br{\pm 1, 0} $ are also solutions of $ y^2 = x^3 - x $.
\begin{itemize}
\item If $ x = 0 $, then $ -1 = au^2 $ and $ 1 = cw^2 $, so $ a = -1 $ and $ c = 1 $. Then $ abc $ is a square, so $ b = -1 $.
\item If $ x = -1 $, then $ -2 = au^2 $ and $ -1 = bv^2 $, so $ a = -2 $ and $ b = -1 $. Similarly, $ c = 2 $.
\item If $ x = 1 $, then $ 1 = bv^2 $ and $ 2 = cw^2 $, so $ b = 1 $ and $ c = 2 $. Similarly, $ a = 2 $.
\end{itemize}
Then
$$ \br{a, b, c} \in \cbr{\br{2, 1, 2}, \br{-1, -1, 1}, \br{-2, -1, 2}}. $$
\item Claim that there are no solutions to $ y^2 = x^3 - x $ which give $ \br{a, b, c} = \br{1, 2, 2} $. Let $ x - 1 = u^2 $, $ x = 2v^2 $, and $ x + 1 = 2w^2 $, so $ u^2 - 2v^2 = -1 $ and $ 2w^2 - 2v^2 = 1 $. Want to show that these have no solutions with $ u, v, w \in \QQ $. Writing $ u = U / Z $, $ v = V / Z $, and $ w = W / Z $, it is enough to show that there are no non-zero solutions in $ \ZZ $ to $ U^2 - 2V^2 = -Z^2 $ and $ 2W^2 - 2V^2 = Z^2 $. Then $ 2 \mid U, V, W, Z $. Repeating, $ U = V = W = Z = 0 $. Similar arguments work for the other three possibilities.
\item We will see next time that in fact we have defined a group homomorphism
$$
\begin{array}{ccrcl}
\delta & : & E\br{\QQ} & \longrightarrow & \cbr{\pm 1, \pm 2}^3 \\
& & \br{x, y} & \longmapsto & \br{a, b, c} \\
& & \OOO & \longmapsto & \br{1, 1, 1}
\end{array},
$$
where $ \QQ^\times / \br{\QQ^\times}^2 $ is a group, and $ \cbr{\pm 1, \pm 2} = \cbr{\pm\br{\QQ^\times}^2, \pm2\br{\QQ^\times}^2} $ is a subgroup under multiplication. For example, $ \br{2}\br{2} = 1 $, $ \br{2}\br{-2} = -1 $, and $ \br{-2}\br{-2} = -1 $. In particular, the image of $ \delta $ is a subgroup of $ \cbr{\pm 1, \pm 2}^3 $, so it has order a power of two. Then $ \delta\br{2P} = 1 $ for any $ P \in E\br{\QQ} $, because $ \delta\br{2P} = \delta\br{P}^2 = 1 $. In fact, we will show that the induced homomorphism $ E\br{\QQ} / 2E\br{\QQ} \to \cbr{\pm 1, \pm 2}^3 $ is injective. So the calculation we made shows that $ E\br{\QQ} / 2E\br{\QQ} $ has order four.
\end{itemize}
In fact $ E\br{\QQ} = \cbr{\OOO, \br{0, 0}, \br{\pm 1, 0}} $.
\end{example}

\pagebreak

\lecture{22}{Thursday}{21/11/19}

\begin{theorem}
\label{thm:9.2}
Let $ K $ be a field of characteristic not equal to two, and let $ E $ be the elliptic curve $ y^2 = \br{x - e_1}\br{x - e_2}\br{x - e_3} $, for $ e_1, e_2, e_3 \in K $ distinct. Define
$$
\begin{array}{ccrcl}
\delta & : & E\br{K} & \longrightarrow & \cbr{K^\times / \br{K^\times}^2}^3 \\
& & \OOO & \longmapsto & \br{1, 1, 1} \\
& & T_1 = \br{e_1, 0} & \longmapsto & \br{\br{e_1 - e_2}\br{e_1 - e_3}, e_1 - e_2, e_1 - e_3} \\
& & T_2 = \br{e_2, 0} & \longmapsto & \br{e_2 - e_1, \br{e_2 - e_1}\br{e_2 - e_3}, e_2 - e_3} \\
& & T_3 = \br{e_3, 0} & \longmapsto & \br{e_3 - e_1, e_e - e_2, \br{e_e - e_1}\br{e_3 - e_2}} \\
& & \br{x, y} & \longmapsto & \br{x - e_1, x - e_2, x - e_3}, \qquad y \ne 0
\end{array}.
$$
Then
\begin{enumerate}
\item $ \delta $ is a group homomorphism.
\item $ \Ker \delta = 2E\br{K} $.
\end{enumerate}
\end{theorem}

\begin{lemma}
\label{lem:9.3}
Let $ K $ and $ E $ as in Theorem \ref{thm:9.2}. Let $ P = \br{x, y} \in E\br{K} $. If all $ x - e_i \in K^2 $ for $ i = 1, 2, 3 $, then there exists $ Q \in E\br{K} $ such that $ P = 2Q $.
\end{lemma}

\begin{proof}
Write $ x - e_i = t_i^2 $ for $ i = 1, 2, 3 $ for $ t_i \in K $. Then $ y^2 = t_1^2t_2^2t_3^2 = \br{t_1t_2t_3}^2 $. Assume, after possibly changing the sign of some $ t_i $, that $ y = t_1t_2t_3 $. Set
$$ Q = \br{x_0, y_0}, \qquad x_0 = x + t_1t_2 + t_2t_3 + t_3t_1, \qquad y_0 = \br{t_1 + t_2}\br{t_2 + t_3}\br{t_3 + t_1}. $$
Need to check that $ Q \in E\br{K} $, and that $ 2Q = P $. Then
$$ x_0 - e_1 = \br{x - e_1} + t_1t_2 + t_2t_3 + t_3t_1 = t_1^2 + t_1t_2 + t_2t_3 + t_3t_1 = \br{t_1 + t_2}\br{t_1 + t_3}. $$
Similarly $ x_0 - e_2 = \br{t_2 + t_3}\br{t_2 + t_1} $ and $ x_0 - e_3 = \br{t_3 + t_1}\br{t_3 + t_2} $. So
$$ \br{x_0 - e_1}\br{x_0 - e_2}\br{x_0 - e_3} = \br{t_1 + t_2}^2\br{t_2 + t_3}^2\br{t_3 + t_1}^2 = y_0^2, $$
that is $ Q \in E\br{K} $. To compute $ 2Q $, we need to find the tangent line $ y = mx + c $. Write $ f\br{x} = \br{x - e_1}\br{x - e_2}\br{x - e_3} $, then
\begin{align*}
m
& = \dfrac{f'\br{x_0}}{2y_0}
= \dfrac{\br{x_0 - e_2}\br{x_0 - e_3} + \br{x_0 - e_3}\br{x_0 - e_1} + \br{x_0 - e_1}\br{x_0 - e_2}}{2y_0} \\
& = \dfrac{\br{t_1 + t_2}\br{t_2 + t_3}\br{t_3 + t_1}\br{\br{t_1 + t_2} + \br{t_2 + t_3} + \br{t_3 + t_1}}}{2y_0}
= t_1 + t_2 + t_3.
\end{align*}
Then
$$ m\br{x_0 - x} = \br{t_1 + t_2 + t_3}\br{t_1t_2 + t_2t_3 + t_3t_1} = \br{t_1 + t_2}\br{t_2 + t_3}\br{t_3 + t_1} + t_1t_2t_3 = y_0 + y. $$
So the point $ \br{x, -y} $ also lies on the tangent line to $ E $ at $ \br{x_0, y_0} $. So $ -2Q = \br{x, -y} $, that is $ 2Q = \br{x, y} = P $.
\end{proof}

\begin{proof}[Proof of Theorem \ref{thm:9.2}]
Once we know that $ \delta $ is a group homomorphism, then $ 2E\br{K} \subset \Ker \delta $, because $ \delta\br{2P} = \delta\br{P}^2 = 1 $. Lemma \ref{lem:9.3} implies that $ \Ker \delta \subset 2E\br{K} $. So we have $ 2 $. Need to prove that if $ P_1 + P_2 + P_3 = \OOO $, then $ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} = 1 $. Note that by definition, $ \delta\br{P} = \delta\br{-P} $. Note that by definition, $ \delta\br{P} = \delta\br{-P} $.
\begin{itemize}
\item If $ P_1 = P_2 = P_3 = \OOO $, then obvious.
\item If $ P_1 = \OOO $ and $ P_2 \ne \OOO $, then $ P_2 + P_3 = \OOO $, and
$$ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} = \delta\br{P_2}\delta\br{P_3} = \delta\br{P_2}\delta\br{-P_2} = \delta\br{P_2}^2 = 1. $$
By symmetry assume none of $ P_1, P_2, P_3 $ is equal to $ \OOO $.

\pagebreak

\item Otherwise $ P_1, P_2, P_3 $ all lie on some line $ Y = mX + c $. Write $ P_i = \br{x_i, y_i} $.
\begin{itemize}
\item Assume firstly that $ 2P_i \ne \OOO $ for $ i = 1, 2, 3 $, that is $ x_i \ne e_1, e_2, e_3 $. Then
$$ \br{x - x_1}\br{x - x_2}\br{x - x_3} = \br{x - e_1}\br{x - e_2}\br{x - e_3} - \br{mx + c}^2. $$
Substituting $ x = e_1 $, $ \br{e_1 - x_1}\br{e_1 - x_2}\br{e_1 - x_3} = -\br{me_1 + c}^2 $, that is
$$ \br{x_1 - e_1}\br{x_2 - e_1}\br{x_3 - e_1} = \br{me_1 + c}^2 \in \br{K^\times}^2. $$
Similarly $ \br{x_1 - e_2}\br{x_2 - e_2}\br{x_3 - e_2} \in \br{K^\times}^2 $ and $ \br{x_1 - e_3}\br{x_2 - e_3}\br{x_3 - e_3} \in \br{K^\times}^2 $. That is, $ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} = 1 $.
\item Now assume that one of $ 2P_1, 2P_2, 2P_3 $ is equal to $ \OOO $. Without loss of generality $ P_1 = T_1 = \br{e_1, 0} $. Assume that $ 2P_2, 2P_3 \ne \OOO $. The calculation above shows that $ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} \in K^\times / \br{K^\times}^2 \times 1 \times 1 $. By definition, $ \Im \delta \subset \cbr{\br{a, b, c} \st abc = 1} $. So $ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} = 1 $ in this case.
\item Now assume that at least two of $ P_1, P_2, P_3 $ are equal to $ T_1, T_2, T_3 $. The only possibility with $ P_1 + P_2 + P_3 = \OOO $ but $ P_i \ne \OOO $ is $ \cbr{P_1, P_2, P_3} = \cbr{T_1, T_2, T_3} $. Then $ \delta\br{P_1}\delta\br{P_2}\delta\br{P_3} = \delta\br{T_1}\delta\br{T_2}\delta\br{T_3} = 1 $.
\end{itemize}
\end{itemize}
\end{proof}

\begin{remark}
We have
$$ \delta : E\br{K} / 2E\br{K} \xrightarrow{\sim} \Im \delta \subset \cbr{\br{a, b, c} \in \br{K^\times / \br{K^\times}^2}^3 \st abc = 1} \subset \br{K^\times / \br{K^\times}^2}^3. $$
\end{remark}

\begin{example*}
$ \QQ^\times / \br{\QQ^\times}^2 $ is not a finite group, since for each prime $ p $, $ p \in \QQ^\times / \br{\QQ^\times}^2 $, and these are linearly independent, as elements of $ \QQ^\times / \br{\QQ^\times}^2 $, which is an $ \FF_2 $-vector space.
\end{example*}

\pagebreak

\appendix

\section{Diagonalisation of quadratic forms}

\begin{definition}
Let $ k $ be any field, and let $ V $ be a $ k $-linear vector space. A \textbf{symmetric bilinear pairing} on $ V $ is a map $ \br{\cdot, \cdot} : V \times V \to k $ such that for all $ \alpha_1, \alpha_2 \in k $ and $ \underline{v_1}, \underline{v_2}, \underline{v_3} \in V $,
\begin{itemize}
\item $ \br{\alpha_1\underline{v_1} + \alpha_2\underline{v_2}, \underline{v_3}} = \alpha_1\br{\underline{v_1}, \underline{v_3}} + \alpha_2\br{\underline{v_2}, \underline{v_3}} $,
\item $ \br{\underline{v_3}, \alpha_1\underline{v_1} + \alpha_2\underline{v_2}} = \alpha_1\br{\underline{v_3}, \underline{v_1}} + \alpha_2\br{\underline{v_3}, \underline{v_2}} $, and
\item $ \br{\underline{v_1}, \underline{v_2}} = \br{\underline{v_2}, \underline{v_1}} $.
\end{itemize}
\end{definition}

\begin{example}
Dot product in $ \RR^n $ over $ \RR $.
\end{example}

\begin{definition}
If $ \ch k \ne 2 $, then the associated \textbf{quadratic form} to a symmetric bilinear pairing is
$$ \function[\B]{V}{k}{\underline{v}}{\br{\underline{v}, \underline{v}}}. $$
\end{definition}

\begin{remark}
Then $ \B $ is uniquely determined by $ \br{\cdot, \cdot} $, but the converse is also true, since
$$ \B\br{\underline{v_1} + \underline{v_2}} = \br{\underline{v_1} + \underline{v_2}, \underline{v_1} + \underline{v_2}} = \br{\underline{v_1} + \underline{v_1}} + \br{\underline{v_1}, \underline{v_2}} + \br{\underline{v_2}, \underline{v_1}} + \br{\underline{v_2}, \underline{v_2}} = \B\br{\underline{v_1}} + \B\br{\underline{v_2}} + 2\br{\underline{v_1}, \underline{v_2}}, $$
by bilinearity and symmetry, so
$$ \br{\underline{v_1}, \underline{v_2}} = \dfrac{1}{2}\br{\B\br{\underline{v_1} + \underline{v_2}} - \B\br{\underline{v_1}} - \B\br{\underline{v_2}}}. $$
\end{remark}

\begin{example}
Let $ V = k^n $, and let $ A $ be a symmetric $ n \times n $ matrix over $ k $. Then
$$ \br{\underline{v_1}, \underline{v_2}} = \underline{v_1}^\intercal A\underline{v_2} \in k, \qquad \underline{v_1}, \underline{v_2} \in V $$
is a symmetric bilinear pairing. More generally, let $ V $ be any finite-dimensional vector space, so $ V = \abr{\underline{e_1}, \dots, \underline{e_n}}_k $ for $ \cbr{\underline{e_i}} $ a $ k $-basis, and let the $ \br{i, j} $-th entry of $ A $ be $ \br{\underline{e_i}, \underline{e_j}} $. Under the unique isomorphism
$$ \function[\phi]{V}{k^n}{\underline{e_i}}{\br{0, \dots, 0, 1, 0, \dots, 0}}, $$
we get a symmetric bilinear pairing
$$ \br{\underline{v}, \underline{w}} = \phi\br{\underline{v}}^\intercal A\phi\br{\underline{w}} \in k, \qquad \underline{v}, \underline{w} \in V. $$
\end{example}

\begin{definition}
A \textbf{quadratic space} over $ k $ is an ordered pair $ \br{V, \br{\cdot, \cdot}} $ for $ V $ a finite-dimensional $ k $-linear vector space, and $ \br{\cdot, \cdot} : V \times V \to k $ a symmetric bilinear pairing. Two quadratic spaces $ \br{V, \br{\cdot, \cdot}} $ and $ \br{W, \abr{\cdot, \cdot}} $ are \textbf{isometric} if there exists $ \phi : V \to W $ an isomorphism such that $ \br{\underline{v}, \underline{w}} = \abr{\phi\br{\underline{v}}, \phi\br{\underline{w}}} $ for all $ \underline{v}, \underline{w} \in V $, so any quadratic space is isometric to a specimen from the example.
\end{definition}

\begin{remark}
Change of basis has the following effect. Let $ A $ be the matrix of the symmetric bilinear pairing $ \br{\cdot, \cdot} $ in the basis $ \underline{e_1}, \dots, \underline{e_n} $. If the matrix of the change of basis is $ B $, in the basis the matrix of the symmetric bilinear pairing is $ B^\intercal AB $, since $ \br{B\underline{v}}^\intercal A\br{B\underline{w}} = \underline{v}^\intercal \br{B^\intercal AB}\underline{w} $.
\end{remark}

\begin{theorem}[Gram-Schmidt orthogonalisation process]
If $ \br{V, \br{\cdot, \cdot}} $ is a quadratic space, then $ V $ has a basis $ \underline{e_1}, \dots, \underline{e_n} $ in which the matrix of $ \br{\cdot, \cdot} $ is diagonal.
\end{theorem}

\begin{proof}
Two cases. If $ \B \equiv 0 $, then $ \br{\cdot, \cdot} \equiv 0 $. Otherwise for all $ \underline{v} \in V $ such that $ \B\br{\underline{v}} \ne 0 $. Let $ \underline{e_1} = \underline{v_1} $ and
$$ \underline{v}^\perp = \cbr{\underline{w} \in V \st \br{\underline{v}, \underline{w}} = 0}. $$
This is an $ k $-linear subspace, which is trivial as $ \underline{w} \mapsto \br{\underline{v}, \underline{w}} $ is $ k $-linear. Then $ \underline{v} \notin \Ker \br{\underline{v}, \cdot} $, so $ \dim \underline{v}^\perp = \dim V - 1 $. We apply the process to $ \br{\underline{v}^\perp, \eval{\br{\cdot, \cdot}}_{\underline{v}^\perp}} $, by using induction on the dimension.
\end{proof}

\pagebreak

\begin{remark}
The \textbf{general linear group}
$$ \GL_{n + 1}\br{k} = \Aut_k k^{n + 1} $$
acts on $ \PP^n\br{k} $, and maps scalar multiples to scalar multiples, so maps equivalence classes under rescaling to equivalence classes, so have an induced action on $ \PP^n\br{k} $. The centre $ \Z_{n + 1}\br{k} $ of $ \GL_{n + 1}\br{k} $ is the scalar matrices $ \cbr{\lambda \I_3 \st \lambda \in k^*} $, which acts trivially on $ \PP^n\br{k} $. This is a normal subgroup, so I can form the quotient group
$$ \PGL_{n + 1}\br{k} = \GL_{n + 1}\br{k} / \Z_{n + 1}\br{k}, $$
the \textbf{projective linear group} of rank $ n + 1 $. Projective algebraic geometry is invariant under projective linear transformations. If $ F = 0 $ is non-singular, then its image under $ \PGL_{n + 1}\br{k} $ is also non-singular, and multiplicities in B\'ezout's theorem does not change under $ \PGL_{n + 1}\br{k} $, etc.
\end{remark}

\begin{theorem}
If $ \ch k \ne 2 $, then for $ F \in k\sbr{X_0, \dots, X_n} $ of degree two homogeneous, there exists a linear transformation, such that after the change of variables, $ F $ is of the form
$$ \alpha_0X_0^2 + \dots + \alpha_nX_n^2, \qquad \alpha_0, \alpha_1, \alpha_2 \in k. $$
\end{theorem}

\begin{proof}
Let $ F\br{X_0, \dots, X_n} = \sum_{i < j} a_{ij}X_iX_j $ for $ a_{ij} \in k $. It is the quadratic form on $ k^{n + 1} $ associated to the bilinear pairing in the standard basis with matrix $ A = \br{b_{ij}} $, where
$$ b_{ij} =
\begin{cases}
\tfrac{1}{2}a_{ij} & i \le j \\
\tfrac{1}{2}a_{ji} & i > j
\end{cases}.
$$
Now apply the Gram-Schmidt theorem.
\end{proof}

\end{document}