\def\module{M4P58 Modular Forms}
\def\lecturer{Dr David Helm}
\def\term{Autumn 2019}
\def\cover{
$$
\begin{tikzpicture}[scale=3]
\draw [help lines] (-2.5, 0) grid (2.5, 3.5);
\draw [->, dashed, very thick] (-2.5, 0) to (2.5, 0);
\draw [->, dashed, very thick] (0, 0) to (0, 4);
\draw (-2, 0) arc (0:60:1);
\draw (-1, 0) arc (0:120:1);
\draw (-2, 0) arc (180:0:1);
\draw (-1, 0) arc (180:0:1);
\draw (0, 0) arc (180:0:1);
\draw (1, 0) arc (180:60:1);
\draw (2, 0) arc (180:120:1);
\draw (-2.45, 0) arc (0:30:0.35);
\draw (-2.1, 0) arc (0:100:0.35);
\draw (-2.45, 0) arc (180:0:0.35);
\draw (-2.1, 0) arc (180:0:0.35);
\draw (-1.75, 0) arc (180:0:0.35);
\draw (-1.4, 0) arc (180:0:0.35);
\draw (-1.05, 0) arc (180:0:0.35);
\draw (-0.7, 0) arc (180:0:0.35);
\draw (-0.35, 0) arc (180:0:0.35);
\draw (0, 0) arc (180:0:0.35);
\draw (0.35, 0) arc (180:0:0.35);
\draw (0.7, 0) arc (180:0:0.35);
\draw (1.05, 0) arc (180:0:0.35);
\draw (1.4, 0) arc (180:0:0.35);
\draw (1.75, 0) arc (180:0:0.35);
\draw (2.1, 0) arc (180:80:0.35);
\draw (2.45, 0) arc (180:150:0.35);
\draw (-2.4, 0) arc (0:70:0.15);
\draw (-2.25, 0) arc (0:140:0.15);
\draw (-2.4, 0) arc (180:0:0.15);
\draw (-2.25, 0) arc (180:0:0.15);
\draw (-2.1, 0) arc (180:0:0.15);
\draw (-1.95, 0) arc (180:0:0.15);
\draw (-1.8, 0) arc (180:0:0.15);
\draw (-1.65, 0) arc (180:0:0.15);
\draw (-1.5, 0) arc (180:0:0.15);
\draw (-1.35, 0) arc (180:0:0.15);
\draw (-1.2, 0) arc (180:0:0.15);
\draw (-1.05, 0) arc (180:0:0.15);
\draw (-0.9, 0) arc (180:0:0.15);
\draw (-0.75, 0) arc (180:0:0.15);
\draw (-0.6, 0) arc (180:0:0.15);
\draw (-0.45, 0) arc (180:0:0.15);
\draw (-0.3, 0) arc (180:0:0.15);
\draw (-0.15, 0) arc (180:0:0.15);
\draw (0, 0) arc (180:0:0.15);
\draw (0.15, 0) arc (180:0:0.15);
\draw (0.3, 0) arc (180:0:0.15);
\draw (0.45, 0) arc (180:0:0.15);
\draw (0.6, 0) arc (180:0:0.15);
\draw (0.75, 0) arc (180:0:0.15);
\draw (0.9, 0) arc (180:0:0.15);
\draw (1.05, 0) arc (180:0:0.15);
\draw (1.2, 0) arc (180:0:0.15);
\draw (1.35, 0) arc (180:0:0.15);
\draw (1.5, 0) arc (180:0:0.15);
\draw (1.65, 0) arc (180:0:0.15);
\draw (1.8, 0) arc (180:0:0.15);
\draw (1.95, 0) arc (180:0:0.15);
\draw (2.1, 0) arc (180:0:0.15);
\draw (2.25, 0) arc (180:40:0.15);
\draw (2.4, 0) arc (180:110:0.15);
\draw (-1.5, 0) to (-1.5, 3.5);
\draw (-0.5, 0) to (-0.5, 3.5);
\draw (0.5, 0) to (0.5, 3.5);
\draw (1.5, 0) to (1.5, 3.5);
\draw [very thick] (-0.5, 0.866) arc (120:60:1);
\draw [very thick] (-1.5, 0.866) arc (120:60:1);
\draw [very thick] (0.5, 0.866) arc (120:60:1);
\draw [->, very thick] (-1.5, 0.866) to (-1.5, 3);
\draw [->, very thick] (-0.5, 0.866) to (-0.5, 3);
\draw [->, very thick] (0.5, 0.866) to (0.5, 3);
\draw [->, very thick] (1.5, 0.866) to (1.5, 3);
\draw (0, -0.5) node{$ \DDD = \cbr{z \in \HH \st \tfrac{1}{2} \le \Re z \le \tfrac{1}{2}, \ \abs{z} \ge 1} \subseteq \HH $};
\end{tikzpicture}
$$
}
\def\syllabus{Modular forms of level one. Eisenstein series. Spaces of modular forms of level one. Theta series. Hecke operators of level one. $ \L $-functions of level one. Modular forms of higher level. Spaces of modular forms of higher level. Hecke operators of higher level. $ \L $-functions of higher level. Oldforms and newforms.}
\def\thm{subsection}

\input{../style/header}

% Macros
\newcommand{\twobytwosmall}[4]{
  \begin{psmallmatrix}
    #1 & #2 \\
    #3 & #4
  \end{psmallmatrix}
}

\begin{document}

\input{../style/cover}

\section{Introduction}

\lecture{1}{Friday}{04/10/19}

The following are textbooks.
\begin{itemize}
\item J P Serre, A course in arithmetic, 1973
\item J Shurman and F Diamond, A first course in modular forms, 2005
\end{itemize}

Let
$$ f = q\prod_{n = 1}^\infty \br{1 - q^n}^2\br{1 - q^{11n}}^2 = \sum_{n = 1} b_nq^n = q - 2q^2 - q^3 + 2q^4 + q^5 + 2q^6 - 2q^7 + \dots, $$
and let $ a_n $ be the number of solutions modulo $ n $ to the elliptic curve
$$ E = \cbr{\br{x, y} \in \ZZ \st y^2 + y = x^3 - x^2 - 10x - 20}. $$
\begin{itemize}
\item Modulo $ 2 $, there are $ a_2 = 4 $ solutions $ \br{0, 0} $, $ \br{0, 1} $, $ \br{1, 0} $, $ \br{1, 1} $.
\item Modulo $ 3 $, there are $ a_3 = 4 $ solutions $ \br{1, 0} $, $ \br{1, -1} $, $ \br{-1, 0} $, $ \br{-1, -1} $.
\item Modulo $ 5 $, there are $ a_5 = 4 $ solutions $ \br{0, 0} $, $ \br{0, -1} $, $ \br{1, 0} $, $ \br{1, -1} $.
\item Modulo $ 7 $, there are $ a_7 = 9 $ solutions $ \br{1, 3} $, $ \br{2, 2} $, $ \br{2, -3} $, $ \br{-1, 1} $, $ \br{-1, -2} $, $ \br{-2, 1} $, $ \br{-2, -2} $, $ \br{-3, 1} $, $ \br{-3, -2} $.
\end{itemize}
If $ p \ne 11 $, then
$$ a_p - p = -b_p. $$
The following are some questions.
\begin{itemize}
\item What is the relationship between $ E $ and $ f $?
\item Can we find similar relationships for other $ E $?
\item How does one prove something like this?
\end{itemize}
Let
$$ \HH = \cbr{x + iy \st x, y \in \RR, \ y > 0} \subseteq \CC. $$
Then $ \HH $ has an action of
$$ \SL_2\br{\RR} = \cbr{\twobytwo{a}{b}{c}{d} \st a, b, c, d \in \RR, \ ad - bc = 1}. $$
Modular forms are complex functions on $ \HH $ with a high degree of symmetry. These functions are symmetric under the action of large discrete subgroups of $ \SL_2\br{\RR} $, in particular
$$ \SL_2\br{\ZZ} = \cbr{\twobytwo{a}{b}{c}{d} \st a, b, c, d \in \ZZ, \ ad - bc = 1} \subseteq \SL_2\br{\RR}. $$
Why are these interesting to number theorists? Power series expansions often involve expressions of interest to number theorists. For example,
\begin{itemize}
\item Bernoulli numbers,
\item divisor functions $ \sigma_k\br{n} = \sum_{d \mid n} d^k $,
\item number of points on elliptic curves, and
\item traces of Galois representations.
\end{itemize}

\pagebreak

\section{Modular forms of level one}

\subsection{Modular forms}

\subsubsection{Modular actions}

$ \SL_2\br{\RR} $ acts on $ \CC \cup \cbr{\infty} $ by
$$ \twobytwo{a}{b}{c}{d} \cdot z =
\begin{cases}
\dfrac{az + b}{cz + d} & z \ne -\dfrac{d}{c} \\
\infty & z = -\dfrac{d}{c} \\
\dfrac{a}{c} & z = \infty
\end{cases}.
$$
One checks that this gives a bijection from $ \CC \cup \cbr{\infty} $ to $ \CC \cup \cbr{\infty} $, where the inverse is given by the inverse matrix $ \twobytwosmall{d}{-b}{-c}{a} $, and
$$ \twobytwo{a}{b}{c}{d} \cdot \br{\twobytwo{a'}{b'}{c'}{d'} \cdot z} = \twobytwo{a}{b}{c}{d}\twobytwo{a'}{b'}{c'}{d'} \cdot z. $$
One obtains a left action of $ \SL_2\br{\RR} $ on $ \CC \cup \cbr{\infty} $. An observation is
$$ \Im \twobytwo{a}{b}{c}{d}z = \Im \dfrac{az + b}{cz + d} = \Im \dfrac{\br{az + b}\br{c\overline{z} + d}}{\abs{cz + d}^2} = \dfrac{\Im \br{az + b}\br{c\overline{z} + d}}{\abs{cz + d}^2} = \dfrac{\br{ad - bc}\Im z}{\abs{cz + d}^2}. $$
In particular, if $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\RR} $, then
$$ \Im \gamma z = \dfrac{\Im z}{\abs{cz + d}^2}. $$
So $ \SL_2\br{\RR} $ preserves $ \HH \cup \cbr{\infty} $. More generally, if
$$ \gamma = \twobytwo{a}{b}{c}{d} \in \GL_2\br{\RR} = \cbr{\twobytwo{a}{b}{c}{d} \st a, b, c, d \in \RR, \ ad - bc \ne 0}, $$
then
$$ \Im \gamma z = \dfrac{\det \gamma\Im z}{\abs{cz + d}^2}. $$
So
$$ \GL_2\br{\RR}_+ = \cbr{\twobytwo{a}{b}{c}{d} \st a, b, c, d \in \RR, \ ad - bc > 0} $$
preserves $ \HH \cup \cbr{\infty} $.

\lecture{2}{Friday}{04/10/19}

\begin{definition}
Let $ f : \HH \to \CC $, let $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \GL_2\br{\RR}_+ $, and let $ k \in \ZZ $. Define
$$ \function[\eval{f}_{k, \gamma}]{\HH}{\CC}{z}{\det \gamma^{k - 1}f\br{\gamma z}\br{cz + d}^{-k}}, $$
where $ \det \gamma^{k - 1} $ is the \textbf{fudge factor}, which is one for $ \gamma \in \SL_2\br{\RR} $, and $ \br{cz + d}^{-k} $ is the \textbf{twisted action} on functions.
\end{definition}

Check that
$$ \eval{f}_{k, \id} = f, \qquad \eval{\br{\eval{f}_{k, \gamma}}}_{k, \gamma'} = \eval{f}_{k, \gamma\gamma'}. $$
This gives, for each $ k $, a left action of $ \GL_2\br{\RR}_+ $ on functions $ \HH \to \CC $, a \textbf{modular action of weight $ k $}. A modular form of weight $ k $ will be a sufficiently nice function $ f : \HH \to \CC $ such that $ \eval{f}_{k, \gamma} = f $ for all $ \gamma \in \SL_2\br{\ZZ} $. That is, for all $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $ and $ z \in \HH $,
$$ f\br{\gamma z}\br{cz + d}^{-k} = f\br{z} \qquad \implies \qquad f\br{\gamma z} = f\br{z}\br{cz + d}^k, $$
the \textbf{modular transformation law of weight $ k $}.

\pagebreak

The following are some observations.
\begin{itemize}
\item Let $ k = 0 $. Then constant functions satisfy $ f\br{\gamma z} = f\br{z} $. It will turn out that all functions of weight zero are constant.
\item Let $ k $ be odd, and $ \gamma = -\id $. Then $ \gamma z = z $ for all $ z $ and $ cz + d = -1 $, so $ f\br{\gamma z} = f\br{z}\br{cz + d}^k $ gives $ f\br{z} = f\br{z}\br{-1}^k = -f\br{z} $, so $ f\br{z} = 0 $ for all $ z $. So no non-zero functions $ f : \HH \to \CC $ satisfy the modular transformation law of weight $ k $, for all $ \gamma \in \SL_2\br{\ZZ} $, when $ k $ is odd.
\end{itemize}

\subsubsection{Review of complex analysis}

Let $ f : U \to \CC $ for $ U \subseteq \CC $ open, and let $ p \in U $.

\begin{definition}
$ f $ is \textbf{holomorphic} at $ p $ if
$$ f'\br{p'} = \lim_{\epsilon \to 0, \ \epsilon \in \CC} \dfrac{f\br{p' + \epsilon} - f\br{p'}}{\epsilon} $$
exists for all $ p' $ in a neighbourhood of $ p $.
\end{definition}

\begin{proposition}
$ f $ is holomorphic at $ p $ implies that $ f $ is continuous and infinitely differentiable at $ p $, that is $ f^{\br{n}}\br{p} $ exists for all $ n \ge 0 $. Moreover, we have
$$ f\br{z} = \sum_{n = 0}^\infty \dfrac{f^{\br{n}}\br{p}}{n!}\br{z - p}^n = f\br{p} + f'\br{p}\br{z - p} + \dfrac{f''\br{p}}{2}\br{z - p}^2 + \dots, $$
for all $ z $ in a neighbourhood of $ p $.
\end{proposition}

\begin{corollary}
If $ f $ is holomorphic and not identically zero on an open set $ U $, then the zeroes of $ f $ are isolated on $ U $.
\end{corollary}

More generally is the following.

\begin{definition}
$ f $ is \textbf{meromorphic} at $ p $ if there exists a neighbourhood $ U $ of $ p $ and $ g, h : U \to \CC $ holomorphic on $ U $ such that $ f = g / h $ on $ U \setminus \cbr{p} $. Such an $ f $ has a \textbf{Laurent series expansion} at $ p $,
$$ f\br{z} = \sum_{i = -N}^\infty c_i\br{z - p}^i. $$
The smallest $ i $ such that $ c_i \ne 0 $ is denoted by $ \ord_p f $, the \textbf{order of vanishing} of $ f $ at $ p $.
\begin{itemize}
\item If $ \ord_p f = -n $ for $ n > 0 $, we say $ f $ has a \textbf{pole of order $ n $}.
\item If $ \ord_p f = n $ for $ n > 0 $, we say $ f $ has a \textbf{zero of order $ n $}.
\end{itemize}
\end{definition}

\begin{proposition}
\hfill
\begin{itemize}
\item $ \ord_p fg = \ord_p f + \ord_p g $, and
\item $ \ord_p \br{f + g} \ge \min\cbr{\ord_p f, \ord_p g} $, with equality if $ \ord_p f \ne \ord_p g $.
\end{itemize}
\end{proposition}

If $ f $ is holomorphic on $ U \setminus \cbr{p} $ for $ U $ a neighbourhood of $ p $, then $ f $ may or may not be meromorphic at $ p $.

\begin{example*}
$ f\br{z} = e^{-1 / z^2} $ is holomorphic on $ \CC \setminus \cbr{0} $, but not meromorphic at zero.
\end{example*}

\begin{theorem}
Let $ f $ be holomorphic on $ U \setminus \cbr{p} $, and there exists $ n > 0 $ such that
$$ \lim_{x \to p} \br{x - p}^nf\br{x} $$
exists. Then $ f $ is meromorphic on $ U $, and $ \ord_p f \ge -n $.
\end{theorem}

\pagebreak

\subsubsection{Modular forms}

\begin{definition}
$ f : \HH \to \CC $ is a \textbf{weakly modular function of weight $ k $} if
\begin{itemize}
\item $ f $ is meromorphic on $ \HH $, and
\item $ f $ satisfies the modular transformation law of weight $ k $.
\end{itemize}
\end{definition}

Consider $ \gamma = \twobytwosmall{1}{1}{0}{1} $, so $ \gamma z = z + 1 $ and $ cz + d = 1 $. The modular transformation law gives $ f\br{z + 1} = f\br{z} $. Let
$$ \DD = \cbr{q \st \abs{q} < 1}. $$
Can define a function
$$ \function[g]{\DD \setminus \cbr{0}}{\HH}{q}{f\br{\dfrac{\log q}{2\pi i}}}, $$
that is
$$ \function[f]{\HH}{\DD \setminus \cbr{0}}{z}{g\br{e^{2\pi iz}}}, $$
and $ q = e^{2\pi iz} $, where $ g $ is holomorphic or meromorphic on $ \DD \setminus \cbr{0} $ if and only if $ f $ is holomorphic or meromorphic on $ \HH $.

\begin{definition}
$ f : \HH \to \CC $ is a \textbf{modular form of weight $ k $} if
\begin{enumerate}
\item $ f $ satisfies the modular transformation law of weight $ k $,
\item $ f $ is holomorphic on $ \HH $, and
\item $ f $ is holomorphic at $ \infty $, so the function $ g : \DD \setminus \cbr{0} \to \CC $, which is holomorphic on $ \DD \setminus \cbr{0} $ by $ 2 $, extends to a holomorphic function on $ \DD $.
\end{enumerate}
\end{definition}

\lecture{3}{Monday}{07/10/19}

Then $ q \to 0 $ in $ \DD $ if and only if $ \Im z \to +\infty $. Recall that a holomorphic function $ g $ on $ \DD \setminus \cbr{0} $ extends to a meromorphic function on $ \DD $ if and only if there exists $ n $ such that $ \lim_{q \to 0} q^ng\br{q} $ exists. Then $ 3 $ means $ g\br{q} $ is bounded as $ q \to 0 $ so $ f\br{z} $ is bounded as $ \Im z \to +\infty $. For $ f $ satisfying $ 3 $, $ g : \DD \setminus \cbr{0} \to \CC $ has a series expansion
$$ g\br{q} = \sum_n a_nq^n = a_0 + a_1q + \dots $$
in $ q = e^{2\pi iz} $. We call this the \textbf{$ q $-expansion} for $ f $.

\begin{definition}
$ f : \HH \to \CC $ is a \textbf{meromorphic modular form of weight $ k $} if the same conditions $ 1 $ to $ 3 $ hold, but with holomorphic weakened to meromorphic.
\end{definition}

\begin{note*}
If $ f $ is only meromorphic at $ \infty $ then a finite number of negative powers of $ q $ can appear.
\end{note*}

\begin{example*}
\hfill
\begin{itemize}
\item The \textbf{discriminant}
$$ \Delta\br{z} = q\prod_{n = 1}^\infty \br{1 - q^n}^{24} = q - 24q^2 + 252q^3 - 1472q^4 + \dots $$
is a modular form of weight twelve.
\item The \textbf{$ \j $-invariant}
$$ \j\br{z} = \dfrac{1}{q} + 744 + 196844q + 21493760q^2 + \dots $$
is a meromorphic modular form of weight zero.
\end{itemize}
\end{example*}

\pagebreak

\subsection{Eisenstein series}

\subsubsection{Lattice functions}

How can we construct modular forms?

\begin{definition}
A \textbf{lattice} in $ \CC $ is an abelian subgroup of $ \CC $ of the form $ \ZZ w_1 + \ZZ w_2 $, where $ w_1, w_2 \in \CC $ are $ \RR $-linearly independent. More generally if $ V $ is an $ \RR $-vector space, a \textbf{lattice} $ L $ in $ V $ is a discrete abelian subgroup of $ V $ that spans $ V $ over $ \RR $. For $ L \subseteq \CC $ a lattice and $ \lambda \in \CC^\times $, let
$$ \lambda L = \cbr{\lambda x \st x \in L} \subseteq \CC. $$
We say that $ L $ and $ \lambda L $ are \textbf{homothetic}. For $ z \in \HH $, let
$$ \L_{z, 1} = \ZZ + \ZZ z = \cbr{az + b \st a, b \in \ZZ} \subseteq \CC. $$
\end{definition}

A question is when is $ \L_{z, 1} $ homothetic to $ \L_{z', 1} $, and what is a homothety factor?
\begin{itemize}
\item Suppose $ \L_{z, 1} = \lambda \L_{z', 1} $. Then there exist $ a, b, c, d $ such that
\begin{equation}
\label{eq:1}
\begin{cases}
\lambda z' = az + b \\
\lambda = cz + d
\end{cases}
\qquad \implies \qquad \twobyone{\lambda z'}{\lambda} = \twobytwo{a}{b}{c}{d}\twobyone{z}{1}.
\end{equation}
On the other hand there exist $ a', b', c', d' $ such that
\begin{equation}
\label{eq:2}
\begin{cases}
z = a'\lambda z' + b'\lambda \\
1 = c'\lambda z' + d'\lambda
\end{cases}
\qquad \implies \qquad \twobytwo{a'}{b'}{c'}{d'}\twobyone{\lambda z'}{\lambda} = \twobyone{z}{1}.
\end{equation}
By $ \br{\ref{eq:1}} $ and $ \br{\ref{eq:2}} $,
$$ \twobytwo{a'}{b'}{c'}{d'}\twobytwo{a}{b}{c}{d}\twobyone{z}{1} = \twobyone{z}{1}, $$
so $ \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $. Moreover $ \br{\ref{eq:1}} $ implies that $ z' = \br{az + b} / \br{cz + d} $.
\item Conversely, if $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $, then $ \gamma z = \br{az + b} / \br{cz + d} $, so
$$ \L_{\gamma z, 1} = \br{cz + d}^{-1}\L_{az + b, cz + d}. $$
But certainly $ \L_{az + b, cz + d} \subseteq \L_{z, 1} $. On the other hand if $ \gamma' = \twobytwosmall{a'}{b'}{c'}{d'} $ is inverse to $ \gamma $,
$$ \twobyone{z}{1} = \gamma'\gamma\twobyone{z}{1} = \gamma\twobyone{az + b}{cz + d} = \twobyone{a'\br{az + b} + b'\br{cz + d}}{c'\br{az + b} + d'\br{cz + d}}, $$
so $ z \in \L_{az + b, cz + d} $ and $ 1 \in \L_{az + b, cz + d} $. So
$$ \L_{az + b, cz + d} = \L_{z, 1}, $$
so $ \L_{\gamma z, 1} = \br{cz + d}^{-1}\L_{z, 1} $.
\end{itemize}

\begin{definition}
A \textbf{lattice function of weight $ k $} is a function $ F : \cbr{\text{lattices in} \ \CC} \to \CC $ such that
$$ F\br{\lambda L} = \lambda^{-k}F\br{L}, $$
for all lattices $ L $. Given such an $ F $, can define
$$ \function[f]{\HH}{\CC}{z}{F\br{\L_{z, 1}}}. $$
\end{definition}

If $ F $ has weight $ k $, then
$$ f\br{\gamma z} = F\br{\L_{\gamma z, 1}} = F\br{\br{cz + d}^{-1}\L_{z, 1}} = \br{cz + d}^kF\br{\L_{z, 1}} = \br{cz + d}^kf\br{z}, \qquad \gamma = \twobytwo{a}{b}{c}{d}. $$

\pagebreak

\subsubsection{Eisenstein series}

\lecture{4}{Friday}{11/10/19}

\begin{definition}
For $ L \in \CC $, define the \textbf{Eisenstein series}
$$ \G_k\br{L} = \sum_{w \in L, \ w \ne 0} \dfrac{1}{w^k}, \qquad \g_k\br{z} = \G_k\br{\L_{z, 1}} = \underset{\br{m, n} \ne \br{0, 0}}{\sum_{m = -\infty}^\infty \sum_{n = -\infty}^\infty} \dfrac{1}{\br{mz + n}^k}. $$
\end{definition}

Then
$$ \G_k\br{\lambda L} = \sum_{w' \in \lambda L, \ w' \ne 0} \dfrac{1}{w'^k} = \sum_{w \in L, \ w \ne 0} \dfrac{1}{\br{\lambda w}^k} = \lambda^{-k}\G_k\br{L}. $$

\begin{corollary}
$ \g_k $ satisfies the modular transformation law of weight $ k $.
\end{corollary}

The following are some questions.
\begin{itemize}
\item Does $ \G_k $, or $ \g_k $, converge?
\item Is $ \g_k $ holomorphic, or meromorphic, on $ \HH $?
\item Is $ \g_k $ holomorphic at $ \infty $?
\item What is the $ q $-expansion of $ \g_k $?
\end{itemize}

\subsubsection{Convergence and holomorphy on \texorpdfstring{$ \HH $}{H}}

\begin{definition}
Let $ U \subseteq \CC $ be open. A sequence of functions $ f_n : U \to \CC $ \textbf{converges uniformly on compact sets} to $ f $ if for all $ C \subseteq U $ compact and $ \epsilon > 0 $, there exists $ N \in \ZZ $ such that for all $ n > N $,
$$ \abs{f\br{z} - f_n\br{z}} < \epsilon, \qquad z \in C. $$
\end{definition}

\begin{theorem}
A uniform limit of holomorphic functions is holomorphic. If $ f_n $ converges to $ f $ uniformly on compact sets and $ f_n $ is holomorphic on $ U $, then $ f $ is holomorphic on $ U $.
\end{theorem}

\begin{theorem}
Let $ k \ge 4 $. The series $ \g_k\br{z} $ converges absolutely and uniformly on compact subsets of $ \HH $.
\end{theorem}

\begin{proof}
Let
$$ P_{z, r} = \cbr{az + b \st a, b \in \RR, \ \max\br{\abs{a}, \abs{b}} = r} \subseteq \CC, $$
so $ P_{z, r} = rP_{z, 1} $, and there are $ 8r $ points on $ P_{z, r} \cap \L_{z, 1} $. Then
$$ \g_k\br{z} = \sum_{r = 1}^\infty \sum_{w \in \L_{z, 1} \cap P_{z, r}} \dfrac{1}{w^k}. $$
The function $ z \mapsto \abs{z} $ attains a non-zero minimum $ \delta\br{z} $ on $ P_{z, 1} $, so on $ P_{z, 1} $, have $ \abs{z} > \delta\br{z} $, so $ 1 / \abs{z}^k < 1 / \delta\br{z}^k $. On $ P_{z, r} $, have $ \abs{z} > r\delta\br{z} $, so $ 1 / \abs{z}^k < 1 / r^k\delta\br{z}^k $. Let $ C \subseteq \HH $ be compact. Then $ z \mapsto \delta\br{z} $ is a continuous function on $ C $ and attains a minimum $ \delta_C $. For all $ z \in C $ and $ w \in P_{z, r} $, get $ \abs{w} > r\delta_C $, so
$$ \dfrac{1}{\abs{w}^k} < \dfrac{1}{r^k\delta_C^k}. $$
Thus for $ z \in C $, $ \g_k\br{z} $ is dominated by
$$ \sum_{r = 1}^\infty \dfrac{8r}{r^k\delta_C^k} = \dfrac{8}{\delta_C^k}\sum_{r = 1}^\infty \dfrac{1}{r^{k - 1}}, $$
which converges absolutely for $ k \ge 4 $.
\end{proof}

\begin{corollary}
$ \g_k\br{z} $ is holomorphic on $ \HH $.
\end{corollary}

\pagebreak

\subsubsection{\texorpdfstring{$ q $}{q}-expansion and holomorphy at \texorpdfstring{$ \infty $}{infinity}}

The idea is to understand series of the form
$$ \sum_{n = -\infty}^\infty \dfrac{1}{\br{z + n}^k}. $$

\begin{theorem}
A bounded holomorphic function on all of $ \CC $ is constant.
\end{theorem}

\begin{lemma}
\hfill
\begin{enumerate}
\item
$$ \dfrac{\pi^2}{\sin^2 \pi z} = \sum_{n = -\infty}^\infty \dfrac{1}{\br{z - n}^2}. $$
\item
$$ \pi\cot \pi z = \dfrac{1}{z} + \sum_{n = 1}^\infty \br{\dfrac{1}{z - n} + \dfrac{1}{z + n}} = \dfrac{1}{z} + \sum_{n = 1}^\infty \dfrac{2z}{z^2 - n^2}. $$
\end{enumerate}
\end{lemma}

\begin{proof}
\hfill
\begin{enumerate}
\item The right hand side converges absolutely and uniformly on compact subsets of $ \CC \setminus \ZZ $, so the right hand side is holomorphic on $ \CC \setminus \ZZ $. Locally around $ z = n $, the series looks like
$$ \sum_{n = -\infty}^\infty \dfrac{1}{\br{z - n}^2} = \dots + \dfrac{1}{\br{z - n + 1}^2} + \dfrac{1}{\br{z - n}^2} + \dfrac{1}{\br{z - n - 1}^2} + \dots = \dfrac{1}{\br{z - n}^2} + h_1\br{z}, $$
where $ h_1\br{z} $ is holomorphic in a neighbourhood of $ z = n $. Similarly, the left hand side is meromorphic on $ \CC $, and the Laurent series near $ z = n $ is
$$ \dfrac{\pi^2}{\sin^2 \pi z} = \pi\br{\dfrac{1}{\pi^2\br{z - n}^2} + \dfrac{1}{3} + \dfrac{1}{15}\pi^2\br{z - n}^2 + \dots} = \dfrac{1}{\br{z - n}^2} + h_2\br{z}, $$
where $ h_2\br{z} $ is a holomorphic function. So the difference
$$ g\br{z} = \sum_{n = -\infty}^\infty \dfrac{1}{\br{z - n}^2} - \dfrac{\pi^2}{\sin^2 \pi z} $$
is meromorphic on $ \CC $ and holomorphic on $ \CC \setminus \ZZ $, and the Laurent expression around $ z = n $ is
$$ g\br{z} = \dfrac{1}{\br{z - n}^2} + h_1\br{z} - \br{\dfrac{1}{\br{z - n}^2} + h_2\br{z}} = h_1\br{z} - h_2\br{z}, $$
so $ g\br{z} $ is holomorphic at $ z = n $ for all $ n $. Consider $ t \to \pm\infty $ for $ z = a + it $. The right hand side is
$$ R = \sum_{n = -\infty}^\infty \dfrac{1}{\br{z - n}^2} = \sum_{n = a - N}^{a + N} \dfrac{1}{\br{z - n}^2} + \sum_{n = -\infty}^{a - N - 1} \dfrac{1}{\br{z - n}^2} + \sum_{n = a + N + 1}^\infty \dfrac{1}{\br{z - n}^2} = R_0 + R_- + R_+, $$
where $ R_0 $ has finitely many terms that converge to less than $ \epsilon / 2 $ as $ t \to \pm\infty $ and $ R_- + R_+ < \epsilon / 2 $ for $ N \gg 0 $ independent of $ t $, so $ R < \epsilon $ converges to zero. Similarly, the left hand side is
$$ \abs{\dfrac{\pi^2}{\sin^2 \pi z}} = \abs{\dfrac{2\pi^2}{e^{\pi iz} - e^{-\pi iz}}} \to 0, $$
so $ \lim_{t \to \infty} g\br{a + it} = 0 $. Moreover, $ g\br{z + 1} = g\br{z} $ for all $ z $. Then
$$ S = \cbr{z \in \CC \st n - 1 \le \Re z \le n, \ -N \le \Im z \le N}, \qquad n \in \ZZ $$
is compact, so $ \abs{g\br{z}} $ attains a maximum in $ S $, so $ g\br{z} $ is bounded in $ S $, so $ g\br{z} $ is bounded in $ \CC $, so $ g $ is constant. Since $ \lim_{t \to \infty} g\br{a + it} = 0 $, $ g = 0 $.

\pagebreak

\lecture{5}{Friday}{11/10/19}

\item Check that the right hand side converges absolutely and uniformly on compact subsets of $ \CC \setminus \ZZ $, so the right hand side is meromorphic on $ \CC \setminus \ZZ $. Similarly, the left hand side is also meromorphic on $ \CC \setminus \ZZ $. Comparing derivatives,
$$ -\dfrac{\pi^2}{\sin^2 \pi z} = -\dfrac{1}{z^2} - \sum_{n = 1}^\infty \br{\dfrac{1}{\br{z - n}^2} + \dfrac{1}{\br{z + n}^2}}, $$
so the difference is constant. Let $ z = \tfrac{1}{2} $. The left hand side is $ \pi\cot \tfrac{\pi}{2} = 0 $ and the right hand side is
$$ \dfrac{2}{1} + \br{-\dfrac{2}{1} + \dfrac{2}{3}} + \br{-\dfrac{2}{3} + \dfrac{2}{5}} + \dots \to 0, \qquad n \to \infty, $$
so the difference is zero.
\end{enumerate}
\end{proof}

Thus
$$ \dfrac{1}{z} + \sum_{n = 1}^\infty \br{\dfrac{1}{z - n} + \dfrac{1}{z + n}} = \pi\cot \pi z = \pi i\dfrac{e^{\pi iz} + e^{-\pi iz}}{e^{\pi iz} - e^{-\pi iz}} = \pi i\dfrac{q + 1}{q - 1} = \pi i - \dfrac{2\pi i}{1 - q} = \pi i - 2\pi i\sum_{n = 0}^\infty q^n. $$
Take $ \tod[k - 1]{}{z} $. For $ k \ge 2 $ even, get
$$ -\br{k - 1}!\sum_{n = -\infty}^\infty \dfrac{1}{\br{z + n}^k} = -\br{2\pi i}^k\sum_{n = 1}^\infty n^{k - 1}q^n, $$
so
$$ \sum_{n = -\infty}^\infty \dfrac{1}{\br{z + n}^k} = \dfrac{\br{2\pi i}^k}{\br{k - 1}!}\sum_{n = 1}^\infty n^{k - 1}q^n. $$
Collecting powers of $ q $,
\begin{align*}
\g_k\br{z}
& = \underset{\br{m, n} \ne \br{0, 0}}{\sum_{m = -\infty}^\infty \sum_{n = -\infty}^\infty} \dfrac{1}{\br{mz + n}^k} \\
& = 2\sum_{n = 1}^\infty \dfrac{1}{n^k} + 2\sum_{m = 1}^\infty \sum_{n = -\infty}^\infty \dfrac{1}{\br{mz + n}^k} \\
& = 2\zeta\br{k} + \dfrac{2\br{2\pi i}^k}{\br{k - 1}!}\sum_{m = 1}^\infty \sum_{n = 1}^\infty n^{k - 1}q^{nm} & \zeta\br{s} = \sum_{n = 1}^\infty n^{-s} \\
& = 2\zeta\br{k} + \dfrac{2\br{2\pi i}^k}{\br{k - 1}!}\sum_{n = 1}^\infty \sigma_{k - 1}\br{n}q^n & \sigma_{k - 1}\br{n} = \sum_{d \mid n, \ d > 0} d^{k - 1}.
\end{align*}

\begin{corollary}
$ \g_k\br{z} $ is holomorphic at $ \infty $. In particular, $ \g_k $ is a modular form of weight $ k $.
\end{corollary}

\subsubsection{Bernoulli numbers}

\begin{definition}
The \textbf{Bernoulli numbers} $ \b_k $ are defined by
$$ \sum_{k = 0}^\infty \b_k\dfrac{x^k}{k!} = \dfrac{x}{e^x - 1}, $$
a formal power series with rational coefficients.
\end{definition}

Then
$$ \b_0 = 1, \qquad \b_1 = -\dfrac{1}{2}, \qquad \b_2 = \dfrac{1}{6}, \qquad \b_3 = 0, \qquad \b_4 = -\dfrac{1}{20}, \qquad \dots, $$
where $ \b_{2k} \in \QQ $ is interesting and $ \b_{2k + 1} = 0 $ for $ k \ge 1 $.

\pagebreak

\begin{proposition}
For all even $ k $,
$$ \zeta\br{k} = -\b_k\dfrac{\br{2\pi i}^k}{2k!}. $$
\end{proposition}

\begin{proof}
On one hand,
$$ \pi z\cot \pi z = \pi iz + \dfrac{2\pi iz}{e^{2\pi iz} - 1} = \pi iz + \sum_{k = 0}^\infty \b_k\dfrac{\br{2\pi iz}^k}{k!}. $$
On the other hand,
\begin{align*}
\pi\cot \pi z
& = \dfrac{1}{z} + \sum_{n = 1}^\infty \dfrac{2z}{z^2 - n^2}
= \dfrac{1}{z} - \dfrac{2z}{n^2}\sum_{n = 1}^\infty \dfrac{1}{1 - z^2 / n^2} \\
& = \dfrac{1}{z} - \sum_{n = 1}^\infty \dfrac{2}{z}\sum_{k = 1}^\infty \br{\dfrac{z^2}{n^2}}^k
= \dfrac{1}{z} - \dfrac{2}{z}\sum_{k = 1}^\infty z^{2k}\sum_{n = 1}^\infty \dfrac{1}{n^{2k}} \\
& = \dfrac{1}{z} - \dfrac{2}{z}\sum_{k = 1}^\infty \zeta\br{2k}z^{2k},
\end{align*}
so
$$ \pi iz + \sum_{k = 0}^\infty \b_k\dfrac{\br{2\pi iz}^k}{k!} = \pi z\cot \pi z = 1 - 2\sum_{k = 1}^\infty \zeta\br{2k}z^{2k}. $$
Comparing,
$$ \b_{2k}\dfrac{\br{2\pi i}^{2k}}{\br{2k}!} = -2\zeta\br{2k}, $$
get the desired formula.
\end{proof}

So
$$ \g_k\br{z} = -\b_k\dfrac{\br{2\pi i}^k}{k!} + \dfrac{2\br{2\pi i}^k}{\br{k - 1}!}\sum_{n = 1}^\infty \sigma_{k - 1}\br{n}q^n. $$
Set the \textbf{normalised Eisenstein series}
$$ \E_k = \dfrac{\g_k}{2\zeta\br{k}} = 1 - \dfrac{2k}{\b_k}\sum_{n = 1}^\infty \sigma_{k - 1}\br{n}q^n. $$

\begin{example*}
$$ \E_4 = 1 + 240\sum_{n = 1}^\infty \sigma_3\br{n}q^n, \qquad \E_6 = 1 - 504\sum_{n = 1}^\infty \sigma_5\br{n}q^n, $$
$$ \E_8 = 1 + 480\sum_{n = 1}^\infty \sigma_7\br{n}q^n, \qquad \E_{12} = 1 + \dfrac{65520}{691}\sum_{n = 1}^\infty \sigma_{11}\br{n}q^n. $$
\end{example*}

$ p $ is \textbf{regular} if $ p \nmid \h\br{\ZZ\sbr{\zeta_p}} $ for $ \zeta_p^p = 1 $.

\begin{theorem}
$ p $ is regular if and only if $ p $ does not divide the numerator of $ \b_k $ for $ 1 \le k < p - 1 $.
\end{theorem}

\lecture{6}{Monday}{14/10/19}

An observation is if $ f $ is modular of weight $ k $ and $ g $ is modular of weight $ k' $, then $ fg $ is modular of weight $ k + k' $, and if $ k = k' $, then $ f + g $ is modular of weight $ k $.

\begin{example*}
\hfill
\begin{itemize}
\item The discriminant
$$ \Delta\br{z} = \dfrac{\E_4^3 - \E_6^2}{1728} = q - 24q^2 + 252q^3 + \dots $$
is a modular form of weight twelve.
\item The $ \j $-invariant
$$ \j\br{z} = \dfrac{\E_4^3}{\Delta} = \dfrac{1}{q} + 744 + 196844q + \dots $$
is a meromorphic modular form of weight zero.
\end{itemize}
\end{example*}

\pagebreak

\subsection{Spaces of modular forms}

\subsubsection{The fundamental domain}

The idea is to control the action of $ \SL_2\br{\ZZ} $ on $ \HH $. If $ f : \HH \to \CC $ satisfies $ f\br{\gamma z} = \br{cz + d}^kf\br{z} $ for all $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $, and if $ D \subseteq \HH $ such that $ D $ meets every $ \SL_2\br{\ZZ} $-orbit in $ \HH $, then $ f $ is determined by its values on $ D $.

\begin{definition}
Let $ G $ be a group acting continuously on a complex analytic space $ X $, such as $ X = \HH $. A subset $ D \subseteq X $ is a \textbf{fundamental domain} for the action of $ G $ if
\begin{itemize}
\item $ D $ meets every $ G $-orbit in $ X $,
\item the subset $ \cbr{x \in D \st \exists g \in G, \ gx \in D, \ gx \ne x} $ has measure zero, and
\item $ D $ is closed in $ X $.
\end{itemize}
\end{definition}

Define
$$ \DDD = \cbr{z \in \HH \st \tfrac{1}{2} \le \Re z \le \tfrac{1}{2}, \ \abs{z} \ge 1} \subseteq \HH, $$
so
$$
\begin{tikzpicture}[scale=2]
\draw [dotted, thick] (-2, 0) to (2, 0);
\draw [dotted, thick] (0, 0) to (0, 2);
\draw [dashed] (-1, 0) arc (180:0:1);
\draw [dashed] (-0.5, 0) to (-0.5, 2);
\draw [dashed] (0.5, 0) to (0.5, 2);
\draw (-0.5, 0.866) arc (120:60:1);
\draw (-0.5, 0.866) to (-0.5, 2);
\draw (0.5, 0.866) to (0.5, 2);
\fill (0, 1) circle (0.025) node[below]{$ i $};
\fill (-0.5, 0.866) circle (0.025) node[below left]{$ -\tfrac{1}{2} + \tfrac{\sqrt{-3}}{2} = e^{\tfrac{2\pi i}{3}} = \rho $};
\fill (0.5, 0.866) circle (0.025) node[below right]{$ \rho' = e^{\tfrac{\pi i}{3}} = \tfrac{1}{2} + \tfrac{\sqrt{-3}}{2} $};
\end{tikzpicture}.
$$
Let
$$ \S = \twobytwo{0}{-1}{1}{0} : z \mapsto -\dfrac{1}{z}, \qquad \T = \twobytwo{1}{1}{0}{1} : z \mapsto z + 1, $$
and let $ \Gamma \subseteq \SL_2\br{\ZZ} $ be the subgroup generated by $ \S $ and $ \T $. We will see later that $ \Gamma = \SL_2\br{\ZZ} $.

\begin{theorem}
\label{thm:fundamentaldomain}
\hfill
\begin{enumerate}
\item For all $ z \in \HH $, there exists $ \gamma \in \Gamma $ such that $ \gamma z \in \DDD $.
\item Suppose $ z, z' \in \DDD $ and $ \gamma \in \SL_2\br{\ZZ} $ with $ \gamma z = z' $. Then either
\begin{itemize}
\item $ z = z' $,
\item $ \Re z = \pm\tfrac{1}{2} $ and $ z' = z \mp 1 $, or
\item $ \abs{z} = 1 $ and $ z' = -1 / z $.
\end{itemize}
In particular, if $ z \ne z' $, then $ z $ and $ z' $ are on the boundary of $ \DDD $.
\item For $ z \in \DDD $, let $ \Stab_z $ be the stabiliser of $ z $ in $ \SL_2\br{\ZZ} $, that is
$$ \Stab_z = \cbr{\gamma \in \SL_2\br{\ZZ} \st \gamma z = z}. $$
Then $ \Stab_z = \cbr{\pm\id} $ unless
\begin{itemize}
\item $ z = i $, where $ \Stab_z = \cbr{\pm\id, \pm \S} $,
\item $ z = \rho $, where $ \Stab_z = \cbr{\pm\id, \pm\br{\S\T}, \pm\br{\T^{-1}\S}} $, or
\item $ z = \rho' $, where $ \Stab_z = \cbr{\pm\id, \pm\br{\T\S}, \pm\br{\S\T^{-1}}} $.
\end{itemize}
\end{enumerate}
\end{theorem}

\begin{corollary}
$ \Gamma = \SL_2\br{\ZZ} $.
\end{corollary}

\begin{proof}
Fix $ \gamma \in \SL_2\br{\ZZ} $ and $ z \in \mathring{\DDD} $ so $ \SL_2\br{\ZZ}z \cap \DDD = \cbr{z} $ and $ \Stab_z = \cbr{\pm\id} $. Consider $ \gamma z $. There exists $ \gamma' \in \Gamma $ such that $ \gamma'\gamma z \in \DDD $, so $ \gamma'\gamma z = z $. So $ \gamma'\gamma = \pm\id $, so $ \gamma = \pm\gamma'^{-1} $. But $ \gamma'^{-1} \in \Gamma $ and $ -\id = \S^2 \in \Gamma $, so $ \gamma \in \Gamma $.
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:fundamentaldomain}]
Recall that $ \Im \gamma z = \Im z / \abs{cz + d}^2 $ for $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $.
\begin{enumerate}
\item As $ c $ and $ d $ vary, $ \cbr{cz + d} $ forms a lattice in $ \CC $, so there exist only finitely many $ c $ and $ d $ such that $ \abs{cz + d} < 1 $. So $ \Im \gamma z $ attains a maximum as $ \gamma $ varies over $ \Gamma $, so there exists $ \gamma \in \Gamma $ such that $ \Im \gamma z $ is maximal. There exists $ n \in \ZZ $ such that $ \T^n\gamma z $ has real part between $ -\tfrac{1}{2} $ and $ \tfrac{1}{2} $. Consider $ \abs{\T^n\gamma z} $. If this is less than one, then
$$ \Im \S\T^n\gamma z = \Im \dfrac{-1}{\T^n\gamma z} > \Im \T^n\gamma z = \Im \gamma z. $$
Since $ \S\T^n\gamma \in \Gamma $, this contradicts maximality so $ \abs{\T^n\gamma z} \ge 1 $, so $ \T^n\gamma z \in \DDD $.

\lecture{7}{Friday}{18/10/19}

\item[$ 2, 3 $.] Let $ z, z' \in \DDD $ such that $ \gamma z = z' $. Without loss of generality $ \Im z' \ge \Im z $, so $ \abs{cz + d} \le 1 $. Note that $ \abs{cz + d} \ge \Im \br{cz + d} \ge \tfrac{\sqrt{3}}{2}c $, so $ c = -1, 0, 1 $. Note that can replace $ \gamma $ with $ -\gamma $ if convenient.
\begin{itemize}[leftmargin=0.5in]
\item[$ c = 0 $.] $ ad = 1 $, so can assume $ a = d = 1 $, so $ \gamma z = z + b $.
Since $ z, z + b \in \DDD $, $ b = \pm 1 $ and $ \Re z = \mp\tfrac{1}{2} $.
\item[$ c = 1 $.] Have $ \abs{z + d} \le 1 $ and $ \abs{z} \ge 1 $, so $ d = -1, 0, 1 $.
\begin{itemize}[leftmargin=0.5in]
\item[$ d = 0 $.] $ \abs{z} = 1 $, and $ \gamma z = \br{az - 1} / z = a - 1 / z $.
The only possibilities are
\begin{itemize}
\item $ a = 0 $ and $ \gamma = \S $,
\item $ a = 1 $ and $ \gamma = \T\S $, so $ z = \rho' $, or
\item $ a = -1 $ and $ \gamma = \T^{-1}\S $, so $ z = \rho $.
\end{itemize}
\item[$ d = 1 $.] $ z = \rho $, and $ \gamma z = \br{\br{b + 1}z + b} / \br{z + 1} = b + 1 - 1 / \br{z + 1} $, so $ b = 0 $ or $ b = -1 $.
\item[$ d = -1 $.] $ z = \rho' $ is similar.
\end{itemize}
\item[$ c = -1 $.] Similar.
\end{itemize}
\end{enumerate}
\end{proof}

\subsubsection{Further review of complex analysis}

Recall that on any compact set, a meromorphic function has only finitely many zeroes and poles. If $ f\br{z} = g\br{e^{2\pi i z}} $ is meromorphic at $ \infty $, then $ g $ is meromorphic on $ \DD = \cbr{\abs{q} < 1} $, so zeroes and poles of $ g $ are discrete with respect to $ q $, and $ \Im z \gg 0 $ if and only if $ \abs{q} < \epsilon $.

\begin{definition}
Let $ U \subseteq \CC $ be open, and let $ f : U \to \CC $ be meromorphic on $ U $. If $ f $ has a pole at $ p $, can write
$$ f\br{z} = \sum_{n = \ord_p f < 0}^\infty a_n\br{z - p}^n. $$
The coefficient $ a_{-1} $ is called the \textbf{residue} $ \Res_p f $ of $ f $ at $ p $.
\end{definition}

\begin{theorem}[Residue theorem]
Let $ V $ be a region in $ \CC $ whose boundary $ \partial V $ is a simple closed curve with counterclockwise orientation. Then
$$ \dfrac{1}{2\pi}\intd{\partial V}{}{f\br{z}}{z} = \sum_{p \in V \ \text{pole of} \ f} \Res_p f. $$
\end{theorem}

\begin{definition}
Let $ f $ be meromorphic on $ U \subseteq \CC $ open. Then the \textbf{logarithmic derivative} $ \d\log f $ is the function $ f' / f $.
\end{definition}

If $ f\br{z} = c_n\br{z - p}^n + c_{n + 1}\br{z - p}^{n + 1} + \dots $ and $ c_n \ne 0 $, then if $ n \ne 0 $ then the leading term of $ f' $ is $ nc_n\br{z - p}^{n - 1} $ and the leading term of $ f $ is $ c_n\br{z - p}^n $, so the leading term of $ f' / f $ is $ n\br{z - p}^{-1} $. If $ n = 0 $, then $ f' / f $ is holomorphic. So $ f' / f $ is meromorphic with simple poles precisely at the points where $ \ord_p f \ne 0 $, and $ \Res_p f' / f $ at such $ p $ is $ \ord_p f $.

\begin{theorem}[Argument principle]
$$ \dfrac{1}{2\pi i}\intd{\partial V}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = \sum_{p \in V \ \text{pole of} \ f} \ord_p f. $$
\end{theorem}

\pagebreak

\subsubsection{Controlling modular forms}

\begin{theorem}[$ k / 12 $-formula]
Let $ f $ be a non-zero meromorphic modular form of weight $ k $. Then
$$ \ord_\infty f + \dfrac{\ord_\rho f}{3} + \dfrac{\ord_i f}{2} + \sum_{p \in \SL_2\br{\ZZ} \backslash \HH, \ p \nsim \cbr{i, \rho}} \ord_p f = \dfrac{k}{12}. $$
\end{theorem}

\lecture{8}{Friday}{18/10/19}

\begin{proof}
Consider the closed curve $ C_{N, \epsilon} $,
$$
\begin{tikzpicture}[scale=4]
\draw [dotted, thick] (-0.5, 0.866) arc (120:60:1);
\draw [dotted, thick] (-0.5, 0.866) to (-0.5, 2);
\draw [dotted, thick] (0.5, 0.866) to (0.5, 2);
\draw (-0.5, 0.916) arc (90:25:0.05);
\draw (-0.455, 0.89) arc (117:107.5:1);
\draw (-0.3, 0.955) arc (-165:15:0.05);
\draw (-0.205, 0.98) arc (101:92:1);
\draw (-0.05, 0.995) arc (180:0:0.05);
\draw (0.205, 0.98) arc (79:88:1);
\draw (0.3, 0.955) arc (-15:165:0.05);
\draw (0.455, 0.89) arc (63:72.5:1);
\draw (0.5, 0.916) arc (90:155:0.05);
\draw (-0.5, 1.5) to node[above]{$ \Im z = N $} node{$ < $} (0.5, 1.5);
\draw (-0.5, 0.916) to (-0.5, 1.2);
\draw (-0.5, 1.2) arc (270:90:0.05);
\draw (-0.5, 1.3) to (-0.5, 1.5);
\draw (0.5, 0.916) to (0.5, 1.2);
\draw (0.5, 1.2) arc (270:90:0.05);
\draw (0.5, 1.3) to (0.5, 1.5);
\fill (0, 1) circle (0.0125) node[below]{$ i $};
\fill (-0.25, 0.965) circle (0.0125) node[above]{$ z $};
\fill (0.25, 0.965) circle (0.0125) node[below]{$ z $};
\fill (-0.5, 1.25) circle (0.0125) node[right]{$ z $};
\fill (-0.5, 0.866) circle (0.0125) node[below left]{$ \rho $};
\fill (0.5, 1.25) circle (0.0125) node[right]{$ z $};
\fill (0.5, 0.866) circle (0.0125) node[below right]{$ \rho' $};
\end{tikzpicture},
$$
where the $ z $'s are zeroes or poles of $ f $, and the circles are of radius $ \epsilon $. Consider
$$ \dfrac{1}{2\pi i}\intd{C_{N, \epsilon}}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = \sum_{p \in \SL_2\br{\ZZ} \backslash \HH, \ p \nsim \cbr{i, \rho}} \ord_p f, \qquad \epsilon \to 0. $$
So it suffices to show
$$ \lim_{\epsilon \to 0, \ N \to \infty} \dfrac{1}{2\pi i}\intd{C_{N, \epsilon}}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = -\ord_\infty f - \dfrac{\ord_\rho f}{3} - \dfrac{\ord_i f}{2} + \dfrac{k}{12}. $$
The vertical parts of the boundary cancel. Since $ f\br{-1 / z} = z^kf\br{z} $,
$$ \d\br{z^kf\br{z}} = \br{kz^{k - 1}f\br{z} + z^kf'\br{z}}\d z, $$
so the integral over the circular part of $ \partial\DDD $ approaches
\begin{align*}
\dfrac{1}{2\pi i}\intd{\rho}{i}{\dfrac{f'\br{z}}{f\br{z}}}{z} + \dfrac{1}{2\pi i}\intd{i}{\rho'}{\dfrac{f'\br{z}}{f\br{z}}}{z}
& = \dfrac{1}{2\pi i}\br{\intd{\rho}{i}{\dfrac{f'\br{z}}{f\br{z}}}{z} - \intd{\rho}{i}{\dfrac{f'\br{-1 / z}}{f\br{-1 / z}}}{z}} \\
& = \dfrac{1}{2\pi i}\intd{\rho}{i}{\dfrac{f'\br{z}}{f\br{z}} - \dfrac{kz^{k - 1}f\br{z} + z^kf'\br{z}}{z^kf\br{z}}}{z}
= -\dfrac{1}{2\pi i}\intd{\rho}{i}{\dfrac{k}{z}}{z}
= \dfrac{k}{12}.
\end{align*}
Since $ \d q = 2\pi iq\d z $, the top part is
$$ \dfrac{1}{2\pi i}\intd{\tfrac{1}{2} + iN}{\tfrac{1}{2} - iN}{\dfrac{f'\br{z}}{f\br{z}}}{z} = -\dfrac{1}{2\pi i}\intd{\text{circle of radius} \ \epsilon}{}{\dfrac{g'\br{q}}{g\br{q}}}{q} = -\ord_\infty f. $$
Near $ i $, $ f' / f = \ord_i f\br{z - i}^{-1} + h\br{z} $, where $ h\br{z} $ is holomorphic such that $ h\br{z} \to 0 $ as $ \epsilon \to 0 $. Then the circle $ C_{\epsilon, i} $ of radius $ \epsilon $ centered at $ i $ is
$$ \lim_{\epsilon \to 0} \dfrac{1}{2\pi i}\intd{C_{\epsilon, i}}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = \lim_{\epsilon \to 0} \dfrac{1}{2\pi i}\intd{\text{arc of half circle centered at} \ i}{}{\dfrac{\ord_i f}{z - i}}{z} = -\dfrac{\ord_i f}{2}. $$
Similarly, at $ \rho $ and $ \rho' $, get that the circles $ C_{\epsilon, \rho} $ and $ C_{\epsilon, \rho'} $ of radius $ \epsilon $ centered at $ \rho $ and $ \rho' $ are
$$ \lim_{\epsilon \to 0} \dfrac{1}{2\pi i}\intd{C_{\epsilon, \rho}}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = \lim_{\epsilon \to 0} \dfrac{1}{2\pi i}\intd{C_{\epsilon, \rho'}}{}{\dfrac{f'\br{z}}{f\br{z}}}{z} = -\dfrac{\ord_\rho f}{6}, $$
which gives $ -\ord_\rho f / 3 $.
\end{proof}

\pagebreak

\subsubsection{The space of holomorphic modular forms}

Let
$$ \M_k = \cbr{\text{holomorphic modular forms of weight} \ k}, $$
$$ \S_k = \cbr{\text{cusp forms of weight} \ k} = \cbr{f \in \M_k \st \ord_\infty f > 0} \subseteq \M_k. $$

\begin{corollary}
\hfill
\begin{itemize}
\item $ \M_k = 0 $ if $ k < 0 $, $ k = 2 $, or $ k $ odd.
\item $ \M_0 $ are constants.
\item $ \M_4 = \CC\E_4 $, where $ \ord_\rho \E_4 = 1 $ and no other zeroes.
\item $ \M_6 = \CC\E_6 $, where $ \ord_i \E_6 = 1 $ and no other zeroes.
\item $ \M_8 = \CC\E_8 $, where $ \ord_\rho \E_8 = 2 $ and no other zeroes.
\item $ \M_{10} = \CC\E_{10} $, where $ \ord_\rho \E_{10} = \ord_i \E_{10} = 1 $ and no other zeroes.
\item $ \M_{12} = \CC\E_{12} \oplus \CC\Delta $, where $ \ord_\infty \Delta = 1 $ and no other zeroes.
\end{itemize}
\end{corollary}

\begin{corollary}
$ \Delta : \M_k \to \S_{k + 12} $ is an isomorphism. On the other hand,
$$ \M_k \cong \CC\E_k \oplus \S_k, \qquad k \ge 4 \ \text{even}, $$
so
$$ \M_k \cong \CC\E_k \oplus \dots \oplus \CC\E_{k - 12r}\Delta^r, \qquad k - 12r = 0, 4, 6, 8, 10, 14. $$
\end{corollary}

\begin{corollary}
$ \E_4^2 = \E_8 $ and $ \E_4\E_6 = \E_{10} $.
\end{corollary}

\lecture{9}{Monday}{21/10/19}

So for $ k \ge 4 $, the set
$$
\begin{cases}
\E_k, \dots, \E_{k - 12\fbr{k / 12}}\Delta^{\fbr{k / 12}} & k \not\equiv 2 \mod 12 \\
\E_k, \dots, \E_{14}\Delta^{\fbr{k / 12} - 1} & k \equiv 2 \mod 12
\end{cases}
$$
is a basis for $ \M_k $. A variant is to write $ k = 4n + 6m $ with $ m = 0, 1 $ and $ n \ge 0 $, for $ k \ge 4 $. Then $ \M_k = \CC\E_4^n\E_6^m \oplus \S_k $ gives a basis
$$ \E_4^n\E_6^m, \dots, \E_4^{n - 3\fbr{n / 3}}\E_6^m\Delta^{\fbr{n / 3}} $$
for $ \M_k $. Since $ \Delta = \br{\E_4^3 - \E_6^2} / 1728 $, we see every modular form of weight $ k $ is a polynomial in $ \E_4 $ and $ \E_6 $, and
$$ \Delta \in q + q^2\ZZ\sbr{\sbr{q}}, \qquad \E_4^n\E_6^m \in 1 + q\ZZ\sbr{\sbr{q}}, \qquad \E_4^{n - 3}\E_6^m\Delta \in q + q^2\ZZ\sbr{\sbr{q}}, \qquad \dots $$
have integer coefficients.

\begin{corollary}
If the $ q $-expansion of $ f $ has integer coefficients, then $ f $ is an integer combination of
$$ \E_4^n\E_6^m, \dots, \E_4^{n - 3\fbr{n / 3}}\E_6^m\Delta^{\fbr{n / 3}}. $$
\end{corollary}

\begin{notation*}
$ \M_k\br{\ZZ} \subseteq \M_k $ consists of modular forms with integer $ q $-expansions.
\end{notation*}

\begin{theorem}
$ \M_k\br{\ZZ} $ spans $ \M_k $, and $ f \in \M_k $ lies in $ \M_k\br{\ZZ} $ if and only if $ f $ is an integral polynomial in $ \E_4, \E_6, \Delta $.
\end{theorem}

\begin{definition}
A \textbf{graded ring} is a ring $ R $, together with a direct sum decomposition, as abelian groups,
$$ R = \bigoplus_{i \in \ZZ} R_i, $$
such that $ R_i \cdot R_j \subseteq R_{i + j} $ for all $ i, j \in \ZZ $.
\end{definition}

\begin{example*}
\hfill
\begin{itemize}
\item $ R = \CC\sbr{X, Y} $, where $ R_i $ are polynomials homogeneous of degree $ i $.
\item $ R = \bigoplus_{k \in \ZZ} \M_k $.
\end{itemize}
\end{example*}

\pagebreak

Let $ \CC\sbr{X, Y} $ be graded with $ \deg X = 4 $ and $ \deg Y = 6 $. Have a homomorphism of graded rings
$$ \function{\CC\sbr{X, Y}}{\bigoplus_{k \in \ZZ} \M_k}{\br{X, Y}}{\br{\E_4, \E_6}}. $$

\begin{theorem}
This is an isomorphism of graded rings.
\end{theorem}

\begin{proof}
This map is surjective, since every $ f \in \M_k $ is a polynomial in $ \E_4 $ and $ \E_6 $. It remains to show this map is injective. Suppose not. There exists $ P\br{X, Y} $, homogeneous of degree $ k $, such that $ P\br{\E_4, \E_6} = 0 $. Write $ k = 4n + 6m $ with $ m = 0, 1 $. If $ P = c_0X^nY^m + \dots + c_rX^{n - 3r}Y^{m + 2r} $ where $ r = \fbr{n / 3} $, then
$$ c_0\E_4^n\E_6^m + \dots + c_r\E_4^{n - 3r}\E_6^{m + 2r} = 0. $$
Dividing by $ \E_4^{n - 3r}\E_6^{m + 2r} $, get $ Q\br{\E_4^3 / \E_6^2} = 0 $ where $ Q\br{X} = c_0X^r + \dots + c_r $. Since the roots of $ Q $ are discrete, and $ \E_4^3 / \E_6^2 $ is non-constant, this is impossible.
\end{proof}

\subsubsection{The space of meromorphic modular forms}

\begin{note*}
The meromorphic modular forms of weight zero form a field.
\end{note*}

\begin{example*}
The $ \j $-invariant $ \j\br{z} = \E_4^3 / \Delta = 1728\E_4^3 / \br{\E_4^3 - \E_6^2} $ is a non-constant meromorphic modular form, with a pole of order one at $ \infty $, a zero of order three at $ \rho $, and no other zeroes or poles.
\end{example*}

\begin{theorem}
$ \j $ gives a bijection between $ \SL_2\br{\ZZ} \backslash \HH $ and $ \CC $.
\end{theorem}

\begin{proof}
Given $ \lambda \in \CC $, want $ z \in \HH $ such that $ \j\br{z} = \lambda $. Consider $ g = j - \lambda $. This is meromorphic of weight zero. This has a pole at $ \infty $, and no other poles, and
$$ \ord_\infty g + \dfrac{\ord_\rho g}{3} + \dfrac{\ord_i g}{2} + \sum_{p \in \SL_2\br{\ZZ} \backslash \HH, \ p \nsim \cbr{i, \rho}} \ord_p g = 0. $$
The only possibilities are
\begin{itemize}
\item $ g $ has a zero at $ \rho $ of order three, and no other zeroes,
\item $ g $ has a zero at $ i $ of order two, and no other zeroes, or
\item $ g $ has a simple zero somewhere else, and no other zeroes.
\end{itemize}
In each case, the zero of $ g $ is a unique $ \SL_2\br{\ZZ} $-orbit on which $ \j\br{z} = \lambda $. So $ \j $ is bijective.
\end{proof}

\lecture{10}{Friday}{25/10/19}

\begin{theorem}
Every meromorphic modular form of weight zero is a rational function in $ \j $. That is, the field of meromorphic modular forms is $ \CC\br{\j} $.
\end{theorem}

\begin{proof}
Let $ g $ be meromorphic of weight zero. Then $ g $ has finitely many $ \SL_2\br{\ZZ} $-orbits worth of poles in $ \HH $. Saw last time that $ \j $ is holomorphic in $ \HH $. If $ p $ is a pole of $ g $, then $ \br{\j\br{z} - \j\br{p}}^{n_p} $ is holomorphic on $ \HH $ and zero at $ z = p $. Doing this for all poles, there exists $ P \in \CC\sbr{X} $ such that $ P\br{\j}g\br{z} $ is holomorphic on $ \HH $. Then for some $ m $, $ P\br{\j}g\br{z}\Delta^m $ is holomorphic of weight $ 12m $. So it suffices to show if $ h $ is holomorphic of weight $ 12m $, then $ h / \Delta^m $ is a rational function in $ \j $, since if $ P\br{\j}g\br{z}\Delta^m = h $ then $ P\br{\j}g\br{z} \in \CC\br{\j} $, so $ g\br{z} \in \CC\br{\j} $. Then $ h $ is a sum of terms
$$ h = \sum_{a, b} c_{a, b}\E_4^a\E_6^b, \qquad c_{a, b} \in \CC, \qquad 4a + 6b = 12m. $$
Considering this equation modulo four and modulo three, find $ 3 \mid a $ and $ 2 \mid b $, so
$$ \dfrac{h}{\Delta^m} = \sum_{a, b} c_{a, b}\br{\dfrac{\E_4^3}{\Delta}}^{\tfrac{a}{3}}\br{\dfrac{\E_6^2}{\Delta}}^{\tfrac{b}{2}}. $$
So it suffices to show $ \E_4^3 / \Delta $ and $ \E_6^2 / \Delta $ are rational functions in $ \j $. Then $ \j = \E_4^3 / \Delta $, and
$$ \dfrac{\E_6^2}{\Delta} = \dfrac{1728\E_6^2}{\E_4^3 - \E_6^2} = \dfrac{1728\br{\E_6^2 - \E_4^3} + 1728\E_4^3}{\E_4^3 - \E_6^2} = -1728 + \dfrac{1728\E_4^3}{\E_4^3 - \E_6^2} = \j - 1728. $$
\end{proof}

\pagebreak

\subsection{Theta series}

Let $ L \subseteq \RR^n $ be a lattice. For $ x, y \in L $, $ x \cdot y \in \RR $. Suppose $ x \cdot y \in \ZZ $ for all $ x, y \in L $. A question is for $ n \in \ZZ $, how many $ x \in L $ have $ x \cdot x = n $? The rough idea is to form the series
$$ \sum_{x \in L} q^{x \cdot x} = \sum_{n = 0}^\infty a_nq^n, \qquad a_n = \#\cbr{x \in L \st x \cdot x = n}. $$
We will show that, with some slight modifications, and extra hypotheses on $ L $, this generating function turns out to be a modular form.

\subsubsection{Quadratic forms}

Fix a lattice $ L \subseteq \RR^n $, so
$$ L = \ZZ \cdot e_1 \oplus \dots \oplus \ZZ \cdot e_n. $$
Given these $ e_i $, form a matrix $ A $ such that $ A_{ij} = e_i \cdot e_j $.

\begin{note*}
$ A = B^\intercal B $, where $ B $ is the matrix whose columns are the $ e_i $, and $ \abs{\det B} $ is the \textbf{volume} of the parallelogram spanned by $ e_i $, so $ \det A = \det B^2 > 0 $.
\end{note*}

\begin{definition}
The \textbf{dual lattice} $ L^\vee $ is the set of $ y \in \RR^n $ such that $ y \cdot x \in \ZZ $ for all $ x \in L $.
\end{definition}

Let $ f_1, \dots, f_n $ be the dual basis to $ e_1, \dots, e_n $, that is the unique set of solutions $ f_1, \dots, f_n $ such that
$$ f_i \cdot e_j =
\begin{cases}
1 & i = j \\
0 & i \ne j
\end{cases}.
$$
Then $ L^\vee $ is spanned by the $ f_i $. Clearly $ f_i \in L^\vee $ for all $ i $. Conversely, if $ y \in L^\vee $, then $ y \cdot e_i = a_i \in \ZZ $, then $ y = \sum_{i = 1}^n a_if_i $.

\begin{proposition}
Let $ C = A^{-1} $. Then
$$ f_i = \sum_{j = 1}^n C_{ij}e_j. $$
\end{proposition}

\begin{proof}
$$ f_i \cdot e_k = \sum_{j = 1}^n C_{ij}e_je_k = \sum_{j = 1}^n C_{ij}A_{jk} = \br{CA}_{ik} =
\begin{cases}
1 & i = k \\
0 & i \ne k
\end{cases}.
$$
\end{proof}

\begin{definition}
A lattice $ L $ is \textbf{self-dual} if $ L^\vee = L $ as subsets of $ \RR^n $.
\end{definition}

\begin{proposition}
$ L $ is self-dual if and only if the associated matrix $ A $ has integer entries and determinant one.
\end{proposition}

\begin{proof}
Clearly if $ L = L^\vee $, then $ e_i \cdot e_j \in \ZZ $, so $ A $ has integer entries. Since $ L^\vee \subseteq L $, $ f_i $ is an integer combination of the $ e_j $, so $ C = A^{-1} $ has integer entries. So $ \det A = \pm 1 $, but already saw $ \det A > 0 $. Conversely if $ A $ has integer entries and determinant one, $ C = A^{-1} $ has integer entries. Then $ A $ has integer entries implies that $ e_i \cdot e_j \in \ZZ $ for all $ i $ and $ j $, so $ e_i \in L^\vee $ for all $ i $, so $ L \subseteq L^\vee $. Similarly, $ C $ has integer entries implies that $ L^\vee \subseteq L $.
\end{proof}

If $ L $ is self-dual, get an integer-valued \textbf{quadratic form}
$$ \function[\Q_L]{\ZZ^n}{\ZZ}{\br{a_1, \dots, a_n}}{\br{a_1e_1 + \dots + a_ne_n} \cdot \br{a_1e_1 + \dots + a_ne_n} = \onebythree{a_1}{\dots}{a_n}A\threebyone{a_1}{\vdots}{a_n}}. $$
A question is given $ m $, how often does $ \Q_L $ represent $ m $?

\pagebreak

\subsubsection{Fourier analysis}

\lecture{11}{Friday}{25/10/19}

Let $ f : \RR^n \to \CC $ be a $ \C^\infty $ function.

\begin{definition}
We will say $ f $ is \textbf{rapidly decreasing} if for all $ m $,
$$ \abs{\abs{x}^mf\br{x}} \to 0, \qquad \abs{x} \to \infty, $$
where $ \abs{x} = \br{x \cdot x}^{1 / 2} $. For $ f \in \C^\infty $, rapidly decreasing, define
$$ \widehat{f}\br{y} = \intd{\RR^n}{}{e^{-2\pi i\br{x \cdot y}}}{x} : \RR^n \to \CC. $$
\end{definition}

\begin{fact*}
\hfill
\begin{itemize}
\item If $ f $ is smooth and rapidly decreasing, so is $ \widehat{f} $.
\item If $ f\br{x} = e^{-\pi\br{x \cdot x}} $, then $ \widehat{f}\br{x} = f\br{x} $.
\item If $ f $ is smooth and rapidly decreasing, and $ L \subseteq \RR^n $ is a lattice with volume $ V $, then
$$ \sum_{x \in L} f\br{x} = \dfrac{1}{V}\sum_{x \in L^\vee} \widehat{f}\br{x}. $$
\end{itemize}
\end{fact*}

\subsubsection{Theta series}

A crucial assumption is that $ L $ is self-dual. An assumption that can be removed is that $ L $ is even, so for all $ x \in L $, $ \Q_L\br{x} \in 2\ZZ $.

\begin{definition}
The \textbf{theta series} $ \Theta_L $ is defined by
$$ \Theta_L\br{z} = \sum_{x \in L} q^{\tfrac{1}{2}x \cdot x} = \sum_{m = 0}^\infty a_mq^m, \qquad a_m = \#\cbr{x \in \ZZ^n \st \Q_L\br{x} = 2m}. $$
\end{definition}

\begin{theorem}
\label{thm:thetaseries}
$ \Theta_L $ is modular of weight $ n / 2 $.
\end{theorem}

\begin{example*}
Let $ \Gamma_8 \subseteq \RR^8 $ be spanned by
$$ e_1 = \br{\dfrac{1}{2}, -\dfrac{1}{2}, -\dfrac{1}{2}, -\dfrac{1}{2}, -\dfrac{1}{2}, -\dfrac{1}{2}, -\dfrac{1}{2}, \dfrac{1}{2}}, \qquad e_2 = \br{1, 1, 0, 0, 0, 0, 0, 0}, $$
$$ e_3 = \br{-1, 1, 0, 0, 0, 0, 0, 0}, \qquad e_4 = \br{0, -1, 1, 0, 0, 0, 0, 0}, \qquad e_5 = \br{0, 0, -1, 1, 0, 0, 0, 0}, $$
$$ e_6 = \br{0, 0, 0, -1, 1, 0, 0, 0}, \qquad e_7 = \br{0, 0, 0, 0, -1, 1, 0, 0}, \qquad e_8 = \br{0, 0, 0, 0, 0, -1, 1, 0}. $$
Then
$$ A =
\begin{pmatrix}
2 & 0 & -1 & 0 & 0 & 0 & 0 & 0 \\
0 & 2 & 0 & -1 & 0 & 0 & 0 & 0 \\
-1 & 0 & 2 & -1 & 0 & 0 & 0 & 0 \\
0 & -1 & -1 & 2 & -1 & 0 & 0 & 0 \\
0 & 0 & 0 & -1 & 2 & -1 & 0 & 0 \\
0 & 0 & 0 & 0 & -1 & 2 & -1 & 0 \\
0 & 0 & 0 & 0 & 0 & -1 & 2 & -1 \\
0 & 0 & 0 & 0 & 0 & 0 & -1 & 2
\end{pmatrix},
$$
and
$$ \Q_L\br{z_1, \dots, z_8} = 2\br{z_1^2 + \dots + z_8^2 - z_1z_3 - z_2z_4 - z_3z_4 - z_4z_5 - z_6z_7 - z_7z_8}. $$
\end{example*}

If $ L \subseteq \RR^n $ is even and self-dual, and $ \Theta_L $ is modular of weight $ n / 2 $, then the dimension is $ \sim n / 24 $.

\begin{fact*}
If $ L \subseteq \RR^n $ is even and self-dual, then $ 8 \mid n $.
\end{fact*}

\begin{proof}
Serre V.2.1 Corollary 2.
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:thetaseries}]
Know, since $ L $ is even, that $ \Theta_L\br{z + 1} = \Theta_L\br{z} $. It suffices to show $ \Theta_L\br{-1 / z} = z^{n / 2}\Theta_L\br{z} $. Both sides are holomorphic on $ \HH $, so it suffices to show
$$ \Theta_L\br{-\dfrac{1}{it}} = \br{it}^{\tfrac{n}{2}}\Theta_L\br{it}. $$
For $ t \in \RR^\times $, let $ L_t = t^{1 / 2} \cdot L $. Then $ L_t^\vee = t^{-1 / 2} \cdot L = L_{t^{-1}} $, so the volume of $ L_t $ is $ t^{n / 2} $. By the facts,
$$ \sum_{x \in L_t} e^{-\pi\br{x \cdot x}} = t^{-\tfrac{n}{2}}\sum_{x \in L_{t^{-1}}} e^{-\pi\br{x \cdot x}}, $$
so
$$ \sum_{x \in L} e^{-\pi\br{x \cdot x}t} = t^{-\tfrac{n}{2}}\sum_{x \in L} e^{-\tfrac{\pi\br{x \cdot x}}{t}}. $$
Now return to $ \Theta_L $. The left hand side is
$$ \Theta_L\br{-\dfrac{1}{it}} = \sum_{x \in L} e^{\tfrac{1}{2} \cdot 2\pi i \cdot \br{-\tfrac{1}{it}} \cdot \br{x \cdot x}} = \sum_{x \in L} e^{-\tfrac{\pi\br{x \cdot x}}{t}}, $$
and the right hand side is
$$ \Theta_L\br{it} = \sum_{x \in L} e^{\tfrac{1}{2} \cdot 2\pi i \cdot \br{it} \cdot \br{x \cdot x}} = \sum_{x \in L} e^{-\pi\br{x \cdot x}t}, $$
so the result follows.
\end{proof}

\subsubsection{Asymptotic analysis}

Let $ L \subseteq \RR^n $ be even and self-dual, so $ 8 \mid n $, and let $ \Theta_L = \sum_{m = 0}^\infty a_mq^m $, where $ a_m $ is the number of ways $ \Q_L $ represents $ 2m $, so $ a_0 = 1 $. Then
$$ \Theta_L = \E_{\tfrac{n}{2}} + g, \qquad \E_{\tfrac{n}{2}} \sim \sigma_{\tfrac{n}{2} - 1}\br{m} \sim m^{\tfrac{n}{2} - 1}, $$
where $ g $ is a cusp form.

\lecture{12}{Monday}{28/10/19}

Lecture 12 is a problems class.

\lecture{13}{Friday}{01/11/19}

\begin{proposition}
Let
$$ \E_k = \sum_{n = 0}^\infty a_nq^n = 1 + C\sum_{n = 1}^\infty \sigma_{k - 1}\br{n}q^n. $$
Then there exist $ A, B \in \RR_{> 0} $ such that
$$ An^{k - 1} \le a_n \le Bn^{k - 1}. $$
\end{proposition}

\begin{proof}
Set $ A = C $. Then
$$ \sigma_{k - 1}\br{n} = \sum_{d \mid n} d^{k - 1} \ge n^{k - 1}, $$
so $ a_n = C\sigma_{k - 1}\br{n} \ge Cn^{k - 1} $. Consider
$$ \dfrac{\sigma_{k - 1}\br{n}}{n^{k - 1}} = \sum_{d \mid n} \dfrac{d^{k - 1}}{n^{k - 1}} = \sum_{d' \mid n} \dfrac{1}{d'^{k - 1}} \le \sum_{n = 1}^\infty \dfrac{1}{n^{k - 1}} = \zeta\br{k - 1}, $$
so $ \sigma_{k - 1}\br{n} \le \zeta\br{k - 1}n^{k - 1} $. So set $ B = C\zeta\br{k - 1} $, so $ a_n \le Bn^{k - 1} $.
\end{proof}

\begin{theorem}[Hecke]
Let $ f = \sum_{n = 1}^\infty a_nq^n $ be a cusp form of weight $ k $. Then
$$ \abs{a_n} = \O\br{n^{\tfrac{k}{2}}}, $$
that is $ \abs{a_n}n^{-k / 2} $ is bounded as $ n \to \infty $.
\end{theorem}

\pagebreak

\begin{proof}
$ f / q $ is holomorphic on $ \HH $, so $ \abs{f / q} $ is bounded as $ q \to 0 $, so $ \abs{f\br{z}} / e^{-2\pi \Im z} $ is bounded as $ \Im z \to \infty $. That is, there exist $ M \in \RR $ such that $ \abs{f\br{z}} \le Me^{-2\pi \Im z} $. Consider
$$ \phi\br{z} = \abs{f\br{z}}\Im z^{\tfrac{k}{2}}, $$
so $ \lim_{\Im z \to \infty} \phi\br{z} = 0 $. Note that
$$ \phi\br{\gamma z} = \abs{f\br{\gamma z}}\Im \gamma z^{\tfrac{k}{2}} = \abs{f\br{z}}\abs{cz + d}^k\dfrac{\Im z^{\tfrac{k}{2}}}{\abs{cz + d}^{2\tfrac{k}{2}}} = \abs{f\br{z}}\Im z^{\tfrac{k}{2}} = \phi\br{z}, \qquad \gamma = \twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ}. $$
Then $ \phi\br{z} $ is determined by its values on the standard fundamental domain, so $ \phi\br{z} $ is bounded on $ \HH $, so $ \abs{f\br{z}} < M'\Im z^{-k / 2} $ for some $ M' \in \RR $. If $ z = x + iy $ for $ y $ fixed, then by the residue theorem,
$$ a_m = \dfrac{1}{2\pi i}\intd{C}{}{\dfrac{f\br{q}}{q^{m + 1}}}{q} = \intd{-\tfrac{1}{2}}{\tfrac{1}{2}}{\dfrac{f\br{x + iy}}{e^{2\pi i\br{x + iy}m}}}{x}, $$
where $ C $ is a circle around zero, oriented counterclockwise, so
$$ \abs{a_m} \le \intd{-\tfrac{1}{2}}{\tfrac{1}{2}}{\dfrac{\abs{f\br{x + iy}}}{e^{-2\pi ym}}}{x} \le \dfrac{\abs{f\br{x + iy}}}{e^{-2\pi ym}} \le e^{2\pi ym}M'y^{-\tfrac{k}{2}}. $$
Set $ y = 1 / m $. Get $ \abs{a_m} \le e^{2\pi}M'm^{k / 2} $, so $ \abs{a_m} / m^{k / 2} $ is bounded.
\end{proof}

Had
$$ \Theta_L = \E_{\tfrac{n}{2}} + g, \qquad \E_{\tfrac{n}{2}} \sim m^{\tfrac{n}{2} - 1}, \qquad g = \O\br{m^{\tfrac{n}{4}}}. $$

\begin{theorem}[Deligne]
Let $ f = \sum_{n = 1}^\infty a_nq^n $ be a cusp form of weight $ k $. Then
$$ \abs{a_n} = \O\br{n^{\tfrac{k - 1}{2}}\sigma_0\br{n}}. $$
\end{theorem}

\begin{proof}
Very rough sketch of argument.
\begin{itemize}[leftmargin=1in]
\item[Ramanujan 1910s.] Conjectured by Ramanujan for $ f = \Delta $.
\item[Weil 1940s.] For an algebraic variety $ V $ over $ \FF_q $, what can we say about $ \#V\br{\FF_{q^n}} $ for various $ n $? Weil associated to $ V $ and $ \FF_q $ a generating function called the \textbf{zeta function} $ \zeta_{V, q}\br{t} $ of $ V $ over $ \FF_q $, conjectured several things about $ \zeta_{V, q} $, and proved in the case of curves.
\begin{itemize}
\item $ \zeta_{V, q} $ is a rational function in $ t $.
\item $ \zeta_{V, q} $ satisfies a certain symmetry under $ t \mapsto 1 / t $.
\item The \textbf{Riemann hypothesis}
$$ \zeta_{V, q}\br{t} = \dfrac{P_1\br{t} \dots P_{2d - 1}\br{t}}{P_0\br{t} \dots P_{2d}\br{t}}, \qquad \dim V = d, $$
where the roots of $ P_i\br{t} $ have absolute value $ q^{i / 2} $.
\end{itemize}
\item[Eichler-Shimura 1950s.] Let $ \Gamma \subseteq \SL_2\br{\ZZ} $ be a nice \textbf{congruence subgroup}. Then $ X_\Gamma = \Gamma \backslash \HH $ has the structure of an algebraic curve over $ \QQ $, with \textbf{good reduction} at primes $ p $ not dividing $ \sbr{\SL_2\br{\ZZ} : \Gamma} $. Eichler, Shimura, and others studied $ \zeta_{V, p} $ for $ V = X_\Gamma $, and related $ \zeta_{V, p} $ to the $ p $-th Fourier coefficients of a basis for forms of weight two and \textbf{level} $ \Gamma $. The \textbf{Weil conjectures} bound $ a_p $ in terms of $ q^{1 / 2} $.
\item[Deligne 1960s.] Deligne showed that in weight $ k $, there exists a \textbf{Kuga-Sato variety}, of dimension $ k - 1 $, whose zeta function has a factor coming from modular forms of weight $ k $ and level $ \Gamma $, and showed that if the Weil conjectures, particularly the Riemann hypothesis, holds, then get the coefficient bound.
\item[Deligne 1970s.] The Riemann hypothesis in higher dimensions.
\end{itemize}
\end{proof}

\pagebreak

\subsection{Hecke operators}

\lecture{14}{Friday}{01/11/19}

Let
$$ \Delta = \dfrac{\E_4^3 - \E_6^2}{1728} = \sum_{n = 1}^\infty \tau\br{n}q^n = q\prod_{m = 1}^\infty \br{1 - q^m}^{24} = q - 24q^2 + 252q^3 - 1472q^4 + 4830q^5 + \dots. $$
Then $ \tau\br{n} $ grows roughly like $ n^6 $ or $ n^{11 / 2 + \epsilon} $. Mordell proved that
\begin{itemize}
\item $ \tau\br{mn} = \tau\br{n}\tau\br{m} $ if $ \br{m, n} = 1 $, and
\item $ \tau\br{p^{n + 1}} = \tau\br{p}\tau\br{p^n} - p^{11}\tau\br{p^{n - 1}} $.
\end{itemize}

\begin{note*}
If $ \E_k = 1 + C\sum_n \sigma_{k - 1}\br{n}q^n $, set
$$ \E_k' = \dfrac{1}{C} + \sum_n \sigma_{k - 1}\br{n}q^n. $$
\begin{itemize}
\item If $ \br{m, n} = 1 $, then
$$ \sigma_{k - 1}\br{nm} = \sum_{d \mid n} \sum_{d' \mid m} \br{dd'}^{k - 1} = \br{\sum_{d \mid n} d^{k - 1}}\br{\sum_{d' \mid m} d'^{k - 1}} = \sigma_{k - 1}\br{n}\sigma_{k - 1}\br{m}. $$
\item Since $ \sigma_{k - 1}\br{p^n} = 1 + \dots + p^{n\br{k - 1}} $,
\begin{align*}
\sigma_{k - 1}\br{p}\sigma_{k - 1}\br{p^n}
& = \br{1 + p^{k - 1}}\br{1 + \dots + p^{n\br{k - 1}}} \\
& = 1 + 2p^{k - 1} + \dots + 2p^{n\br{k - 1}} + p^{\br{n + 1}\br{k - 1}} \\
& = \sigma_{k - 1}\br{p^{n + 1}} + p^{k - 1}\sigma_{k - 1}\br{p^{n - 1}},
\end{align*}
so
$$ \sigma_{k - 1}\br{p^{n + 1}} = \sigma_{k - 1}\br{p}\sigma_{k - 1}\br{p^n} - p^{k - 1}\sigma_{k - 1}\br{p^{n - 1}}. $$
\end{itemize}
\end{note*}

\subsubsection{Correspondences}

\begin{definition}
Let $ X $ be a set. The \textbf{free abelian group on $ X $}, denoted $ \ZZ X $, is the set of finite formal sums
$$ \sum_{i = 1}^r a_ix_i, \qquad a_i \in \ZZ, \qquad x_i \in X, $$
where $ x_i $ are distinct. Add by combining like terms.
\end{definition}

\begin{definition}
A \textbf{correspondence} on $ X $ is a homomorphism $ \ZZ X \to \ZZ X $. Let
$$ \Corr X = \cbr{\text{correspondences on} \ X}. $$
Equivalently, a correspondence associates to each $ x \in X $, a finite formal sum
$$ \sum_{i = 1}^r a_iy_i, \qquad a_i \in \ZZ, \qquad y_i \in X. $$
\end{definition}

If $ X $ is a finite set $ X = \cbr{x_1, \dots, x_r} $, any correspondence $ T $ can be represented, in a unique way, by the matrix $ M_T $ such that
$$ Tx_i = \sum_{j = 1}^r \br{M_T}_{ij}x_j, $$
and composition of correspondences is matrix multiplication. Let $ X $ be a set, and let
$$ \Fun_\CC X = \cbr{\text{functions} \ X \to \CC}. $$
Then $ T \in \Corr X $ acts on $ \Fun_\CC X $ as follows. If $ Tx = \sum_i a_ix_i $ then $ \br{Tf}x = \sum_i a_if\br{x_i} $. Check $ \br{T \circ T'}f = T\br{T'f} $ etc. Let
$$ \LLL = \cbr{\text{lattices in} \ \CC}. $$

\pagebreak

\begin{example*}
\hfill
\begin{itemize}
\item For $ \lambda \in \CC^\times $, have
$$ \function[\R_\lambda]{\ZZ\LLL}{\ZZ\LLL}{L}{\lambda L}. $$
\item For $ n \in \ZZ_{> 0} $, have
$$ \function[\T_n]{\ZZ\LLL}{\ZZ\LLL}{L}{\sum_{L' \subseteq_n L} L'}, $$
the $ n $ \textbf{Hecke operators}. Note that there are only finitely many $ L' \subseteq_n L $, since if $ L' \subseteq_n L $, then $ L' $ contains $ \R_nL $. Then $ L / \R_nL \cong \ZZ / n\ZZ \times \ZZ / n\ZZ $. The image of $ L' $ in $ L / \R_nL $ is a subgroup $ H $ of $ \ZZ / n\ZZ \times \ZZ / n\ZZ $ of order $ n $. The preimage of $ H $ in $ L $ is $ L' $. Thus there is a bijection
$$ \correspondence{\text{subgroups of} \ L / \R_nL \ \text{of order} \ n}{\text{sublattices of} \ L \ \text{of index} \ n}. $$
\end{itemize}
\end{example*}

\begin{proposition}
\label{prop:correspondence}
\hfill
\begin{enumerate}
\item $ \R_\lambda\R_\mu = \R_{\lambda\mu} $.
\item $ \R_\lambda\T_n = \T_n\R_\lambda $.
\item $ \T_n\T_m = \T_{nm} $ if $ \br{m, n} = 1 $.
\item $ \T_p\T_{p^n} = \T_{p^{n + 1}} + p\T_{p^{n - 1}}\R_p $.
\end{enumerate}
\end{proposition}

\lecture{15}{Monday}{04/11/19}

\begin{corollary}
$ \T_p $ commute with each other for $ p $ prime, also with $ \R_\lambda $, and every $ \T_n $ is a polynomial in $ \T_p $ and $ \R_p $ for $ p \mid n $, so all $ \T_n $ and $ \R_\lambda $ commute.
\end{corollary}

\begin{proposition}
If $ A $ is an abelian group of order $ nm $, with $ \br{n, m} = 1 $, then $ A $ factors uniquely as $ B \times C $, where $ B $ has order $ n $ and $ C $ has order $ m $. In particular $ B $ is the unique subgroup of $ A $ of order $ n $.
\end{proposition}

\begin{proof}
Write $ 1 = an + bm $ for $ a, b \in \ZZ $. Have a map
$$ \bijection{A}{mA \times nA}{x}{\br{mbx, nax}}{x + y}{\br{x, y}}. $$
Then $ mA $ has order $ n $ and $ nA $ has order $ m $. Clearly inverses on one side, so counting implies isomorphism.
\end{proof}

\begin{proof}[Proof of Proposition \ref{prop:correspondence}]
\hfill
\begin{enumerate}
\item Easy.
\item If $ L \in \LLL $, then
$$ \R_\lambda\T_nL = \R_\lambda\sum_{L' \subseteq_n L} L' = \sum_{L' \subseteq_n L} \R_\lambda L' = \sum_{L' \subseteq_n \R_\lambda L} L' = \T_n\R_\lambda L. $$
\item If $ L \in \LLL $, then
$$ \T_n\T_mL = \T_n\sum_{L' \subseteq_m L} L' = \sum_{L' \subseteq_m L} \T_nL' = \sum_{L' \subseteq_m L} \sum_{L'' \subseteq_n L'} L''. $$
An observation is $ L'' \subseteq_n L' \subseteq_m L $, so $ L'' \subseteq_{nm} L $. Then
$$ \T_n\T_mL = \sum_{L'' \subseteq_{nm} L} c_{n, m}\br{L'', L}L'', \qquad c_{n, m}\br{L'', L} = \#\cbr{L' \in \LLL \st L'' \subseteq_n L' \subseteq_m L}. $$
An observation is that there is a bijection
$$ \bijection{\cbr{\text{lattices} \ L' \st L'' \subseteq_n L' \subseteq_m L}}{\cbr{\text{subgroups} \ H \ \text{of} \ L / L'' \ \text{of order} \ n}}{L'}{L' / L'' \subseteq L / L''}{\text{preimage of} \ H \ \text{under} \ L \to L / L''}{H}. $$
Have $ \br{n, m} = 1 $, then $ c_{n, m}\br{L'', L} = 1 $ so
$$ \T_n\T_mL = \sum_{L'' \subseteq_{nm} L} c_{n, m}\br{L'', L}L'' = \sum_{L'' \subseteq_{nm} L} L'' = \T_{nm}L. $$

\pagebreak

\item Similarly, if $ L \in \LLL $, then
$$ \T_p\T_{p^r}L = \sum_{L'' \subseteq_{p^{r + 1}} L} c_{p, p^r}\br{L'', L}L'', \qquad c_{p, p^r}\br{L'', L} = \#\cbr{L' \in \LLL \st L'' \subseteq_p L' \subseteq_{p^r} L}. $$
What is
$$ c_{p, p^r}\br{L'', L} = \#\cbr{\text{subgroups of order} \ p \ \text{in} \ L / L''}? $$
$ L / L'' $ is abelian of order $ p^{r + 1} $ and is generated by two elements. By the classification of finite abelian groups, every finite abelian group can be written uniquely as
$$ \ZZ / a_1\ZZ \times \dots \times \ZZ / a_r\ZZ, \qquad a_1 \mid \dots \mid a_r, $$
up to isomorphism, and $ r $ is the minimal number of generators for such a group. So
$$ L / L'' \cong \ZZ / p^a\ZZ \times \ZZ / p^b\ZZ, \qquad a, b \ge 0, \qquad a + b = r + 1. $$
\begin{enumerate}[leftmargin=0.5in, label=Case \arabic*.]
\item $ L / L'' \cong \ZZ / p^{r + 1}\ZZ $ is cyclic. In this case $ c_{p, p^r}\br{L'', L} = 1 $.
\item $ L / L'' \cong \ZZ / p^a\ZZ \times \ZZ / p^b\ZZ $ with $ a, b > 0 $. Any subgroup of order $ p $ is contained in the subgroup killed by $ p $,
$$ p^{a - 1}\ZZ / p^a\ZZ \times p^{b - 1}\ZZ / p^b\ZZ \cong \br{\ZZ / p\ZZ}^2. $$
The $ p^2 - 1 $ elements of $ \br{\ZZ / p\ZZ}^2 $ other than zero each spans a subgroup of order $ p $, and two elements span the same group if and only if they differ by a scalar in $ \br{\ZZ / p\ZZ}^\times $, so there are $ \br{p^2 - 1} / \br{p - 1} = p + 1 $ subgroups of order $ p $ in $ \br{\ZZ / p\ZZ}^2 $. In this case $ c_{p, p^r}\br{L'', L} = p + 1 $.
\end{enumerate}
The latter case occurs if and only if $ L / L'' $ maps surjectively to $ \br{\ZZ / p\ZZ}^2 \cong L / \R_pL $, if and only if $ \R_pL \supseteq L'' $. Thus
\begin{align*}
\T_p\T_{p^r}L
& = \sum_{L'' \subseteq_{p^{r + 1}} L} c_{p, p^r}\br{L'', L}L''
= \sum_{L'' \subseteq_{p^{r + 1}} L \ \text{cyclic}} L'' + \br{p + 1}\sum_{L'' \subseteq_{p^{r + 1}} L \ \text{not cyclic}} L'' \\
& = \T_{p^{r + 1}}L + p\sum_{L'' \subseteq_{p^{r + 1}} L \ \text{not cyclic}} L''
= \T_{p^{r + 1}}L + p\sum_{L'' \subseteq_{p^{r - 1}} \R_pL} L''
= \T_{p^{r + 1}}L + p\T_{p^{r - 1}}\R_pL.
\end{align*}
\end{enumerate}
\end{proof}

\subsubsection{Hecke operators}

\lecture{16}{Friday}{08/11/19}

If $ F : \LLL \to \CC $, then
$$ \br{\T_nF}\br{L} = \sum_{L' \subseteq_n L} F\br{L'}, \qquad \br{\R_\lambda F}\br{L} = F\br{\R_\lambda L}. $$
Recall that $ F $ has weight $ k $ if $ F\br{\R_\lambda L} = \lambda^{-k}F\br{L} $ for all $ \lambda \in \CC^\times $, if and only if
$$ \R_\lambda F = \lambda^{-k}F, \qquad \lambda \in \CC^\times, $$
so
$$ \R_\lambda\T_nF = \T_n\R_\lambda F = \T_n\lambda^{-k}F = \lambda^{-k}\T_nF. $$
So the $ \T_n $ and $ \R_\lambda $ preserve lattice functions of weight $ k $. Have a bijection
$$ \function{\cbr{f : \HH \to \CC \st f\br{\gamma z} = \br{cz + d}^kf\br{z}}}{\cbr{\text{lattice functions} \ F \ \text{of weight} \ k}}{f\br{z}}{F\br{\L_{z, 1}}}. $$
On lattice functions of weight $ k $, have
$$ \T_p\T_{p^r} = \T_{p^{r + 1}} + p^{1 - k}\T_{p^{r - 1}}. $$

\begin{definition}
For $ f : \HH \to \CC $ corresponding to $ F : \LLL \to \CC $ of weight $ k $, define $ \T_nf $ by
$$ \br{\T_nf}\br{z} = n^{k - 1}\br{\T_nF}\br{\L_{z, 1}} = n^{k - 1}\sum_{L' \subseteq_n \L_{z, 1}} F\br{L'}. $$
\end{definition}

\pagebreak

On $ f : \HH \to \CC $, $ \T_n $ satisfy
$$ \T_p\T_{p^r} = \T_{p^{r + 1}} + p^{k - 1}\T_{p^{r - 1}}. $$
Need to rewrite $ \sum_{L' \subseteq_n \L_{z, 1}} F\br{L'} $ in terms of $ f $. Let
$$ \S^n = \cbr{\twobytwo{a}{b}{0}{d} \in \Mat_{2 \times 2} \ZZ \st ad = n, \ a, d > 0, \ 0 \le b < d}. $$

\begin{lemma}
The map
$$ \function{\S^n}{\cbr{\text{sublattices of} \ \L_{z, 1} \ \text{of index} \ n}}{\twobytwo{a}{b}{0}{d}}{\L_{az + b, d}} $$
is a bijection.
\end{lemma}

\begin{proof}
For surjectivity, let $ L \subseteq_n \L_{z, 1} $. Then $ \L_{z, 1} / L $ is a group of order $ n $. Can consider $ 1 + L \in \L_{z, 1} / L $. Let $ d $ be the order of $ 1 + L $, that is $ d $ is the smallest positive integer such that $ d \in L $. Then $ d \mid n $, so set $ a = n / d $. Let $ L' = \ZZ + L $ be the lattice generated by $ 1 $ and $ L $. Then $ L \subseteq_d L' $ and $ L \subseteq_n \L_{z, 1} $, so $ L' \subseteq_a \L_{z, 1} $, so $ az \in L' $, so there exists $ b \in \ZZ $ such that $ az + b \in L $. Since $ d \in L $, without loss of generality can arrange $ 0 \le b < d $. Now $ d \in L $ and $ az + b \in L $, so $ \L_{az + b, d} \subseteq_n \L_{z, 1} $ and $ L \subseteq_n \L_{z, 1} $, so $ L = \L_{az + b, d} $. Thus surjective, and for injectivity, can recover $ a, b, d $ from $ \L_{az + b, d} \subseteq \L_{z, 1} $.
\end{proof}

Thus
\begin{align*}
\T_nf
& = n^{k - 1}\sum_{L' \subseteq_n \L_{z, 1}} F\br{L'}
= n^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^n} F\br{\L_{az + b, d}} \\
& = n^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^n} d^{-k}F\br{\L_{\tfrac{az + b}{d}, 1}}
= n^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^n} d^{-k}f\br{\dfrac{az + b}{d}}.
\end{align*}

\begin{theorem}
If $ f = \sum_{m = 0}^\infty c_mq^m $ is modular of weight $ k $, then
$$ \T_nf = \sum_{m = 0}^\infty \gamma_mq^m, \qquad \gamma_m = \sum_{a \mid \br{m, n}, \ a > 0} a^{k - 1}c_{\tfrac{mn}{a^2}}. $$
\end{theorem}

\begin{proof}
\begin{align*}
\T_nf
& = n^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^n} d^{-k}f\br{\dfrac{az + b}{d}}
= n^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^n} \sum_{m = 0}^\infty d^{-k}c_me^{2\pi im\br{\tfrac{az + b}{d}}} \\
& = n^{k - 1}\sum_{ad = n, \ a > 0} \sum_{b = 0}^{d - 1} \sum_{m = 0}^\infty d^{-k}c_mq^{\tfrac{ma}{d}}e^{\tfrac{2\pi imb}{d}}
= n^{k - 1}\sum_{m = 0}^\infty \sum_{ad = n, \ a > 0} d^{-k}c_mq^{\tfrac{ma}{d}}\sum_{b = 0}^{d - 1} e^{\tfrac{2\pi imb}{d}}.
\end{align*}
Then
$$ \sum_{b = 0}^{d - 1} e^{\tfrac{2\pi imb}{d}} =
\begin{cases}
d & d \mid m \\
0 & d \nmid m
\end{cases},
$$
so
$$ \T_nf = n^{k - 1}\sum_{m = 0, \ d \mid m}^\infty \sum_{ad = n, \ a > 0} d^{1 - k}c_mq^{\tfrac{ma}{d}} = \sum_{a \mid n, \ a > 0} \sum_{m' = 0}^\infty a^{k - 1}c_{\tfrac{m'n}{a}}q^{m'a}. $$
Which $ m' $ and $ a $ give $ q^m $? Need $ a \mid \br{m, n} $ for $ a > 0 $ and $ m'a = m $, so the coefficient is $ a^{k - 1}c_{mn / a^2} $. The sum of these is
$$ \gamma_m = \sum_{a \mid \br{m, n}, \ a > 0} a^{k - 1}c_{\tfrac{mn}{a^2}}. $$
\end{proof}

\pagebreak

\begin{corollary}
$ \T_n $ preserves $ \M_k $ and $ \S_k $.
\end{corollary}

In the case $ n = p $,
$$ \T_pf = \sum_{m = 0}^\infty \gamma_mq^m, \qquad \gamma_m =
\begin{cases}
c_{mp} + p^{k - 1}c_{\tfrac{m}{p}} & p \mid m \\
c_{mp} & p \nmid m
\end{cases}.
$$

\subsubsection{Eigenforms}

An observation is that the dimensions of $ \M_4, \M_6, \M_8, \M_{10}, \S_{12} $ are one, so $ \E_4, \E_6, \E_8, \E_{10}, \Delta $ are eigenvectors for $ \T_n $ for all $ n $.

\begin{definition}
A function $ f \in \M_k $ is an \textbf{eigenform} if there exists $ \lambda_n \in \CC^\times $ such that $ \T_nf = \lambda_nf $ for all $ n \in \ZZ_{> 0} $.
\end{definition}

\lecture{17}{Friday}{08/11/19}

\begin{proposition}
\label{prop:eigenform}
Let $ f \in \M_k $ be an eigenform, with $ k > 0 $, so $ \T_nf = \lambda_nf $ for all $ n $. Then if $ f = \sum_m c_mq^m $, we have $ c_1 \ne 0 $ and $ \lambda_nc_1 = c_n $ for all $ n \ge 1 $. In particular, if $ c_1 = 1 $, then $ c_n = \lambda_n $ for all $ n $.
\end{proposition}

\begin{proof}
$$ \sum_{m = 0}^\infty \lambda_nc_mq^m = \lambda_nf = \T_nf = \sum_{m = 0}^\infty \gamma_mq^m, \qquad \gamma_1 = \sum_{a \mid \br{1, n}} a^{k - 1}c_n = c_n, $$
so $ \lambda_nc_1 = c_n $. Suppose $ c_1 = 0 $. Then $ c_n = 0 $ for all $ n \ge 1 $, so $ f $ is constant. Since $ k \ne 0 $, this does not happen.
\end{proof}

\begin{corollary}
Recall that $ \Delta\br{z} = \sum_n \tau\br{n}q^n $. Then
\begin{itemize}
\item $ \tau\br{mn} = \tau\br{n}\tau\br{m} $ if $ \br{m, n} = 1 $, and
\item $ \tau\br{p^{r + 1}} = \tau\br{p}\tau\br{p^r} - p^{11}\tau\br{p^{r - 1}} $.
\end{itemize}
\end{corollary}

\begin{proof}
$ \Delta \in \S_{12} $ is one-dimensional, so there exists $ \lambda_n $ such that $ \T_n\Delta = \lambda_n\Delta $. Proposition \ref{prop:eigenform} implies that $ \lambda_n = \tau\br{n} $ for all $ n $. Thus
\begin{itemize}
\item $ \tau\br{mn}\Delta = \lambda_{mn}\Delta = \T_{mn}\Delta = \T_m\T_n\Delta = \lambda_m\lambda_n\Delta = \tau\br{m}\tau\br{n}\Delta $, and
\item $ \tau\br{p^{r + 1}}\Delta = \T_{p^{r + 1}}\Delta = \T_p\T_{p^r}\Delta - p^{11}\T_{p^{r - 1}}\Delta = \br{\tau\br{p}\tau\br{p^r} - p^{11}\tau\br{p^{r - 1}}}\Delta $.
\end{itemize}
\end{proof}

In fact, the same argument shows if $ f \in \M_k $ for $ k > 0 $ is an eigenform, with $ q $-coefficient one, a \textbf{normalised eigenform}, and $ f = \sum_{n = 0}^\infty c_nq^n $, then
\begin{itemize}
\item $ c_{nm} = c_nc_m $ if $ \br{n, m} = 1 $, and
\item $ c_{p^{r + 1}} = c_pc_{p^r} - p^{k - 1}c_{p^{r - 1}} $.
\end{itemize}

\begin{proposition}
$ \E_k $ is an eigenform for all $ k $.
\end{proposition}

\begin{proof}
It suffices to show $ \T_p\E_k = \lambda_p\E_k $ for all primes $ p $. Recall that $ \E_k $ is a constant multiple of $ \G_k $. Now
$$ \br{\T_p\G_k}\br{L} = \sum_{L' \subseteq_p L} \sum_{w \in L', \ w \ne 0} \dfrac{1}{w^k} = \sum_{w \in L, \ w \ne 0} c_w\dfrac{1}{w_k}, \qquad c_w = \#\cbr{L' \subseteq_p L \st w \in L'}. $$
Note that $ pL \subseteq L' \subseteq L $. If $ w \in pL $, then $ w \in L' $ for all $ L' \subseteq_p L $, and there are $ p + 1 $ of these. If $ w \notin pL $, then $ pL \subsetneq pL + \ZZ w \subsetneq L $ and $ pL \subseteq_{p^2} L $, so $ pL \subsetneq_p pL + \ZZ w $ and $ pL + \ZZ w \subsetneq_p L $. In this case there exists a unique lattice of index $ p $ containing $ w $. Thus
\begin{align*}
\br{\T_p\G_k}\br{L}
& = \sum_{w \in L \setminus pL} \dfrac{1}{w^k} + \br{p + 1}\sum_{w \in pL, \ w \ne 0} \dfrac{1}{w^k}
= \sum_{w \in L, \ w \ne 0} \dfrac{1}{w^k} + p\sum_{w \in pL, \ w \ne 0} \dfrac{1}{w^k} \\
& = \G_k\br{L} + p\sum_{w \in L, \ w \ne 0} \dfrac{1}{\br{pw}^k}
= \G_k\br{L} + p^{1 - k}\sum_{w \in L, \ w \ne 0} \dfrac{1}{w^k}
= \br{1 + p^{1 - k}}\G_k\br{L},
\end{align*}
so $ \T_p\E_k = \br{1 + p^{k - 1}}\E_k $.
\end{proof}

\pagebreak

A question is does $ \M_k $ have a basis of eigenforms for all $ k $? By linear algebra, there exist nice classes of operators that are guaranteed to admit bases of eigenvectors, such as self-adjoint, or more generally, normal operators.

\subsubsection{Hermitian pairings}

Let $ V $ be a $ \CC $-vector space and $ \abr{\cdot, \cdot} : V \times V \to \CC $ a \textbf{Hermitian pairing}. That is,
\begin{itemize}
\item $ \abr{\lambda v + w, x} = \lambda\abr{v, x} + \abr{w, x} $,
\item $ \abr{x, y} = \overline{\abr{y, x}} $, and
\item $ \abr{x, x} > 0 $ for all $ x \ne 0 $.
\end{itemize}

\begin{example*}
The standard pairing
$$ \function{\CC^n \times \CC^n}{\CC}{\abr{z, w}}{\sum_{i = 1}^n z_i\overline{w_i}}. $$
\end{example*}

\begin{definition}
Let $ A : V \to V $ be $ \CC $-linear, and $ \abr{\cdot, \cdot} : V \times V \to \CC $ Hermitian. Then the \textbf{adjoint} $ A^* : V \to V $ is the unique linear map $ V \to V $ such that
$$ \abr{Av, w} = \abr{v, A^*w}. $$
We say $ A $ is \textbf{self-adjoint} if $ A^* = A $, and \textbf{normal} if $ A^* $ commutes with $ A $.
\end{definition}

\begin{theorem}
If $ A $ is normal, then $ A $ has a basis of eigenvectors.
\end{theorem}

\lecture{18}{Monday}{11/11/19}

\begin{lemma}
$ A^{**} = A $.
\end{lemma}

\begin{proof}
For all $ v, w \in V $,
$$ \abr{v, A^{**}w} = \abr{A^*v, w} = \overline{\abr{w, A^*v}} = \overline{\abr{Aw, v}} = \abr{v, Aw}, $$
so $ A^{**}w = Aw $ for all $ w \in V $.
\end{proof}

\begin{definition}
If $ W \subseteq V $, let
$$ W^\perp = \cbr{v \in V \st \forall w \in W, \ \abr{v, w} = 0}. $$
\end{definition}

\begin{proposition}
$ \im A^* = \br{\ker A}^\perp $.
\end{proposition}

\begin{proof}
$ \abr{v, A^*w} = \abr{Av, w} = 0 $ if $ v \in \ker A $. So $ \im A^* \subseteq \br{\ker A}^\perp $, so $ \rk A^* \le \rk A $. The same argument with $ A^* $ in place of $ A $ implies that $ \rk A = \rk A^{**} \le \rk A^* $. So $ \rk A^* = \rk A $, so $ \im A^* = \br{\ker A}^\perp $.
\end{proof}

In particular, $ \im A^* \cap \ker A = \cbr{0} $ and $ \dim \im A^* + \dim \ker A = \rk A^* + n - \rk A = n $. So
$$ V = \im A^* \oplus \ker A. $$

\begin{theorem}[Spectral theorem for normal operators]
If $ A $ and $ A^* $ commute, then $ A^* $ is diagonalisable.
\end{theorem}

\begin{proof}
Induction on $ \dim V $. Then $ \dim V = 1 $ is clear. Let $ \lambda $ be an eigenvalue of $ A $, and let $ A' = A - \lambda\id_V $, so $ V = \ker A' \oplus \im A'^* $, where $ \dim \ker A' > 0 $. Then $ A $ commutes with $ A' $, and $ A'^* = A^* - \overline{\lambda}\id_V $, so $ A $ commutes with $ A'^* $. So $ AA'^*v = A'^*Av $, so $ A $ preserves the image of $ A'^* $. The restriction of $ \abr{\cdot, \cdot} $ to $ \im A'^* $ is still Hermitian on $ \im A'^* $ and the restriction of $ A $ to $ \im A'^* $ is still normal, since its adjoint is the restriction of $ A^* $ to $ \im A'^* $. By induction $ A $ is diagonalisable on $ \im A'^* $ and scalar on $ \ker A' $, so diagonalisable.
\end{proof}

Also the need the following observation.

\begin{proposition}
If $ A : V \to V $ and $ B : V \to V $ commute, and $ V_\lambda = \ker \br{A - \lambda\id_V} $, then $ BV_\lambda = V_\lambda $.
\end{proposition}

\begin{proof}
If $ v \in V_\lambda $, then $ ABv = BAv = B\lambda v = \lambda Bv $, so $ Bv \in V_\lambda $.
\end{proof}

\pagebreak

\subsubsection{The Petersson inner product}

To apply this to modular forms, we need a bilinear pairing on $ \M_k $ or $ \S_k $. The idea is to show that there exists a pairing $ \abr{\cdot, \cdot}_k : \S_k \times \S_k \to \CC $ such that $ \abr{\T_nf, g} = \abr{f, \T_ng} $ for all $ n $, so $ \T_n $ are self-adjoint, hence diagonalisable.

\begin{definition}
Let $ f, g \in \S_k $. The \textbf{Petersson inner product of weight $ k $} is
$$ \abr{f, g}_k = \iintd{\DDD}{f\br{z}\overline{g\br{z}}\dfrac{y^k}{y^2}}{x}{y} = \dfrac{i}{2}\iintd{\DDD}{f\br{z}\overline{g\br{z}}\dfrac{\Im z^k}{\Im z^2}}{z}{\overline{z}}. $$
Here $ z = x + iy $ and $ \overline{z} = x - iy $, so
$$ \d z\d\overline{z} = \br{\d x + i\d y} \wedge \br{\d x - i\d y} = -2i\br{\d x \wedge \d y}. $$
\end{definition}

Let $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \SL_2\br{\ZZ} $. Then
$$ f\br{\gamma z}\overline{g\br{\gamma z}}\Im \gamma z^k = f\br{z}\br{cz + d}^k\overline{g\br{z}\br{cz + d}^k}\dfrac{\Im z^k}{\abs{cz + d}^{2k}} = f\br{z}\overline{g\br{z}}\Im z^k, $$
and
$$ \dfrac{1}{\Im \gamma z^2}\d\br{\gamma z}\d\br{\gamma \overline{z}} = \dfrac{1}{\Im \gamma z^2\abs{cz + d}^4}\d z\d\overline{z} = \dfrac{1}{\Im z^2}\d z\d\overline{z}, $$
so for all $ U \subseteq \HH $,
$$ \iintd{\gamma\br{U}}{f\br{z}\overline{g\br{z}}\dfrac{\Im z^k}{\Im z^2}}{z}{\overline{z}} = \iintd{U}{f\br{z}\overline{g\br{z}}\dfrac{\Im z^k}{\Im z^2}}{z}{\overline{z}}. $$

\begin{note*}
This converges for $ f, g \in \S_k $, since $ f\br{a + it} $ goes like $ e^{-t} $ as $ t \to \pm\infty $, and the same for $ g $. If $ \abr{f, f} = 0 $, the integrand vanishes identically, since it lives in $ \RR_{\ge 0} $. So $ f = 0 $ on $ \DDD $, hence everywhere. Then
$$ \abr{\lambda f, g}_k = \lambda\abr{f, g}_k, \qquad \abr{f, \lambda g}_k = \overline{\lambda}\abr{f, g}_k, \qquad \abr{f, g}_k = \overline{\abr{g, f}}_k. $$
So $ \abr{\cdot, \cdot}_k $ is Hermitian.
\end{note*}

\begin{theorem}
\label{thm:innerproduct}
$$ \abr{\T_nf, g}_k = \abr{f, \T_ng}_k, \qquad f, g \in \S_k, \qquad n \in \ZZ_{\ge 1}. $$
\end{theorem}

\begin{corollary}
Each $ \T_n $ is diagonalisable on $ \S_k $. Since $ \T_n $ and $ \T_m $ commute for all $ n $ and $ m $, $ \T_m $ preserves eigenspaces of $ \T_n $ for all $ m $. By induction, $ \T_m $ preserves the simultaneous eigenspaces of $ \T_n $ for all $ n < m $.
\end{corollary}

\begin{proposition}
Let $ n > \fbr{k / 12} + 1 $. Fix $ \lambda_2, \dots, \lambda_n \in \CC $. The subspace $ V $ of $ \S_k $ on which
$$ \T_i = \lambda_i, \qquad i = 2, \dots, n $$
is zero or one-dimensional.
\end{proposition}

\begin{proof}
Let $ f \in V $, so $ f = c_1q + c_2q^2 + \dots $. Seen if $ \T_if = \lambda_if $, then $ c_i = \lambda_ic_1 $. Also seen that if the first $ n $ Fourier coefficients of $ f $ vanishes, then $ f = 0 $, by the $ k / 12 $-formula. So $ c_1 \ne 0 $ unless $ f = 0 $. Now if $ f, g \in V \setminus \cbr{0} $, there exists $ \lambda \in \CC $ such that $ f $ and $ \lambda g $ have the same $ q $-coefficient, and thus the same first $ n $ Fourier coefficients. But then $ f - \lambda g = 0 $.
\end{proof}

\begin{corollary}
$ \S_k $ admits a basis of eigenforms for all $ k $.
\end{corollary}

\begin{proof}
Let $ n \ge \fbr{k / 12} + 1 $. Can diagonalise $ \S_k $ with respect to the first $ n $ Hecke operators. Any simultaneous eigenspace for these is at most one-dimensional, and preserved by all $ \T_n $. So each of these is actually an eigenspace for all $ \T_n $.
\end{proof}

\pagebreak

\lecture{19}{Friday}{15/11/19}

\begin{note*}
If $ f $ and $ g $ are eigenforms, and $ f $ is not a scalar multiple of $ g $, there exists $ \T_n $ such that $ \T_nf = \lambda_nf $ and $ \T_ng = \mu_ng $ with $ \lambda_n \ne \mu_n $. Then
$$ \abr{\T_nf, g}_k = \abr{\lambda_nf, g}_k = \lambda_n\abr{f, g}_k, \qquad \abr{f, \T_ng}_k = \abr{f, \mu_ng}_k = \overline{\mu_n}\abr{f, g}_k, $$
$$ \lambda_n\abr{f, f}_k = \abr{\T_nf, f}_k = \abr{f, \T_nf}_k = \overline{\abr{\T_nf, f}}_k = \overline{\lambda_n}\abr{f, f}_k. $$
So $ \lambda_n = \overline{\lambda_n} $ and $ \mu_n = \overline{\mu_n} $. Then $ \br{\lambda_n - \mu_n}\abr{f, g}_k = 0 $, so $ \abr{f, g}_k = 0 $.
\end{note*}

By the formula for $ \T_n $ on $ q $-expansions, $ \T_n $ takes a $ q $-expansion with integer coefficients to another such. Saw that the space of modular forms with integral $ q $-expansions is spanned by
$$ \E_4^n\E_6^m, \dots, \E_4^{n - 3\fbr{n / 3}}\E_6^m\Delta^{\fbr{n / 3}}, \qquad k = 4n + 6m, \qquad n, m > 0, $$
where $ m = 0, 1 $ is minimal, so the matrix of $ \T_n $ with respect to this basis has integer entries. Thus the characteristic polynomial of $ \T_n $ on $ \S_k $ has integer coefficients, so the eigenvalues of $ \T_n $ are algebraic integers.

\begin{example*}
Can ask when modular forms are congruent modulo $ p $. In fact $ \E_{12} \equiv \Delta \mod 691 $.
\end{example*}

Ribet 1970s proved that when an Eisenstein series of suitable weight is congruent modulo $ p $ to a cusp form, can use the Galois representation attached to that cusp form to construct elements of ideal class groups of cyclotomic fields.

\subsection{\texorpdfstring{$ \L $}{L}-functions}

\subsubsection{Dirichlet \texorpdfstring{$ \L $}{L}-functions}

\begin{definition}
Let $ \cbr{a_n}_{n \ge 1} $ be a sequence of complex numbers, usually algebraic integers. The \textbf{Dirichlet series} attached to $ a_n $ is the formal series
$$ \sum_{n = 1}^\infty a_nn^{-s}, $$
thought of as a function of $ s \in \CC $.
\end{definition}

In general, if $ \abs{a_n} \le Cn^k $, then the corresponding series converges absolutely for $ \Re s > k + 1 $.

\begin{example*}
\hfill
\begin{itemize}
\item The \textbf{Riemann $ \zeta $-function} is
$$ \zeta\br{s} = \sum_{n = 1}^\infty n^{-s}. $$
\item Let $ \chi : \br{\ZZ / N\ZZ}^\times \to \CC^\times $ be a \textbf{primitive character}, that is does not factor through $ \br{\ZZ / N\ZZ}^\times \to \br{\ZZ / m\ZZ}^\times $ for $ m \mid N $ such that $ m \ne N $. Set
$$ a_n =
\begin{cases}
\chi\br{n} & \br{n, N} = 1 \\
0 & \br{n, N} \ne 1
\end{cases}.
$$
Then
$$ \L\br{s, \chi} = \sum_{n = 1}^\infty a_nn^{-s} $$
is the \textbf{Dirichlet $ \L $-function} attached to $ \chi $.
\end{itemize}
\end{example*}

In both these examples, and many others,
\begin{itemize}
\item these series have meromorphic, and often analytic, continuations to all of $ \CC $,
\item there is a \textbf{functional equation} relating values at $ s $ and $ k - s $ for some $ k $, and
\item there is an \textbf{Euler product}.
\end{itemize}

\pagebreak

\begin{example*}
$$ \zeta\br{s} = 2^s\pi^{s - 1}\sin \tfrac{\pi s}{2}\Gamma\br{1 - s}\zeta\br{1 - s}, \qquad \zeta\br{s} = \prod_{p \ \text{prime}} \dfrac{1}{1 - p^{-s}}, \qquad \L\br{s, \chi} = \prod_{p \nmid N} \dfrac{1}{1 - \chi\br{p}p^{-s}}. $$
\end{example*}

\subsubsection{Hecke \texorpdfstring{$ \L $}{L}-functions}

\begin{definition}
Let $ f = \sum_{n = 0}^\infty a_nq^n \in \M_k $. Define the \textbf{Hecke $ \L $-function of weight $ k $}
$$ \L\br{s, f} = \sum_{n = 1}^\infty a_nn^{-s}. $$
\end{definition}

\begin{example*}
Let
$$ f = \E_k' = \b_k\dfrac{\br{-1}^{\tfrac{k}{2}}}{2k} + \sum_{n = 1}^\infty \sigma_{k - 1}\br{n}q^n. $$
Then
$$ \L\br{s, f} = \sum_{n = 1}^\infty \sigma_{k - 1}\br{n}n^{-s} = \prod_{p \ \text{prime}} \dfrac{1}{1 - \sigma_{k - 1}\br{p}p^{-s}} = \prod_{p \ \text{prime}} \dfrac{1}{1 - p^{-s}} \cdot \dfrac{1}{1 - p^{k - 1}p^{-s}} = \zeta\br{s}\zeta\br{s - k + 1}, $$
since $ \sigma_{k - 1}\br{mn} = \sigma_{k - 1}\br{m}\sigma_{k - 1}\br{n} $ for $ \br{m, n} = 1 $ and $ \sigma_{k - 1}\br{p^r} = 1 + \dots + p^{r\br{k - 1}} $.
\end{example*}

\lecture{20}{Friday}{15/11/19}

Let $ f = \sum_{n = 1}^\infty a_nq^n $ be a cusp form. Recall that Hecke implies that $ \abs{a_n} \le Cn^{k / 2} $, so gives absolute convergence of $ \L\br{s, f} $ for $ \Re s > k / 2 + 1 $.

\begin{theorem}
\label{thm:lfunction}
\hfill
\begin{enumerate}
\item $ \L\br{s, f} $ extends to a holomorphic function on all of $ \CC $.
\item Set
$$ \R\br{s, f} = \dfrac{\Gamma\br{s}}{\br{2\pi}^s}\L\br{s, f}. $$
Then
$$ \R\br{s, f} = \br{-1}^{\tfrac{k}{2}}\R\br{k - s, f}. $$
\item If $ f $ is a normalised eigenform, then
$$ \L\br{s, f} = \prod_{p \ \text{prime}} \dfrac{1}{1 - a_pp^{-s} + p^{k - 1}p^{-2s}}. $$
\end{enumerate}
\end{theorem}

\begin{definition}
The infinite product $ \prod_{n = 1}^\infty \br{1 + c_n} $ \textbf{converges} if
$$ \lim_{N \to \infty} \prod_{n = 1}^N \br{1 + c_n} $$
converges to a non-zero number, if and only if $ \sum_{n = 1}^\infty \log \br{1 + c_n} $ converges. Then $ \prod_{n = 1}^\infty \br{1 + c_n} $ \textbf{converges absolutely} if
$$ \prod_{n = 1}^\infty \br{1 + \abs{c_n}} $$
converges.
\end{definition}

\begin{lemma}
$ \prod_{n = 1}^\infty \br{1 + c_n} $ converges absolutely if and only if $ \sum_{n = 1}^\infty \abs{c_n} $ converges.
\end{lemma}

\begin{proof}
$$ \sum_{n = 1}^N \abs{c_n} \le \prod_{n = 1}^N \br{1 + \abs{c_n}} \le \prod_{n = 1}^N e^{\abs{c_n}} \le e^{\sum_{n = 1}^\infty \abs{c_n}}. $$
\end{proof}

\pagebreak

\begin{proof}[Proof of Theorem \ref{thm:lfunction}]
Recall that
$$ \Gamma\br{s} = \intd{0}{\infty}{t^{s - 1}e^{-t}}{t} $$
is meromorphic on $ \HH $, with poles at $ \ZZ_{\le 0} $ and never zero, and satisfies $ \Gamma\br{s + 1} = s\Gamma\br{s} $ so $ \Gamma\br{n} = \br{n - 1}! $. Substituting $ t \mapsto 2\pi nt $ in $ \Gamma\br{s} $,
$$ \Gamma\br{s} = \intd{0}{\infty}{\br{2\pi nt}^{s - 1}e^{-2\pi nt}\br{2\pi n}}{t} = \br{2\pi n}^s\intd{0}{\infty}{t^{s - 1}e^{-2\pi nt}}{t}, $$
so
$$ \L\br{s, f} = \sum_{n = 1}^\infty a_nn^{-s} = \sum_{n = 1}^\infty a_n\dfrac{\br{2\pi}^s}{\Gamma\br{s}}\intd{0}{\infty}{t^{s - 1}e^{-2\pi nt}}{t}. $$
Then
\begin{align*}
\R\br{s, f}
& = \dfrac{\Gamma\br{s}}{\br{2\pi}^s}\L\br{s, f}
= \sum_{n = 1}^\infty a_n\intd{0}{\infty}{t^{s - 1}e^{-2\pi nt}}{t}
= \intd{0}{\infty}{t^{s - 1}\sum_{n = 1}^\infty a_ne^{-2\pi nt}}{t}
= \intd{0}{\infty}{t^{s - 1}f\br{it}}{t} \\
& = \intd{0}{1}{t^{s - 1}f\br{it}}{t} + \intd{1}{\infty}{t^{s - 1}f\br{it}}{t}
= \intd{1}{\infty}{\br{\dfrac{1}{t}}^{s - 1}f\br{\dfrac{i}{t}}}{\br{\dfrac{1}{t}}} + \intd{1}{\infty}{t^{s - 1}f\br{it}}{t} \\
& = \intd{1}{\infty}{\br{t^{-s - 1}\br{it}^kf\br{it} + t^{s - 1}f\br{it}}}{t}
= \intd{1}{\infty}{f\br{it}\br{\br{-1}^{\tfrac{k}{2}}t^{k - s - 1} + t^{s - 1}}}{t}.
\end{align*}
\begin{enumerate}
\item $ \R\br{s, f} $ converges independently of $ s $ uniformly for $ s $ in a compact subset of $ \CC $, so it is holomorphic in $ s $, and extends to a holomorphic function on $ \CC $. Then
$$ \L\br{s, f} = \dfrac{\br{2\pi}^s}{\Gamma\br{s}}\R\br{s, f}, $$
so $ \L\br{s, f} $ is holomorphic since $ \Gamma\br{s} $ is non-vanishing.
\item $ \R\br{s, f} $ is symmetric up to a sign under $ s \mapsto k - s $, so
$$ \R\br{s, f} = \br{-1}^{\tfrac{k}{2}}\R\br{k - s, f}. $$
\item Now assume $ f $ is a normalised eigenform, so $ f = \sum_{n = 1}^\infty a_nq^n $ with $ a_1 = 1 $ and $ \T_nf = a_nf $. Then $ a_{nm} = a_na_m $ if $ \br{n, m} = 1 $, so
$$ \L\br{s, f} = \sum_n a_nn^{-s} = \prod_{p \ \text{prime}} \sum_{k = 0}^\infty a_{p^k}p^{-ks}, $$
a power series in $ p^{-s} $. Fix $ p $, and consider
$$ \br{1 - a_pp^{-s} + p^{k - 1}p^{-2s}}\sum_{k = 0}^\infty a_{p^k}p^{-ks}. $$
The $ p^0 $ coefficient is $ a_1 = 1 $, the $ p^{-s} $ coefficient is $ a_pp^{-s} - a_pp^{-s} = 0 $, and the $ p^{-\br{r + 1}s} $ coefficient is
$$ a_{p^{r + 1}}p^{-\br{r + 1}s} - a_pa_{p^r}p^{-\br{r + 1}s} + p^{k - 1}a_{p^{r - 1}}p^{-\br{r + 1}s} = \br{a_{p^{r + 1}} - a_pa_{p^r} + p^{k - 1}a_{p^{r - 1}}}p^{-\br{r + 1}s} = 0, $$
since $ a_{p^{r + 1}} = a_pa_{p^r} - p^{k - 1}a_{p^{r - 1}} $. So
$$ \L\br{s, f} = \prod_{p \ \text{prime}} \sum_{k = 0}^\infty a_{p^k}p^{-ks} = \prod_{p \ \text{prime}} \dfrac{1}{1 - a_pp^{-s} + p^{k - 1}p^{-2s}}. $$
\end{enumerate}
\end{proof}

\lecture{21}{Monday}{18/11/19}

Lecture 21 is a problems class.

\pagebreak

\section{Modular forms of higher level}

\subsection{Modular forms}

\subsubsection{Congruence subgroups}

\lecture{22}{Friday}{22/11/19}

$ \GL_2\br{\QQ}_+ $ acts on $ \HH $ by fractional linear transformations.

\begin{definition}
$ \Gamma\br{N} \subseteq \SL_2\br{\ZZ} $ is the kernel of $ \SL_2\br{\ZZ} \to \SL_2\br{\ZZ / N\ZZ} $ for $ N \in \ZZ_{> 0} $. Alternatively,
$$ \Gamma\br{N} = \cbr{\twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ} \st a \equiv d \equiv 1 \mod N, \ b \equiv c \equiv 0 \mod N}. $$
\end{definition}

\begin{note*}
$ \Gamma\br{N} \subseteq \SL_2\br{\ZZ} $ has finite index.
\end{note*}

\begin{definition}
$ \Gamma \subseteq \GL_2\br{\QQ}_+ $ is a \textbf{congruence subgroup} if $ \Gamma $ contains $ \Gamma\br{N} $ with finite index for some $ N \in \ZZ_{> 0} $.
\end{definition}

\begin{example*}
$ \SL_2\br{\ZZ} $ and $ \Gamma\br{N} $ are congruence subgroups. Let
$$ \Gamma_0\br{N} = \cbr{\twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ} \st c \equiv 0 \mod N}, $$
and
$$ \Gamma_1\br{N} = \cbr{\twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ} \st a \equiv d \equiv 1 \mod N, \ c \equiv 0 \mod N}, $$
so $ \Gamma_1\br{N} $ is the preimage of $ \twobytwosmall{1}{b}{0}{1} \subseteq \SL_2\br{\ZZ / N\ZZ} $ in $ \SL_2\br{\ZZ} $. Then $ \Gamma_0\br{N} $ and $ \Gamma_1\br{N} $ are congruence subgroups such that
$$ \Gamma\br{N} \subseteq \Gamma_1\br{N} \subseteq \Gamma_0\br{N} \subseteq \SL_2\br{\ZZ}. $$
\end{example*}

\begin{proposition}
Let $ \alpha \in \GL_2\br{\QQ}_+ $, and let $ \Gamma $ be a congruence subgroup. Then $ \alpha\Gamma\alpha^{-1} $ is also a congruence subgroup.
\end{proposition}

\begin{proof}
Need that there exists $ M $ with $ \Gamma\br{M} \subseteq \alpha\Gamma\alpha^{-1} $ with finite index. There exists $ N $ such that $ \Gamma\br{N} \subseteq \Gamma $. Note that $ \Gamma\br{N} = \SL_2\br{\QQ} \cap \br{\id_2 + N\Mat_2 \ZZ} $. Consider
$$ \alpha\Gamma\br{N}\alpha^{-1} = \SL_2\br{\QQ} \cap \br{\id_2 + N\alpha\Mat_2 \ZZ\alpha^{-1}}. $$
Choose $ n \in \ZZ $ such that $ n\alpha $ and $ n\alpha^{-1} $ have entries in $ \ZZ $. Then $ n^2\alpha^{-1}\Mat_2 \ZZ\alpha \subseteq \Mat_2 \ZZ $, so $ n^2\Mat_2 \ZZ \subseteq \alpha\Mat_2 \ZZ\alpha^{-1} $, so $ Nn^2\Mat_2 \ZZ \subseteq N\alpha\Mat_2 \ZZ\alpha^{-1} $, so
$$ \Gamma\br{n^2N} = \SL_2\br{\QQ} \cap \br{\id_2 + Nn^2\Mat_2 \ZZ} \subseteq \SL_2\br{\QQ} \cap \br{\id_2 + N\alpha\Mat_2 \ZZ\alpha^{-1}} = \alpha\Gamma\br{N}\alpha^{-1}. $$
Similarly, show
$$ \alpha\Gamma\br{n^4N}\alpha^{-1} \subseteq \Gamma\br{n^2N} \subseteq \alpha\Gamma\br{N}\alpha^{-1}. $$
Since $ \Gamma\br{n^4N} $ has finite index in $ \Gamma\br{N} $, $ \Gamma\br{n^2N} $ has finite index in $ \alpha\Gamma\br{N}\alpha^{-1} $.
\end{proof}

\begin{note*}
Also, if $ T = \lcm\br{M, N} $ then $ \Gamma\br{T} \subseteq \Gamma\br{M} \cap \Gamma\br{N} $, so the intersection of two congruence subgroups is a congruence subgroup.
\end{note*}

\begin{example*}
Let $ \alpha = \twobytwosmall{p}{0}{0}{1} $. Then
$$ \alpha^{-1}\SL_2\br{\ZZ}\alpha = \cbr{\twobytwo{a}{p^{-1}b}{pc}{d} \st \twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ}}, $$
and
$$ \alpha^{-1}\SL_2\br{\ZZ}\alpha \cap \SL_2\br{\ZZ} = \cbr{\twobytwo{a}{b}{pc}{d} \st ad - bpc = 1} = \Gamma_0\br{p}. $$
\end{example*}

\pagebreak

\subsubsection{Modular forms}

Recall that for $ f : \HH \to \CC $ and $ \alpha = \twobytwosmall{a}{b}{c}{d} \in \GL_2\br{\QQ}_+ $, we defined $ \eval{f}_{k, \alpha} $ by
$$ \eval{f}_{k, \alpha}\br{z} = \det \alpha^{k - 1}f\br{\alpha z}\br{cz + d}^{-k}. $$
Suppose we have a $ \Gamma \subseteq \SL_2\br{\QQ} $ and $ f : \HH \to \CC $ such that $ \eval{f}_{k, \gamma} = f $ for all $ \gamma \in \Gamma $. Then if $ g = \eval{f}_{k, \alpha} $, then $ \eval{g}_{k, \alpha^{-1}\gamma\alpha} = g $, since
$$ \eval{\br{\eval{f}_{k, \alpha}}}_{k, \alpha^{-1}\gamma\alpha} = \eval{f}_{k, \gamma\alpha} = \eval{\br{\eval{f}_{k, \gamma}}}_{k, \alpha} = \eval{f}_{k, \alpha}. $$
Fix $ \Gamma \subseteq \SL_2\br{\QQ} $ a congruence subgroup.

\begin{definition}
A function $ f : \HH \to \CC $ is a \textbf{weakly holomorphic or meromorphic modular form of weight $ k $ and level $ \Gamma $} if
\begin{itemize}
\item $ \eval{f}_{k, \gamma} = f $ for all $ \gamma \in \Gamma $, and
\item $ f $ is holomorphic or meromorphic on $ \HH $.
\end{itemize}
\end{definition}

A question is what condition should we impose at $ \infty $ to get a good theory?

\begin{example*}
Let $ k \ge 4 $ and $ N \in \ZZ $, and let
$$ \E_k^{0, 1}\br{z} = \sum_{\br{m, n} \in S^{0, 1}} \dfrac{1}{\br{mz + n}^k}, \qquad S^{0, 1} = \cbr{\br{m, n} \in \ZZ^2 \setminus \cbr{0} \st m \equiv 1 \mod N, \ n \equiv 0 \mod N}. $$
Claim that $ \E_k^{0, 1}\br{\gamma z} = \E_k^{0, 1}\br{z} $ for $ \gamma \in \Gamma\br{N} $. Let $ \gamma = \twobytwosmall{a}{b}{c}{d} \in \Gamma\br{N} $. Then
\begin{align*}
\E_k^{0, 1}\br{\gamma z}
& = \sum_{\br{m, n} \in S^{0, 1}} \dfrac{1}{\br{m\br{\tfrac{az + b}{cz + d}} + n}^k}
= \br{cz + d}^k\sum_{\br{m, n} \in S^{0, 1}} \dfrac{1}{\br{m\br{az + b} + n\br{cz + d}}^k} \\
& = \br{cz + d}^k\sum_{\br{m, n} \in S^{0, 1}} \dfrac{1}{\br{\br{ma + nc}z + \br{mb + nd}}^k}.
\end{align*}
Since $ m \equiv a \equiv d \equiv 1 \mod N $ and $ n \equiv b \equiv c \equiv 0 \mod N $, $ ma + nc \equiv 1 \mod N $ and $ mb + nd \equiv 0 \mod N $, so $ \br{ma + nc, mb + nd} \in S^{0, 1} $. Moreover, the map
$$ \bijection{S^{0, 1}}{S^{0, 1}}{\br{m, n}}{\br{ma + nc, mb + nd}}{\br{m'a' + n'c', m'b' + n'd'}}{\br{m', n'}} $$
is a bijection, where $ \gamma^{-1} = \twobytwosmall{a'}{b'}{c'}{d'} $. So $ \E_k^{0, 1}\br{\gamma z} = \E_k^{0, 1}\br{z}\br{cz + d}^k $.
\end{example*}

\lecture{23}{Friday}{22/11/19}

Every congruence subgroup is conjugate to a subgroup of $ \SL_2\br{\ZZ} $, and $ \twobytwosmall{1}{1}{0}{1} \in \SL_2\br{\ZZ} $ need not be in $ \Gamma $. On the other hand, if $ \Gamma \subseteq \SL_2\br{\ZZ} $, then $ \Gamma $ has finite index in $ \SL_2\br{\ZZ} $, so there exists a minimal $ \n_\Gamma > 0 $ such that $ \twobytwosmall{1}{\n_\Gamma}{0}{1} \in \Gamma $. Then if $ f $ is weakly modular of weight $ k $ and level $ \Gamma $, know $ f\br{z + \n_\Gamma} = f\br{z} $ for all $ z $, so $ f $ is a function of $ q^{1 / \n_\Gamma} $. Let $ g\br{q^{1 / \n_\Gamma}} $ be a function on $ \DD \setminus \cbr{0} $ such that $ f\br{z} = g\br{e^{2\pi iz / \n_\Gamma}} $. Then if $ g $ is meromorphic on $ \DD $, can express $ g $ as a Laurent series in $ q^{1 / \n_\Gamma} $. We say $ f $ is \textbf{meromorphic at $ \infty $}, and the series for $ q $ is its \textbf{$ q $-expansion}.

\begin{example*}
\hfill
\begin{itemize}
\item For $ \Gamma = \Gamma_0\br{N} $ or $ \Gamma = \Gamma_1\br{N} $, $ \n_\Gamma = 1 $.
\item For $ \Gamma = \Gamma\br{N} $, $ \n_\Gamma = N $.
\end{itemize}
\end{example*}

\subsubsection{A fundamental domain}

A question is for $ \Gamma \subseteq \SL_2\br{\ZZ} $, can we write down a fundamental domain for $ \Gamma $? For all $ z \in \HH $, there exists $ \gamma \in \SL_2\br{\ZZ} $ such that $ \gamma z \in \DDD $. For $ \Gamma \subseteq \SL_2\br{\ZZ} $, write
$$ \SL_2\br{\ZZ} = \bigsqcup_{\gamma_i \in \SL_2\br{\ZZ}} \pm\gamma_i \cdot \Gamma. $$

\pagebreak

Set
$$ \DDD_\Gamma = \bigcup_i \gamma_i^{-1} \cdot \DDD. $$

\begin{theorem}
\hfill
\begin{enumerate}
\item For all $ z \in \HH $, there exists $ \gamma \in \Gamma $ such that $ \gamma z \in \DDD_\Gamma $.
\item The subset $ \cbr{z \in \DDD_\Gamma \st \Gamma \cdot z \cap \DDD_\Gamma \ne \cbr{z}} $ is contained in $ \bigcup_{\gamma_i \in \SL_2\br{\ZZ}} \gamma_i \cdot \partial\DDD $, the boundary of $ \DDD $, so has measure zero.
\end{enumerate}
That is, $ \DDD_\Gamma $ is a fundamental domain for $ \Gamma $.
\end{theorem}

\begin{proof}
\hfill
\begin{enumerate}
\item Fix $ z \in \HH $. There exists $ \gamma \in \SL_2\br{\ZZ} $ such that $ \gamma z \in \DDD $. Can write $ \gamma $ as $ \pm\gamma_i\gamma' $ for some $ i $ and $ \gamma' \in \Gamma $. Then $ \pm\gamma_i\gamma'z \in \DDD $, so $ \gamma_i\gamma'z \in \DDD $, so $ \gamma'z \in \gamma_i^{-1}\DDD \subseteq \DDD_\Gamma $.
\item Let $ z \in \bigcup_i \gamma_i^{-1} \cdot \mathring{\DDD} $. Want $ \Gamma \cdot z \cap \DDD_\Gamma = \cbr{z} $. Suppose $ \gamma z \in \DDD_\Gamma $ for $ \gamma \in \Gamma $. There exist $ i $ and $ j $ such that $ z \in \gamma_i^{-1} \cdot \mathring{\DDD} $ and $ \gamma z \in \gamma_j^{-1} \cdot \mathring{\DDD} $, so $ \gamma_iz, \gamma_j\gamma z \in \mathring{\DDD} $. So $ \gamma_iz = \gamma_j\gamma z $ so $ \gamma^{-1}\gamma_j^{-1}\gamma_iz = z $. Then $ \Stab_z = \pm\id_2 $, so $ \gamma_i = \pm\gamma_j\gamma $. Since $ \SL_2\br{\ZZ} = \bigsqcup_i \pm\gamma_i \cdot \Gamma $, this is only possible if $ i = j $. Then $ \gamma_i = \pm\gamma_i\gamma $, so $ \gamma = \pm\id_2 $. So $ z = \gamma z $.
\end{enumerate}
\end{proof}

\begin{example*}
$ \Gamma = \Gamma_0\br{2} $ has index three in $ \SL_2\br{\ZZ} $. The coset representatives are
$$ \id_2 = \twobytwo{1}{0}{0}{1} : z \mapsto z, \qquad \S = \twobytwo{0}{-1}{1}{0} : z \mapsto -\dfrac{1}{z}, \qquad \S\T = \twobytwo{0}{-1}{1}{1} : z \mapsto -\dfrac{1}{z + 1}, $$
so
$$
\begin{tikzpicture}[scale=2]
\draw [dotted, thick] (-3, 0) to (3, 0);
\draw [dotted, thick] (0, 0) to (0, 2);
\draw [dashed] (-2, 0) arc (180:0:1);
\draw [dashed] (-1, 0) arc (180:0:1);
\draw [dashed] (0, 0) arc (180:0:1);
\draw [dashed] (-0.7, 0) arc (180:0:0.35);
\draw [dashed] (-0.35, 0) arc (180:0:0.35);
\draw [dashed] (0, 0) arc (180:0:0.35);
\draw [dashed] (-0.5, 0) to (-0.5, 2);
\draw [dashed] (0.5, 0) to (0.5, 2);
\draw (0, 0) arc (0:120:0.35);
\draw (0, 0) arc (180:120:1);
\draw (-0.5, 0.3) to (-0.5, 2);
\draw (0.5, 0.866) to (0.5, 2);
\end{tikzpicture}.
$$
\end{example*}

A question is for a given $ \Gamma $ and $ \DDD_\Gamma $, what are the ways to escape to $ \infty $ in $ \DDD_\Gamma $? Let $ \Gamma \subseteq \SL_2\br{\ZZ} $ be a congruence subgroup. Then
$$ \SL_2\br{\ZZ} \cdot \infty = \cbr{\twobytwo{a}{b}{c}{d} \cdot \infty} = \cbr{\dfrac{a}{c} \st \twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ}} = \QQ \cup \cbr{\infty}. $$

\begin{definition}
The set of \textbf{cusps} for $ \Gamma $ is the set of $ \Gamma $-orbits on $ \QQ \cup \cbr{\infty} $.
\end{definition}

\begin{note*}
If $ \SL_2\br{\ZZ} = \bigsqcup_i \pm\gamma_i \cdot \Gamma $, then $ \cbr{\gamma_i^{-1} \cdot \infty} $ is a set of representatives for the $ \Gamma $-orbits on $ \QQ \cup \cbr{\infty} $.
\end{note*}

\begin{example*}
Let $ \Gamma = \Gamma_0\br{p} $ for $ p $ prime. Then
$$ \Gamma \cdot \infty = \cbr{\dfrac{a}{pc} \st \br{a, pc} = 1} \cup \cbr{\infty}, \qquad \Gamma \cdot 0 = \cbr{\dfrac{b}{d} \st d \nmid p}. $$
\end{example*}

\begin{definition}
A weakly modular form $ f $ of weight $ k $ and level $ \Gamma $ is \textbf{holomorphic or meromorphic at all cusps} if for all $ \gamma \in \Gamma $, $ \eval{f}_{k, \gamma} $ is holomorphic or meromorphic at $ \infty $.
\end{definition}

\begin{note*}
Since $ \eval{f}_{k, \gamma} = f $ for $ \gamma \in \Gamma $, it suffices to check on a set of coset representatives for $ \Gamma $ in $ \SL_2\br{\ZZ} $.
\end{note*}

\begin{definition}
A \textbf{modular form of weight $ k $ and level $ \Gamma $} is a weakly modular form of weight $ k $ and level $ \Gamma $ that is holomorphic on $ \HH $ and at all cusps.
\end{definition}

\pagebreak

\subsection{Spaces of modular forms}

\subsubsection{The space of holomorphic modular forms}

\lecture{24}{Monday}{25/11/19}

Let
$$ \M_k\br{\Gamma} = \cbr{\text{holomorphic modular forms of weight} \ k \ \text{and level} \ \Gamma}, $$
$$ \S_k\br{\Gamma} = \cbr{f \in \M_k\br{\Gamma} \st f \ \text{vanishes at all cusps}}. $$

\begin{note*}
For any $ \gamma \in \GL_2\br{\QQ}_+ $, if $ f \in \M_k\br{\Gamma} $, then $ \eval{f}_{k, \gamma} \in \M_k\br{\gamma^{-1}\Gamma\gamma} $. If we consider the $ \CC $-vector space $ \widetilde{\M_k} = \bigcup_\Gamma \M_k\br{\Gamma} $, then $ \gamma $ acts on $ \widetilde{\M_k} $ by $ \gamma \cdot f = \eval{f}_{k, \gamma} $. In fact, $ \GL_2\br{\QQ}_+ \subseteq \GL_2\br{\AA_\QQ^{\fin}} $ and the action extends to this larger group. If we enlarge $ \widetilde{\M_k} $ in a suitable way, the correct group that acts is $ \GL_2\br{\AA_\QQ} $.
\end{note*}

A question is what can we say about $ \dim_\CC \M_k\br{\Gamma} $? Assume $ \Gamma \subseteq \SL_2\br{\ZZ} $, and fix $ f \in \M_k\br{\Gamma} $. Write
$$ \SL_2\br{\ZZ} = \bigsqcup_{j = 1}^d \Gamma \cdot \alpha_j, \qquad g = \prod_{j = 1}^d \eval{f}_{k, \alpha_j}, \qquad d = \sbr{\SL_2\br{\ZZ} : \Gamma}. $$

\begin{proposition}
\hfill
\begin{enumerate}
\item $ g $ is independent of the choice of $ \alpha_i $.
\item $ g \in \M_{kd} $.
\end{enumerate}
\end{proposition}

\begin{proof}
\hfill
\begin{enumerate}
\item Suppose I replace $ \alpha_j' $ such that $ \Gamma \cdot \alpha_j = \Gamma \cdot \alpha_j' $. Then there exists $ \gamma \in \Gamma $ such that $ \gamma\alpha_j = \alpha_j' $, so $ \eval{f}_{k, \alpha_j'} = \eval{\br{\eval{f}_{k, \gamma}}}_{k, \alpha_j} = \eval{f}_{k, \alpha_j} $. So the product defining $ g $ does not change.
\item For $ \alpha \in \SL_2\br{\ZZ} $, $ \eval{g}_{kd, \alpha} = \prod_{j = 1}^d \eval{\br{\eval{f}_{k, \alpha_j}}}_{k, \alpha} = \prod_{j = 1}^d \eval{f}_{k, \alpha_j\alpha} $. Since $ \SL_2\br{\ZZ} = \bigsqcup_{j = 1}^d \Gamma \cdot \alpha_j $, $ \SL_2\br{\ZZ} = \SL_2\br{\ZZ} \cdot \alpha = \bigsqcup_{j = 1}^d \Gamma \cdot \alpha_j\alpha $. So the elements $ \alpha_i\alpha $ are another set of coset representatives for $ \Gamma $ in $ \SL_2\br{\ZZ} $. Since $ g $ was independent of the choice of representatives, $ \eval{g}_{kd, \alpha} = g $.
\end{enumerate}
\end{proof}

Have
$$ \sum_{p \in \SL_2\br{\ZZ} \backslash \br{\HH \cup \QQ \cup \cbr{\infty}}} \dfrac{1}{e_p}\ord_p g = \dfrac{kd}{12}, \qquad e_p =
\begin{cases}
\dfrac{1}{2}\#\Stab_p \in \cbr{1, 2, 3} & p \in \HH \\
1 & p \in \QQ \cup \cbr{\infty}
\end{cases},
$$
so
$$ \dfrac{kd}{12} = \sum_{p \in \SL_2\br{\ZZ} \backslash \br{\HH \cup \QQ \cup \cbr{\infty}}} \dfrac{1}{e_p}\sum_{j = 1}^d \ord_p \eval{f}_{k, \alpha_j} = \sum_{p \in \SL_2\br{\ZZ} \backslash \br{\HH \cup \QQ \cup \cbr{\infty}}} \dfrac{1}{e_p}\sum_{j = 1}^d \ord_{\alpha_jp} f. $$
As $ p $ runs over a set of representatives for $ \SL_2\br{\ZZ} $-orbits, and $ \alpha_j $ runs over the coset representatives for $ \Gamma $ in $ \SL_2\br{\ZZ} $, $ q = \alpha_jp $ runs over the representatives for $ \Gamma $-orbits, so
$$ \sum_{q \in \Gamma \backslash \br{\HH \cup \QQ \cup \cbr{\infty}}} \dfrac{n_q}{e_q}\ord_q f = \dfrac{kd}{12}, \qquad n_q = \#\cbr{j \st \alpha_jq \in \Gamma \cdot q} \ge 1. $$

\begin{corollary}
If $ \ord_\infty f \ge kd / 12n_\infty + 1 $ for $ f \in \M_k\br{\Gamma} $, then $ f = 0 $.
\end{corollary}

Then
\begin{align*}
n_\infty
& = \#\cbr{j \st \alpha_j\infty \in \Gamma \cdot \infty}
= \#\cbr{j \st \exists \gamma \in \Gamma, \ \alpha_j\infty
= \gamma\infty} = \#\cbr{j \st \exists \gamma \in \Gamma, \ \alpha_j^{-1}\gamma \in \Stab_\infty} \\
& = \#\cbr{j \st \alpha_j^{-1} \cdot \Gamma \subseteq \Stab_\infty \cdot \Gamma}
= \#\br{\Stab_\infty \cdot \Gamma / \Gamma}
= \#\br{\Stab_\infty / \br{\Stab_\infty \cap \Gamma}}
= \n_\Gamma,
\end{align*}
since $ \Stab_\infty = \cbr{\twobytwosmall{1}{b}{0}{1} \st b \in \ZZ} $. Since $ f $ is a power series in $ q^{1 / \n_\Gamma} $, and $ f $ is determined by its terms of order at most $ kd / 12\n_\Gamma $, $ f $ is determined by the first $ 1 + kd / 12 $ terms of its $ q $-expansion, so
$$ \dim_\CC \M_k\br{\Gamma} \le 1 + \dfrac{kd}{12}. $$

\pagebreak

\subsubsection{The space of meromorphic modular forms}

\lecture{25}{Friday}{29/11/19}

Let $ \Gamma \subseteq \SL_2\br{\ZZ} $ be a congruence subgroup. Let $ \F\br{\Gamma} $ be the field of meromorphic modular forms of weight zero and level $ \Gamma $, and let $ \F_N = \F\br{\Gamma\br{N}} $, so $ \F_1 = \F\br{\SL_2\br{\ZZ}} = \CC\br{\j} $. If $ M \mid N $, then $ \Gamma\br{N} \subseteq \Gamma\br{M} $, so $ \F_M \subseteq \F_N $. Then $ \SL_2\br{\ZZ} $ normalises $ \Gamma\br{N} $ so if $ f \in \F_N $, then $ \eval{f}_{0, \alpha} $ is modular for $ \alpha^{-1}\Gamma\br{N}\alpha = \Gamma\br{N} $ if $ \alpha \in \SL_2\br{\ZZ} $.

\begin{note*}
$ \eval{\br{fg}}_{0, \alpha} = \eval{f}_{0, \alpha} \cdot \eval{g}_{0, \alpha} $ and $ \eval{\br{f + g}}_{0, \alpha} = \eval{f}_{0, \alpha} + \eval{g}_{0, \alpha} $.
\end{note*}

Then $ \alpha \in \SL_2\br{\ZZ} $ gives an automorphism of $ \F_N $ fixing $ \F_1 $. Get an action of $ \SL_2\br{\ZZ} / \Gamma\br{N} $ on $ \F_N $ by field automorphisms and $ \F_1 $ is the fixed field.

\begin{theorem}[Galois theory]
Let $ F $ be a field and $ G $ a finite group acting faithfully on $ F $ by automorphisms, that is no $ g \in G $ acts on $ F $ as $ \id $ except $ g = \id_G $. Then $ F $ is a Galois extension of
$$ F^G = \cbr{x \in F \st \forall g \in G, \ gx = x}, $$
with Galois group $ G $. In particular $ \sbr{F : F^G} = \#G $.
\end{theorem}

\begin{proposition}
$ \SL_2\br{\ZZ} / \Gamma\br{N} \cong \SL_2\br{\ZZ / N\ZZ} $ acts faithfully on $ \F_N $.
\end{proposition}

\begin{proof}
Use dimension formulae for $ \M_k\br{\Gamma} $ to show that for $ k \gg 0 $ even, $ \dim \M_k\br{\Gamma\br{N}} > \dim \M_k\br{\Gamma} $ for $ \Gamma \supsetneq \Gamma\br{N} $, so there exists $ f \in \M_k\br{\Gamma\br{N}} $ such that the only elements of $ \SL_2\br{\ZZ} $ fixing $ f $ lie in $ \Gamma\br{N} $. Then $ f / \E_k $ lies in $ \F_N $ but not in $ \F\br{\Gamma} $ for $ \Gamma \supsetneq \Gamma\br{N} $. So $ f / \E_k $ is not fixed by non-trivial elements of $ \SL_2\br{\ZZ} / \Gamma\br{N} $.
\end{proof}

\begin{corollary}
$ \F_N / \F_1 $ is Galois with Galois group $ \SL_2\br{\ZZ / N\ZZ} $.
\end{corollary}

Then $ \F_N $ is a finite and algebraic extension of $ \CC\br{\j} $, of transcendence degree one over $ \CC $. For $ \Gamma $ arbitrary in $ \SL_2\br{\ZZ} $, $ \Gamma \supseteq \Gamma\br{N} $ for some $ N $, so $ \F\br{\Gamma} $ is the fixed field of $ \Gamma / \Gamma\br{N} $ in $ \F_N $. Then $ \F\br{\Gamma} / \F_1 $ is not Galois in general, but is algebraic of degree $ \sbr{\SL_2\br{\ZZ} : \Gamma} $.

\begin{proposition}
There exists a unique smooth and projective algebraic curve $ X\br{\Gamma} $ over $ \CC $, whose field of rational functions is $ \F\br{\Gamma} $.
\end{proposition}

\begin{proof}
Fix $ \Gamma $, and let $ f $ be a primitive element of $ \F\br{\Gamma} $, that is $ f $ generates $ \F\br{\Gamma} $ over $ \F_1 $. Consider the polynomial
$$ P\br{X} = \prod_{\SL_2\br{\ZZ} = \bigsqcup_j \Gamma \cdot \alpha_j} \br{X - \eval{f}_{0, \alpha_j}} = X^d + \dfrac{G_1\br{\j}}{H_1\br{\j}}X^{d - 1} + \dots + \dfrac{G_d\br{\j}}{H_d\br{\j}} \in \F_1\sbr{X}, \qquad G_i, H_i \in \CC\sbr{Y}. $$
Let
$$ Q\br{X, Y} = H_1\br{Y} \dots H_d\br{Y}\br{X^d + \dfrac{G_1\br{Y}}{H_1\br{Y}}X^{d - 1} + \dots + \dfrac{G_d\br{Y}}{H_d\br{Y}}} \in \CC\sbr{X, Y}. $$
Then $ Q\br{X, \j} = H_1\br{\j} \dots H_d\br{\j} \cdot P\br{X} $. Since $ P\br{f} = 0 $, $ Q\br{f, \j} = 0 $. Consider the map
$$ \function[\phi]{\HH}{\CC^2}{z}{\br{f\br{z}, \j\br{z}}}. $$
The image is contained in the zero locus of $ Q\br{X, Y} $, and factors through $ \Gamma \backslash \HH $. The following are some issues.
\begin{itemize}
\item This map is not necessarily defined everywhere. To fix, replace $ \CC^2 $ with $ \CC\PP^2 $. Then $ \phi $ extends to $ \Gamma \backslash \br{\HH \cup \QQ \cup \cbr{\infty}} \to \CC\PP^2 $.
\item This map is not necessarily injective on $ \Gamma \backslash \br{\HH \cup \QQ \cup \cbr{\infty}} $, but will be generically injective since $ f $ is primitive.
\item This image might be singular. There are standard ways to fix, such as normalisation. When these are fixed, the map becomes injective.
\end{itemize}
The upshot is to get a complex algebraic curve $ X\br{\Gamma} $ whose function field is $ \F\br{\Gamma} $, whose complex points are in bijection with $ \Gamma \backslash \br{\HH \cup \QQ \cup \cbr{\infty}} $.
\end{proof}

$ \M_k\br{\Gamma} $ is the space of sections of certain line bundles on $ X\br{\Gamma} $.

\pagebreak

\subsection{Hecke operators}

\lecture{26}{Friday}{29/11/19}

Let $ f \in \M_k\br{\Gamma} $.
\begin{enumerate}
\item If $ \Gamma' \subseteq \Gamma $, then $ f \in \M_k\br{\Gamma'} $.
\item If $ \alpha \in \GL_2\br{\QQ}_+ $, then $ \eval{f}_{k, \alpha} \in \M_k\br{\alpha^{-1}\Gamma\alpha} $.
\item If $ \Gamma \subseteq \Gamma' $, can write $ \Gamma' = \bigsqcup_{i = 1}^d \Gamma \cdot \alpha_i $, then $ \sum_{i = 1}^d \eval{f}_{k, \alpha_i} $ is independent of choices and lives in $ \M_k\br{\Gamma'} $.
\end{enumerate}
The rough idea is given $ f \in \M_k\br{\Gamma} $ and $ \Gamma' \supseteq \alpha^{-1}\Gamma\alpha $, act on it by $ \alpha $ to get a modular form of level $ \alpha^{-1}\Gamma\alpha $, using $ 2 $, and average to get a modular form of level $ \Gamma' $, using $ 3 $. Recall that if $ H, K \le G $ and $ g \in G $, then the \textbf{double coset} is
$$ HgK = \cbr{hgk \st h \in H, \ k \in K}. $$
That is, the orbit of $ G $ under the action of $ HxK $ on $ G $ such that $ \br{h, k} \cdot g = hgk^{-1} $.

\begin{definition}
Let $ f \in \M_k\br{\Gamma} $, let $ \alpha \in \GL_2\br{\QQ}_+ $, and let $ \Gamma' $ be a congruence subgroup. Then
$$ \eval{f}_{k, \Gamma\alpha\Gamma'} = \sum_{i = 1}^d \eval{f}_{k, \alpha_i}, \qquad \Gamma\alpha\Gamma' = \bigsqcup_{i = 1}^d \Gamma\alpha_i. $$
\end{definition}

The idea is that the $ \alpha_i $ are of the form $ \alpha\beta_i $ where $ \beta_i $ are a set of coset representatives for $ \alpha^{-1}\Gamma\alpha \cap \Gamma' $ in $ \Gamma' $, by the coursework, so
$$ \sum_{i = 1}^d \eval{f}_{k, \alpha_i} = \sum_{i = 1}^d \eval{\br{\eval{f}_{k, \alpha}}}_{k, \beta_i}, $$
where
\begin{itemize}
\item acting by $ \alpha $ gets $ \eval{f}_{k, \alpha} $ modular of level $ \alpha^{-1}\Gamma\alpha $,
\item so also modular of level $ \alpha^{-1}\Gamma\alpha \cap \Gamma $, and
\item averaging gets $ \eval{f}_{k, \Gamma\alpha\Gamma'} $ modular of level $ \Gamma' $.
\end{itemize}
So the double coset $ \Gamma\alpha\Gamma' $ gives a map between $ \M_k\br{\Gamma} $ and $ \M_k\br{\Gamma'} $.

\subsubsection{Hecke operators}

Recall that
$$ \Gamma_1\br{N} = \cbr{\twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ} \st a \equiv d \equiv 1 \mod N, \ c \equiv 0 \mod N}. $$

\begin{definition}
For a prime $ p \nmid N $, define
$$ \function[\T_p]{\M_k\br{\Gamma_1\br{N}}}{\M_k\br{\Gamma_1\br{N}}}{f}{\eval{f}_{k, \Gamma_1\br{N}\twobytwosmall{1}{0}{0}{p}\Gamma_1\br{N}}}. $$
\end{definition}

Recall that for $ \SL_2\br{\ZZ} $ we set
$$ \T_pf = p^{k - 1}\sum_{\twobytwosmall{a}{b}{0}{d} \in \S^p} d^{-k}f\br{\dfrac{az + b}{d}} = \sum_{\twobytwosmall{a}{b}{0}{d} \in \S^p} \eval{f}_{k, \twobytwosmall{a}{b}{0}{d}}. $$
To show this agrees with our new definition, we need that
$$ \SL_2\br{\ZZ}\twobytwo{1}{0}{0}{p}\SL_2\br{\ZZ} = \bigsqcup_{\twobytwosmall{a}{b}{0}{d} \in \S^p} \SL_2\br{\ZZ}\twobytwo{a}{b}{0}{d}. $$

\begin{itemize}
\item For the reverse containment, it suffices to show $ \twobytwosmall{a}{b}{0}{d} \in \S^p $ lies in $ \SL_2\br{\ZZ}\twobytwosmall{1}{0}{0}{p}\SL_2\br{\ZZ} $, and
$$ \twobytwo{p}{0}{0}{1} = \twobytwo{0}{1}{-1}{0}\twobytwo{1}{0}{0}{p}\twobytwo{0}{-1}{1}{0}, \qquad \twobytwo{1}{b}{0}{p} = \twobytwo{1}{0}{0}{1}\twobytwo{1}{0}{0}{p}\twobytwo{1}{b}{0}{1}, $$
where $ \twobytwosmall{0}{1}{-1}{0}, \twobytwosmall{0}{-1}{1}{0}, \twobytwosmall{1}{0}{0}{1}, \twobytwosmall{1}{b}{0}{1} \in \SL_2\br{\ZZ} $.

\pagebreak

\item For disjointness, if $ \SL_2\br{\ZZ}\twobytwosmall{a}{b}{0}{d} = \SL_2\br{\ZZ}\twobytwosmall{a'}{b'}{0}{d'} $ for $ \twobytwosmall{a}{b}{0}{d}, \twobytwosmall{a'}{b'}{0}{d'} \in \S^p $, then $ \twobytwosmall{a}{b}{0}{d}\twobytwosmall{a'}{b'}{0}{d'}^{-1} \in \SL_2\br{\ZZ} $, so $ a = a' $ and $ d = d' $. If $ a = p $, then $ d = 1 $ and $ b = 0 $, and the same holds for $ b' $, so equal. If $ a = 1 $, have
$$ \twobytwo{1}{\tfrac{b - b'}{p}}{0}{1} = \twobytwo{1}{b}{0}{p}\twobytwo{1}{b'}{0}{p}^{-1} \in \SL_2\br{\ZZ}, $$
so $ p \mid b - b' $. Since $ 0 \le b, b' < p $, $ b = b' $.
\item It remains to show that $ \SL_2\br{\ZZ}\twobytwosmall{1}{0}{0}{p}\SL_2\br{\ZZ} $ is the union of $ p + 1 $ left cosets. By the coursework,
\begin{align*}
\#\cbr{\text{cosets}}
& = \#\SL_2\br{\ZZ} / \br{\twobytwo{1}{0}{0}{p}^{-1}\SL_2\br{\ZZ}\twobytwo{1}{0}{0}{p} \cap \SL_2\br{\ZZ}}
= \#\SL_2\br{\ZZ} / \Gamma_0\br{p} \\
& = \sbr{\SL_2\br{\ZZ} : \Gamma_0\br{p}}
= \sbr{\SL_2\br{\ZZ / p\ZZ} : \text{upper triangular matrices modulo} \ p}.
\end{align*}
For upper triangular matrices $ \twobytwosmall{a}{b}{0}{a^{-1}} $ of determinant one modulo $ p $, there are $ p\br{p - 1} $ possibilities. For $ \SL_2\br{\ZZ / p\ZZ} $, there are $ p^2 - 1 $ possibilities for the first row, the second row cannot be a multiple of the first row, so there are $ p^2 - p $ possibilities, and to get determinant one need to rescale the second row, so there are $ p $ possibilities left over, so $ \#\SL_2\br{\ZZ / p\ZZ} = p\br{p^2 - 1} $. Thus the index is $ p\br{p^2 - 1} / p\br{p - 1} = p + 1 $.
\end{itemize}
Extending from $ \T_p $ to $ \T_n $ for $ \br{n, N} = 1 $, we set
$$ \function[\T_n]{\M_k\br{\Gamma_1\br{N}}}{\M_k\br{\Gamma_1\br{N}}}{f}{\sum_{ad = n, \ a \mid d} \eval{f}_{k, \Gamma_1\br{N}\twobytwosmall{a}{0}{0}{d}\Gamma_1\br{N}}}. $$

\subsubsection{Diamond operators}

\lecture{27}{Monday}{02/12/19}

Recall that
$$ \Gamma_1\br{N} \subseteq \Gamma_0\br{N} = \cbr{\twobytwo{a}{b}{c}{d} \in \SL_2\br{\ZZ} \st c \equiv 0 \mod N}. $$
Have a surjection
$$ \function{\Gamma_0\br{N}}{\br{\ZZ / N\ZZ}^\times}{\twobytwo{a}{b}{c}{d}}{d}, $$
where the kernel is $ \Gamma_1\br{N} $. So $ \Gamma_0\br{N} / \Gamma_1\br{N} \cong \br{\ZZ / N\ZZ}^\times $.

\begin{note*}
If $ f \in \M_k\br{\Gamma_1\br{N}} $ and $ \alpha \in \Gamma_0\br{N} $, then $ \eval{f}_{k, \alpha} $ is modular of level $ \alpha^{-1}\Gamma_1\br{N}\alpha = \Gamma_1\br{N} $. Moreover $ \eval{f}_{k, \alpha} $ depends only on the class of $ \alpha \in \Gamma_0\br{N} / \Gamma_1\br{N} $, that is only on the lower right entry of $ \alpha $.
\end{note*}

\begin{definition}
For $ d \in \ZZ $ such that $ \br{d, N} = 1 $, we define the \textbf{diamond operator}
$$ \function[\abr{d}]{\M_k\br{\Gamma_1\br{N}}}{\M_k\br{\Gamma_1\br{N}}}{f}{\eval{f}_{k, \alpha}}, $$
where $ \alpha \in \Gamma_0\br{N} $ with lower right entry congruent to $ d $ modulo $ N $.
\end{definition}

This defines an action of $ \br{\ZZ / N\ZZ}^\times \cong \Gamma_0\br{N} / \Gamma_1\br{N} $ on $ \M_k\br{\Gamma_1\br{N}} $. Since $ \abr{d}\abr{d'} = \abr{dd'} = \abr{d'}\abr{d} $, and operators of finite order on a $ \CC $-vector space are diagonalisable, $ \M_k\br{\Gamma_1\br{N}} $ splits as a direct sum of simultaneous eigenspaces for the $ \abr{d} $. Let $ V $ be one such eigenspace. Then for each $ d \in \br{\ZZ / N\ZZ}^\times $, there exists $ \chi\br{d} \in \CC^\times $ such that $ \abr{d}f = \chi\br{d}f $ for all $ f \in V $. Since $ \abr{d}\abr{d'} = \abr{dd'} $, $ \chi\br{d}\chi\br{d'} = \chi\br{dd'} $, so $ \chi $ is a homomorphism $ \br{\ZZ / N\ZZ}^\times \to \CC^\times $, that is a \textbf{character}.

\begin{definition}
For any character $ \chi : \br{\ZZ / N\ZZ}^\times \to \CC^\times $, let $ \M_k\br{\Gamma_1\br{N}, \chi} $ be the subspace of $ \M_k\br{\Gamma_1\br{N}} $ consisting of the forms $ f $ such that
$$ \abr{d}f = \chi\br{d}f, \qquad d \in \br{\ZZ / N\ZZ}^\times. $$
\end{definition}

A warning is that this might be zero.

\begin{example*}
If $ k $ is odd and $ \chi\br{-1} = 1 $, this space is zero.
\end{example*}

\pagebreak

We have a direct sum decomposition
$$ \M_k\br{\Gamma_1\br{N}} \cong \bigoplus_{\chi : \br{\ZZ / N\ZZ}^\times \to \CC} \M_k\br{\Gamma_1\br{N}, \chi}. $$

\begin{proposition}
Let $ \br{n, N} = 1 $ and $ f \in \M_k\br{\Gamma_1\br{N}, \chi} $ such that $ f = \sum_{m = 1}^\infty c_mq^m $. Then
$$ \T_nf = \sum_{m = 1}^\infty \gamma_mf, \qquad \gamma_m = \sum_{d \mid \br{n, m}} \chi\br{d}d^{k - 1}c_{\tfrac{nm}{d^2}}. $$
In particular, if $ \T_nf = \lambda_nf $ for some $ n $ with $ \br{n, N} = 1 $, then $ c_n = \lambda_nc_1 $.
\end{proposition}

\subsubsection{The Petersson inner product}

Fix $ \Gamma \subseteq \SL_2\br{\ZZ} $ a congruence subgroup.

\begin{definition}
For $ f, g \in \S_k\br{\Gamma} $ define the \textbf{Petersson inner product of weight $ k $ and level $ \Gamma $}
$$ \abr{f, g}_{k, \Gamma} = \dfrac{1}{\sbr{\SL_2\br{\ZZ} : \Gamma}}\iintd{\DDD_\Gamma}{f\br{z}\overline{g\br{z}}\dfrac{y^k}{y^2}}{x}{y}, $$
where $ \DDD_\Gamma $ is a fundamental domain for $ \Gamma $.
\end{definition}

\begin{note*}
The scaling factor ensures if $ \Gamma' \subseteq \Gamma $ and $ f, g \in \S_k\br{\Gamma} $, then $ \abr{f, g}_{k, \Gamma'} = \abr{f, g}_{k, \Gamma} $.
\end{note*}

\begin{proposition}
Let $ f \in \S_k\br{\Gamma} $ and $ g \in \S_k\br{\alpha^{-1}\Gamma\alpha} $ for $ \alpha \in \GL_2\br{\QQ}_+ $. Then
$$ \abr{\eval{f}_{k, \alpha}, g}_{k, \alpha^{-1}\Gamma\alpha} = \abr{f, \eval{g}_{k, \alpha'}}_{k, \Gamma}, \qquad \alpha' = \alpha^{-1}\det \alpha. $$
\end{proposition}

\begin{proof}
Let $ \alpha = \twobytwosmall{a}{b}{c}{d} $ and $ \alpha^{-1} = \twobytwosmall{a'}{b'}{c'}{d'} $. Set $ z' = \alpha z $ and $ C = \sbr{\SL_2\br{\ZZ} : \alpha^{-1}\Gamma\alpha} $. Have $ \br{cz + d}\br{c'z' + d'} = 1 $. Then
\begin{align*}
\abr{\eval{f}_{k, \alpha}, g}_{k, \alpha^{-1}\Gamma\alpha}
& = \dfrac{1}{C}\iintd{\alpha^{-1}\DDD_\Gamma}{\eval{f}_{k, \alpha}\br{z}\overline{g\br{z}}\dfrac{y^k}{y^2}}{x}{y} \\
& = \dfrac{1}{C}\iintd{\DDD_\Gamma}{\eval{f}_{k, \alpha}\br{\alpha^{-1}z'}\overline{g\br{\alpha^{-1}z'}}\dfrac{\det \alpha^{-k}y'^k\abs{cz + d}^{2k}}{y'^2}}{x'}{y'} \\
& = \dfrac{1}{C}\iintd{\DDD_\Gamma}{\det \alpha^{k - 1}f\br{z'}\br{cz + d}^{-k}\overline{g\br{\alpha^{-1}z'}}\det \alpha^{-k}\abs{cz + d}^{2k}\dfrac{y'^k}{y'^2}}{x'}{y'} \\
& = \dfrac{1}{C}\iintd{\DDD_\Gamma}{\det \alpha^{-1}f\br{z'}\overline{\br{cz + d}^k}\overline{g\br{\alpha^{-1}z'}}\dfrac{y'^k}{y'^2}}{x'}{y'} \\
& = \dfrac{1}{C}\iintd{\DDD_\Gamma}{\det \alpha^{-1}f\br{z'}\overline{\br{c'z' + d'}^{-k}}\br{\det \alpha^{-1}}^{1 - k}\overline{\eval{g}_{k, \alpha^{-1}}\br{z'}}\overline{\br{c'z' + d'}^k}\dfrac{y'^k}{y'^2}}{x'}{y'} \\
& = \dfrac{1}{C}\iintd{\DDD_\Gamma}{\det \alpha^{k - 2}f\br{z'}\overline{\eval{g}_{k, \alpha^{-1}}\br{z'}}\dfrac{y'^k}{y'^2}}{x'}{y'} \\
& = \det \alpha^{k - 2}\abr{f, \eval{g}_{k, \alpha^{-1}}}_{k, \Gamma}.
\end{align*}
Recall $ \alpha' = \alpha^{-1}\det \alpha $. Then
$$ \eval{g}_{k, \lambda\alpha}\br{z} = \det \lambda\alpha^{k - 1}g\br{\lambda\alpha z}\br{\lambda cz + \lambda d}^{-k} = \lambda^{2k - 2}\det \alpha^{k - 1}g\br{\alpha z}\br{cz + d}^{-k}\lambda^{-k} = \lambda^{k - 2}\eval{g}_{k, \alpha}\br{z}, $$
so $ \eval{g}_{k, \alpha'}\br{z} = \det \alpha^{k - 2}\eval{g}_{k, \alpha^{-1}}\br{z} $. Thus $ \abr{\eval{f}_{k, \alpha}, g}_{k, \alpha^{-1}\Gamma\alpha} = \abr{f, \eval{g}_{k, \alpha'}}_{k, \Gamma} $.
\end{proof}

\lecture{28}{Friday}{06/12/19}

Recall that
$$ \function[\T_p]{\S_k\br{\Gamma_1\br{N}}}{\S_k\br{\Gamma_1\br{N}}}{f}{\eval{f}_{k, \Gamma_1\br{N}\twobytwosmall{1}{0}{0}{p}\Gamma_1\br{N}} = \sum_i \eval{f}_{k, \alpha_i}}, \qquad \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_i \Gamma_1\br{N}\alpha_i. $$

\pagebreak

Suppose we can find $ \alpha_i $ such that
$$ \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_i \Gamma_1\br{N}\alpha_i, \qquad \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_i \alpha_i\Gamma_1\br{N}. $$
Applying the operation $ ' $ to the latter gives
$$ \Gamma_1\br{N}\twobytwo{p}{0}{0}{1}\Gamma_1\br{N} = \bigsqcup_i \Gamma_1\br{N}\alpha_i'. $$
If $ f, g \in \S_k\br{\Gamma_1\br{N}} $,
\begin{align*}
\abr{\T_pf, g}_{k, \Gamma_1\br{N}}
& = \sum_i \abr{\eval{f}_{k, \alpha_i}, g}_{k, \Gamma}, \qquad \Gamma \subseteq \Gamma_1\br{N} \cap \bigcap_i \alpha_i^{-1}\Gamma_1\br{N}\alpha_i \cap \bigcap_i \alpha_i'^{-1}\Gamma_1\br{N}\alpha_i' \\
& = \sum_i \abr{f, \eval{g}_{k, \alpha_i'}}_{k, \Gamma}
= \abr{f, \eval{g}_{k, \Gamma_1\br{N}\twobytwosmall{p}{0}{0}{1}\Gamma_1\br{N}}}_{k, \Gamma}
= \abr{f, \eval{g}_{k, \Gamma_1\br{N}\twobytwosmall{p}{0}{0}{1}\Gamma_1\br{N}}}_{k, \Gamma_1\br{N}}.
\end{align*}
For $ \SL_2\br{\ZZ} $,
$$ \SL_2\br{\ZZ}\twobytwo{p}{0}{0}{1}\SL_2\br{\ZZ} = \SL_2\br{\ZZ}\twobytwo{0}{1}{-1}{0}\twobytwo{p}{0}{0}{1}\twobytwo{0}{-1}{1}{0}\SL_2\br{\ZZ} = \SL_2\br{\ZZ}\twobytwo{1}{0}{0}{p}\SL_2\br{\ZZ}, $$
so
$$ \abr{\T_pf, g}_{k, \SL_2\br{\ZZ}} = \abr{f, \T_pg}_{k, \SL_2\br{\ZZ}}, \qquad f, g \in \S_k\br{\SL_2\br{\ZZ}}, $$
which is Theorem \ref{thm:innerproduct}. In general,
$$ \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \T_p\abr{p}. $$
Will not prove, so see Diamond and Shurman chapter $ 5 $. This argument depends on finding $ \alpha_i $ such that
$$ \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_i \Gamma_1\br{N}\alpha_i = \bigsqcup_i \alpha_i\Gamma_1\br{N}. $$

\begin{lemma}
Such $ \alpha_i $ exist.
\end{lemma}

\begin{proof}
This is Diamond and Shurman $ 5.5.1 $(c). Write
$$ \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_{i = 1}^r \Gamma_1\br{N}\gamma_i = \bigsqcup_{j = 1}^r \widetilde{\gamma_j}\Gamma_1\br{N}. $$
Claim that for all $ 1 \le i \le r $, $ \Gamma_1\br{N}\gamma_i \cap \widetilde{\gamma_i}\Gamma_1\br{N} \ne \emptyset $. Suppose otherwise. Then $ \Gamma_1\br{N}\gamma_i \subseteq \bigsqcup_{j \ne i} \widetilde{\gamma_j}\Gamma_1\br{N} $. The right hand side is stable under right multiplication by $ \Gamma_1\br{N} $, so
$$ \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \Gamma_1\br{N}\gamma_i\Gamma_1\br{N} = \bigcup_{\beta \in \Gamma_1\br{N}} \Gamma_1\br{N}\gamma_i\beta \subseteq \bigsqcup_{j \ne i} \widetilde{\gamma_j}\Gamma_1\br{N}. $$
This is impossible since $ \widetilde{\gamma_i} $ is in the left hand side but not the right hand side. For all $ i $, choose $ \alpha_i $ such that $ \alpha_i \in \Gamma_1\br{N}\gamma_i \cap \widetilde{\gamma_i}\Gamma_1\br{N} $, so $ \Gamma_1\br{N}\alpha_i = \Gamma_1\br{N}\gamma_i $ and $ \alpha_i\Gamma_1\br{N} = \widetilde{\gamma_i}\Gamma_1\br{N} $. Now,
$$ \bigsqcup_{i = 1}^r \Gamma_1\br{N}\alpha_i = \bigsqcup_{i = 1}^r \Gamma_1\br{N}\gamma_i = \Gamma_1\br{N}\twobytwo{1}{0}{0}{p}\Gamma_1\br{N} = \bigsqcup_{i = 1}^r \widetilde{\gamma_i}\Gamma_1\br{N} = \bigsqcup_{i = 1}^r \alpha_i\Gamma_1\br{N}. $$
\end{proof}

The upshot is
$$ \abr{\T_pf, g}_{k, \Gamma_1\br{N}} = \abr{f, \abr{p}\T_pg}_{k, \Gamma_1\br{N}}, \qquad p \nmid N, \qquad f, g \in \S_k\br{\Gamma_1\br{N}}. $$
Check, such as by formulas on $ q $-expansions, that $ \T_p $ and $ \T_q $ commute for $ p, q \nmid N $ prime, and $ \T_p $ and $ \abr{d} $ commute. Thus $ \T_p $ commutes with its adjoint for all $ p $, so $ \T_p $ is diagonalisable on $ \S_k\br{\Gamma_1\br{N}} $.

\pagebreak

\subsection{\texorpdfstring{$ \L $}{L}-functions}

\subsubsection{Hecke \texorpdfstring{$ \L $}{L}-functions}

\begin{definition}
Let $ f = \sum_{n = 1}^\infty a_nq^n \in \S_k\br{\Gamma_1\br{N}} $. Then the \textbf{Hecke $ \L $-function of weight $ k $ and level $ \Gamma_1\br{N} $} is
$$ \L\br{s, f} = \sum_{n = 1}^\infty a_nn^{-s}. $$
\end{definition}

This is absolutely convergent for $ \Re s \gg 0 $, and has a meromorphic continuation and a functional equation. Set
$$ \R\br{s, f} = N^{\tfrac{s}{2}}\dfrac{\Gamma\br{s}}{\br{2\pi}^s}\L\br{s, f}. $$

\begin{note*}
$$ \twobytwo{0}{-1}{N}{0}^2 = \twobytwo{-N}{0}{0}{-N}, \qquad \twobytwo{0}{-1}{N}{0}\Gamma_1\br{N}\twobytwo{0}{-1}{N}{0} = \Gamma_1\br{N}. $$
\end{note*}

Set
$$ \function[\w_N]{\S_k\br{\Gamma_1\br{N}}}{\S_k\br{\Gamma_1\br{N}}}{f}{i^kN^{1 - \tfrac{k}{2}}\eval{f}_{k, \twobytwosmall{0}{-1}{N}{0}}}. $$
The constants are chosen so that $ \w_N^2 = \id $, the \textbf{Atkin-Lehner involution}. A warning is that this does not commute with $ \T_p $ and $ \abr{p} $. In fact $ \w_N\T_p\w_N = \abr{p}\T_p $ and $ \w_N\abr{p}\w_N = \abr{p}^{-1} $, and
$$ \R\br{s, f} = \R\br{k - s, \w_Nf}. $$
If $ f \in \S_k\br{\Gamma_1\br{N}, \chi} $ for $ \chi : \br{\ZZ / N\ZZ}^\times \to \CC^\times $ is an eigenform for all $ \T_p $ for $ p \nmid N $ and $ c_1 = 1 $, then using
$$ \T_pf = \sum_{n = 1}^\infty c_{np}q^n + \chi\br{p}c_nq^{np}, $$
if $ \T_pf = \lambda_pf = \sum_{n = 1}^\infty \gamma_nq^n $ for $ p \nmid N $, then
$$ \gamma_n =
\begin{cases}
c_{np} + \chi\br{p}p^{k - 1}c_{\tfrac{n}{p}} & p \mid n \\
c_{np} & p \nmid n
\end{cases}.
$$
The upshot is for $ p \nmid m $,
$$ c_{p^{k + 1}m} = \lambda_pc_{p^km} + \chi\br{p}p^{k - 1}c_{p^{k - 1}m}, \qquad k \ge 1, $$
so
$$ \L\br{s, f} = \prod_{p \nmid N} \dfrac{1}{1 - \lambda_pp^{-s} + \chi\br{p}p^{k - 1 - 2s}}\sum_{m \ \text{divisible only by primes} \ l \mid N} c_mm^{-s}. $$

\subsubsection{Oldforms and newforms}

\lecture{29}{Friday}{06/12/19}

Let $ p \nmid N $ and $ l \mid N $, and let
$$ \function[\U_l]{\S_k\br{\Gamma_1\br{N}}}{\S_k\br{\Gamma_1\br{N}}}{f}{\eval{f}_{k, \Gamma_1\br{N}\twobytwosmall{1}{0}{0}{l}\Gamma_1\br{N}}}. $$
On $ q $-expansions, if $ f = \sum_{n = 1}^\infty c_nq^n $, then $ \U_lf = \sum_{n = 1}^\infty c_{nl}q^n $. Then $ \U_l $ commutes with $ \T_p $ and $ \abr{d} $, by checking on $ q $-expansions. A problem is that $ \U_l $ are generally not self-adjoint or even normal. Let $ f = \sum_n c_nq^n \in \S_k\br{\Gamma_1\br{N}} $ be an eigenform for $ \T_p $ and $ \abr{d} $. Atkin-Lehner defined
$$ \function[\alpha_{N, l}]{\S_k\br{\Gamma_1\br{N}}}{\S_k\br{\Gamma_1\br{Nl}}}{f}{f}, \qquad \function[\beta_{N, l}]{\S_k\br{\Gamma_1\br{N}}}{\S_k\br{\Gamma_1\br{Nl}}}{f}{z \mapsto f\br{lz} = \sum_n c_nq^{nl}}. $$

\pagebreak

Then $ \beta $, a multiple of $ \eval{f}_{k, \twobytwosmall{l}{0}{0}{1}} $, is modular of weight $ k $ and level $ \twobytwosmall{l}{0}{0}{1}^{-1}\Gamma\br{N}\twobytwosmall{l}{0}{0}{1} \supseteq \Gamma_1\br{Nl} $. Check that $ \br{\T_p\beta_{N, l}}\br{f} = \beta_{N, l}\br{\T_pf} $, and similarly for $ \abr{d} $ for $ d \in \br{\ZZ / Nl\ZZ}^\times $. Check that $ \alpha_{N, l} $ and $ \beta_{N, l} $ commute with $ \T_p $, $ \abr{d} $ for $ d \in \br{\ZZ / Nl\ZZ}^\times $, and $ \U_p $ for $ p \mid N $ and $ l \ne p $. Then $ \U_l\br{\beta_{N, l}\br{f}} = f $ and $ \U_l\br{\alpha_{N, l}\br{f}} = \T_pf + p^k\chi\br{p}\beta_{N, l}\br{f} $, so the image of
$$ \function{\S_k\br{\Gamma_1\br{N}}^2}{\S_k\br{\Gamma_1\br{Nl}}}{\br{f, g}}{\alpha_{N, l}f + \beta_{N, l}g} $$
is stable under $ \T_p $, $ \abr{d} $, $ \U_p $, and $ \U_l $.

\begin{definition}
Define the \textbf{oldforms}
$$ \S_k\br{\Gamma_1\br{N}}^{\old} = \sum_{l \nmid N} \br{\alpha_{\tfrac{N}{l}, l}\br{\S_k\br{\Gamma_1\br{\dfrac{N}{l}}}} + \beta_{\tfrac{N}{l}, l}\br{\S_k\br{\Gamma_1\br{\dfrac{N}{l}}}}}, $$
which is stable under $ \T_p $, $ \abr{d} $, and $ \U_l $. Define
$$ \S_k\br{\Gamma_1\br{N}}^{\new} = \br{\S_k\br{\Gamma_1\br{N}}^{\old}}^\perp, $$
the orthogonal complement with respect to $ \abr{\cdot, \cdot}_{k, \Gamma_1\br{N}} $, which is stable under $ \T_p $ and $ \abr{d} $, and not a priori under $ \U_p $ for $ p \mid N $.
\end{definition}

\begin{theorem}[Atkin-Lehner 1979, strong multiplicity one]
Let $ 0 \ne f \in \S_k\br{\Gamma_1\br{N}}^{\new} $ and $ g \in \S_k\br{\Gamma_1\br{N}} $. Suppose for all $ p \nmid N $, there exist $ \lambda_p \in \CC $ and $ \chi : \br{\ZZ / N\ZZ}^\times \to \CC^\times $ such that
$$ \T_pf = \lambda_pf, \qquad \T_pg = \lambda_pg, \qquad \abr{d}f = \chi\br{d}f, \qquad \abr{d}g = \chi\br{d}g. $$
Then $ g $ is a scalar multiple of $ f $.
\end{theorem}

\begin{corollary}
$ \U_p $ for $ p \mid N $ preserves, and is diagonalisable on, $ \S_k\br{\Gamma_1\br{N}}^{\new} $.
\end{corollary}

\begin{corollary}
$ \S_k\br{\Gamma_1\br{N}}^{\new} $ breaks up as a direct sum of one-dimensional simultaneous eigenspaces for $ \T_p $, $ \U_l $, and $ \abr{d} $ for $ \br{d, N} = 1 $.
\end{corollary}

Let $ f = \sum_n c_nq^n $, so $ \U_lf = \sum_n c_{nl}q^n $, and $ \U_lf = \lambda_lf $ implies that $ c_{nl} = \lambda_lc_n $.

\begin{corollary}
If $ f \in \S_k\br{\Gamma_1\br{N}, \chi} $ is an eigenform for $ \T_p $ and $ \U_l $, then $ c_1 \ne 0 $.
\end{corollary}

\begin{definition}
A \textbf{newform} is an element of $ \S_k\br{\Gamma_1\br{N}}^{\new} $ with $ c_1 = 1 $, that is an eigenform for $ \T_p $, $ \U_l $, and $ \abr{d} $ for $ \br{d, N} = 1 $.
\end{definition}

Let $ f \in \S_k\br{\Gamma_1\br{N}, \chi} $ be a newform such that $ \T_pf = \lambda_pf $ and $ \U_lf = \lambda_lf $. Then
$$ \L\br{s, f} = \prod_{p \nmid N} \dfrac{1}{1 - \lambda_pp^{-s} + \chi\br{p}p^{k - 1 - 2s}}\prod_{l \mid N} \dfrac{1}{1 - \lambda_ll^{-s}}. $$

\subsection{Fermat's last theorem}

Let $ E / \QQ $ be an elliptic curve of conductor $ N $, and let
$$ a_p =
\begin{cases}
\#E\br{\FF_p} - p - 1 & p \nmid N \\
1 & E \ \text{has split multiplicative reduction modulo} \ p \\
-1 & E \ \text{has non-split multiplicative reduction modulo} \ p \\
0 & E \ \text{has additive reduction modulo} \ p
\end{cases}.
$$
Let
$$ \L\br{s, E} = \prod_{p \nmid N} \dfrac{1}{1 - a_pp^{-s} + p^{1 - 2s}}\prod_{l \mid N} \dfrac{1}{1 - a_ll^{-s}}. $$

\pagebreak

\begin{theorem}[Eichler-Shimura]
Let $ f \in \S_2\br{\Gamma_0\br{N}} $ be a newform with integer coefficients. There exists an elliptic curve $ E_f / \QQ $ of conductor $ N $ such that $ \L\br{s, f} = \L\br{s, E_f} $.
\end{theorem}

A question is that is the converse true?

\lecture{30}{Monday}{09/12/19}

\begin{theorem}[Eichler-Shimura, Deligne]
Let $ f \in \S_k\br{\Gamma_0\br{N}, \chi} $ be a newform for $ k \ge 2 $ such that $ \T_lf = a_lf $ for all $ l \nmid N $, and let $ p $ be a prime. There exists a unique homomorphism $ \overline{\rho_{f, p}} : \Gal\br{\overline{\QQ} / \QQ} \to \GL_2\br{\overline{\FF_p}} $ such that for all $ l \nmid N $, $ \overline{\rho_{f, p}} $ is unramified at $ l $, $ \Tr \overline{\rho_{f, p}}\br{\Frob_l} \equiv a_l \mod p $, and $ \det \overline{\rho_{f, p}}\br{\Frob_l} \equiv \chi\br{l}l^{k - 1} \mod p $.
\end{theorem}

\begin{example*}
If $ f \in \S_2\br{\Gamma_0\br{N}} $ has integer coefficients, then $ E_f\sbr{p}\br{\overline{\QQ}} \cong \br{\ZZ / p\ZZ}^2 $. Then $ \rho_{f, p} : \Gal\br{\overline{\QQ} / \QQ} \to \GL_2\br{\FF_p} $ gives an $ \FF_p $-linear action of $ \Gal\br{\overline{\QQ} / \QQ} $ on $ E_f\sbr{p}\br{\overline{\QQ}} $.
\end{example*}

A natural question is given $ \overline{\rho} : \Gal\br{\overline{\QQ} / \QQ} \to \GL_2\br{\overline{\FF_p}} $, is $ \overline{\rho} = \overline{\rho_{f, p}} $ for some newform $ f $? If so, for which $ \br{k, N, \chi} $?

\begin{theorem}[Serre's conjecture 1987 and Khare-Wintenberger theorem 2005]
Let $ \overline{\rho} : \Gal\br{\overline{\QQ} / \QQ} \to \GL_2\br{\FF_p} $ be odd, that is $ \det \overline{\rho}\br{i \mapsto -i} = -1 $.
\begin{itemize}
\item $ \overline{\rho} = \overline{\rho_{f, p}} $ for some newform $ f $.
\item Can take $ f $ of weight $ k_{\overline{\rho}} $, level $ N_{\overline{\rho}} $, and character $ \chi_{\overline{\rho}} $, where
\begin{itemize}
\item $ 2 \le k_{\overline{\rho}} \le p $,
\item $ \det \overline{\rho}\br{\Frob_l} \equiv \chi_{\overline{\rho}}\br{l}l^{k_{\overline{\rho}} - 1} \mod p $, and this condition determines $ k_{\overline{\rho}} $ modulo $ p - 1 $ and $ \chi_{\overline{\rho}} $,
\item $ N_{\overline{\rho}} $ is the so-called \textbf{Artin conductor} $ \N\br{\overline{\rho}} $ of $ \overline{\rho} $ usually, where
$$ \v_l\br{\N\br{\overline{\rho}}} =
\begin{cases}
0 & \overline{\rho} \ \text{is unramified at} \ l \\
1 & \overline{\rho}^{\I_l} \ \text{has dimension one} \\
\ge 2 & \text{otherwise}
\end{cases},
$$
\item if $ k_{\overline{\rho}} = 2 $,
$$ N_{\overline{\rho}} =
\begin{cases}
\dfrac{\N\br{\overline{\rho}}}{p} & \overline{\rho} \ \text{is finite at} \ p \\
\N\br{\overline{\rho}} & \overline{\rho} \ \text{is not finite at} \ p
\end{cases}.
$$
\end{itemize}
\end{itemize}
\end{theorem}

\begin{example*}
If $ \overline{\rho} $ comes from $ E / \QQ $, then $ k_{\overline{\rho}} = 2 $, $ \chi_{\overline{\rho}} $ is trivial, and $ N_{\overline{\rho}} \mid \N\br{E} $, where $ \N\br{E} = \prod_{l \ \text{bad for} \ E} p^{\v_l} $ is the \textbf{conductor} of $ E $, and
$$ \v_l\br{\N\br{E}} =
\begin{cases}
1 & E \ \text{has multiplicative reduction} \\
\ge 2 & E \ \text{has additive reduction}
\end{cases}.
$$
Moreover, if $ \v_l\br{\N\br{E}} = 1 $ and $ p \mid \ord_l \Delta_E $, then $ \v_l\br{N_{\overline{\rho}}} = 0 $.
\end{example*}

\begin{definition}[Frey 1985]
Suppose $ p \ge 5 $ and $ a^p + b^p = c^p $ for $ a, b, c $ coprime. Consider
$$ y^2 = x\br{x - a^p}\br{x + b^p}, $$
so $ \Delta = 2^s\br{abc}^p $.
\end{definition}

Then $ E_{a, b, c} $ has multiplicative reduction modulo $ l $ for all $ l $, so $ \N\br{E_{a, b, c}} = \rad 2abc $. Let $ \overline{\rho} : \Gal\br{\overline{\QQ} / \QQ} \to \GL_2\br{\FF_p} $ giving action of $ \Gal\br{\overline{\QQ} / \QQ} $ on $ E_{a, b, c}\sbr{p}\br{\overline{\QQ}} $. Then $ N_{\overline{\rho}} = 2 $, $ k_{\overline{\rho}} = 2 $, and $ \chi_{\overline{\rho}} $ is trivial.

\begin{theorem}[Ribet 1986]
If $ \overline{\rho} $ comes from any newform, it comes from the level, weight, and character predicted by Serre.
\end{theorem}

\begin{corollary}
If $ E_{a, b, c} $ is modular, then the corresponding $ \overline{\rho} $ comes from a modular form in $ \S_2\br{\Gamma_0\br{2}} $.
\end{corollary}

The problem is $ \dim \S_k\br{\Gamma} \le \tfrac{1}{12}k\sbr{\SL_2\br{\ZZ} : \Gamma} $, and $ \sbr{\SL_2\br{\ZZ} : \Gamma_0\br{2}} = 3 $, so $ \dim \S_2\br{\Gamma_0\br{2}} \le \tfrac{1}{2} $.

\begin{theorem}[Wiles 1995 and Taylor-Wiles 1996]
All elliptic curves over $ \QQ $ such that $ \N\br{E} $ is square-free are modular.
\end{theorem}

\begin{corollary}
Fermat's last theorem holds.
\end{corollary}

\end{document}